
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="贝格迈思数据库使用手册">
      
      
      
      
        <link rel="prev" href="../09.1-%E6%9E%B6%E6%9E%84/">
      
      
        <link rel="next" href="../09.3-%E9%85%8D%E7%BD%AE/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>CLIs - 手册</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mo" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="手册" class="md-header__button md-logo" aria-label="手册" data-md-component="logo">
      
  <img src="../../assets/new-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            手册
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CLIs
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aminerdocs/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="手册" class="md-nav__button md-logo" aria-label="手册" data-md-component="logo">
      
  <img src="../../assets/new-logo.png" alt="logo">

    </a>
    手册
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aminerdocs/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../01-AISQL%E7%AE%80%E4%BB%8B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AiSQL简介
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    快速上手
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            快速上手
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速安装部署
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/SQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL基本操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/BCQL%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BCQL基本操作
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/%E5%88%9B%E5%BB%BAJava%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    创建Java示例应用程序
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    应用开发
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            应用开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    构建应用
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            构建应用
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/JAVA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/Go/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/Python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/Node.js/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node.js
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/C%2B%2B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/C%23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C#
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/Ruby/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ruby
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/Rust/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rust
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%BA%94%E7%94%A8/PHP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PHP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/%E6%9E%84%E5%BB%BA%E5%85%A8%E5%B1%80%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    构建全局应用程序
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    构建多云应用程序
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            构建多云应用程序
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    概述
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../04-%E9%83%A8%E7%BD%B2%E9%9B%86%E7%BE%A4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    部署集群
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../05-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据迁移
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../06-%E7%AE%A1%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    管理数据库
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../07-%E5%90%91%E9%87%8F%E7%89%B9%E6%80%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    向量特性
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../08-AI%E7%89%B9%E6%80%A7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI特性
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    参考
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            参考
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../09.1-%E6%9E%B6%E6%9E%84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    架构
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CLIs
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CLIs
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clis" class="md-nav__link">
    CLIs
  </a>
  
    <nav class="md-nav" aria-label="CLIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sqlsh" class="md-nav__link">
    sqlsh
  </a>
  
    <nav class="md-nav" aria-label="sqlsh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    基本语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    标志
  </a>
  
    <nav class="md-nav" aria-label="标志">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-a-echo-all" class="md-nav__link">
    -a, --echo-all
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-a-no-align" class="md-nav__link">
    -A --no-align
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-b-echo-errors" class="md-nav__link">
    -b --echo-errors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-c-command-commandcommand" class="md-nav__link">
    -c command --command=command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-d-dbname-dbnamedbname" class="md-nav__link">
    -d dbname --dbname=dbname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-e-echo-queries" class="md-nav__link">
    -e, --echo-queries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-e-echo-hidden" class="md-nav__link">
    -E --echo-hidden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-f-filename-filefilename" class="md-nav__link">
    -f filename --file=filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-f-separator-field-separatorseparator" class="md-nav__link">
    -F separator --field-separator=separator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-h-hostname-hosthostname" class="md-nav__link">
    -h hostname --host=hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-h-html" class="md-nav__link">
    -H --html
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-l-list" class="md-nav__link">
    -l --list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-l-filename-log-filefilename" class="md-nav__link">
    -L filename --log-file=filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-n-no-readline" class="md-nav__link">
    -n --no-readline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-o-filename-outputfilename" class="md-nav__link">
    -o filename --output=filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-p-port-portport" class="md-nav__link">
    -p port --port=port
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-p-assignment-psetassignment" class="md-nav__link">
    -P assignment --pset=assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-q-quiet" class="md-nav__link">
    -q --quiet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-r-separator-record-separatorseparator" class="md-nav__link">
    -R separator --record-separator=separator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-s-single-step" class="md-nav__link">
    -s --single-step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-s-single-line" class="md-nav__link">
    -S --single-line
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-t-tuples-only" class="md-nav__link">
    -t --tuples-only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-t-table_options-table-attrtable_options" class="md-nav__link">
    -T table_options --table-attr=table_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-u-username-usernameusername" class="md-nav__link">
    -U username --username=username
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-v-assignment-setassignment-variableassignment" class="md-nav__link">
    -v assignment ，--set=assignment，--variable=assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-v-version" class="md-nav__link">
    -V --version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-w-no-password" class="md-nav__link">
    -w --no-password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-w-password" class="md-nav__link">
    -W --password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-x-expanded" class="md-nav__link">
    -x --expanded
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-x-no-psqlrc" class="md-nav__link">
    -X --no-psqlrc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-z-field-separator-zero" class="md-nav__link">
    -z --field-separator-zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-0-record-separator-zero" class="md-nav__link">
    -0 --record-separator-zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-1-single-transaction" class="md-nav__link">
    -1 --single-transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-helptopic" class="md-nav__link">
    -? --help[=topic]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    变量
  </a>
  
    <nav class="md-nav" aria-label="变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autocommit" class="md-nav__link">
    AUTOCOMMIT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comp_keyword_case" class="md-nav__link">
    COMP_KEYWORD_CASE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dbname" class="md-nav__link">
    DBNAME
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#echo" class="md-nav__link">
    ECHO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#echo_hidden" class="md-nav__link">
    ECHO_HIDDEN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encoding" class="md-nav__link">
    ENCODING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch_count" class="md-nav__link">
    FETCH_COUNT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#histcontrol" class="md-nav__link">
    HISTCONTROL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#histfile" class="md-nav__link">
    HISTFILE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#histsize" class="md-nav__link">
    HISTSIZE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host" class="md-nav__link">
    HOST
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignoreeof" class="md-nav__link">
    IGNOREEOF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lastoid" class="md-nav__link">
    LASTOID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on_error_rollback" class="md-nav__link">
    ON_ERROR_ROLLBACK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on_error_stop" class="md-nav__link">
    ON_ERROR_STOP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port" class="md-nav__link">
    PORT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt1-prompt2-prompt3" class="md-nav__link">
    PROMPT1 / PROMPT2 / PROMPT3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quiet" class="md-nav__link">
    QUIET
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server_version_name-server_version_num" class="md-nav__link">
    SERVER_VERSION_NAME / SERVER_VERSION_NUM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_context" class="md-nav__link">
    SHOW_CONTEXT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#singleline" class="md-nav__link">
    SINGLELINE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#singlestep" class="md-nav__link">
    SINGLESTEP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verbosity" class="md-nav__link">
    VERBOSITY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version-version_name-version_num" class="md-nav__link">
    VERSION / VERSION_NAME / VERSION_NUM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    SQL中插入变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    环境变量
  </a>
  
    <nav class="md-nav" aria-label="环境变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#columns" class="md-nav__link">
    COLUMNS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pager" class="md-nav__link">
    PAGER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgdatabasepghostpgportpguser" class="md-nav__link">
    PGDATABASE，PGHOST，PGPORT，PGUSER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_editoreditorvisual" class="md-nav__link">
    SQL_EDITOR，EDITOR，VISUAL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psql_editor_linenumber_arg" class="md-nav__link">
    PSQL_EDITOR_LINENUMBER_ARG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psql_history" class="md-nav__link">
    PSQL_HISTORY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psqlrc" class="md-nav__link">
    PSQLRC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shell" class="md-nav__link">
    SHELL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tmpdir" class="md-nav__link">
    TMPDIR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    提示符
  </a>
  
    <nav class="md-nav" aria-label="提示符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    预定义替换
  </a>
  
    <nav class="md-nav" aria-label="预定义替换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#m" class="md-nav__link">
    %M
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#m_1" class="md-nav__link">
    %m
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    %&gt;
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    %n
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    %/
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    %~
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    %
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p" class="md-nav__link">
    %p
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    %R
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x" class="md-nav__link">
    %x
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l" class="md-nav__link">
    %l
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digits" class="md-nav__link">
    %digits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#name" class="md-nav__link">
    %:name:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    %command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    %[ ... %]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    命令行编辑
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    文件
  </a>
  
    <nav class="md-nav" aria-label="文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#psqlrc-and-psqlrc" class="md-nav__link">
    psqlrc and ~/.psqlrc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psql_history_1" class="md-nav__link">
    .psql_history
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqlsh_1" class="md-nav__link">
    sqlsh元命令
  </a>
  
    <nav class="md-nav" aria-label="sqlsh元命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    基本语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    \a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-or-connect-reuse-previousonoff-dbname-username-host-port-conninfo" class="md-nav__link">
    \c or \connect [ -reuse-previous=on|off ] [ dbname [ username ] [ host ] [ port ] | conninfo ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-title" class="md-nav__link">
    \C [title]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cd-directory" class="md-nav__link">
    \cd [ directory ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conninfo" class="md-nav__link">
    \conninfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-table-column_list-query-from-to-filename-program-command-stdin-stdout-pstdin-pstdout-with-option" class="md-nav__link">
    \copy { table [ ( column_list ) ] | ( query ) } { from | to } { 'filename' | program 'command' | stdin | stdout | pstdin | pstdout } [ [ with ] ( option [, ...] ) ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copyright" class="md-nav__link">
    \copyright
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crosstabview-colv-colh-cold-sortcolh" class="md-nav__link">
    \crosstabview [ colV [ colH [ colD [ sortcolH ] ] ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ds-pattern" class="md-nav__link">
    \d[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#das-pattern" class="md-nav__link">
    \da[S] [ pattern ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#da-pattern" class="md-nav__link">
    \dA[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db-pattern" class="md-nav__link">
    \db[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcs-pattern" class="md-nav__link">
    \dc[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dc-pattern" class="md-nav__link">
    \dC[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dds-pattern" class="md-nav__link">
    \dd[S] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dds-pattern_1" class="md-nav__link">
    \dD[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddp-pattern" class="md-nav__link">
    \ddp [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#des-dis-dms-dss-dts-dvs-pattern" class="md-nav__link">
    \dE[S+], \di[S+], \dm[S+], \ds[S+], \dt[S+], \dv[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#des-pattern" class="md-nav__link">
    \des[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#det-pattern" class="md-nav__link">
    \det[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deu-pattern" class="md-nav__link">
    \deu[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dew-pattern" class="md-nav__link">
    \dew[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dfantws-pattern" class="md-nav__link">
    \df[antwS+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#df-pattern" class="md-nav__link">
    \dF[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dfd-pattern" class="md-nav__link">
    \dFd[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dfp-pattern" class="md-nav__link">
    \dFp[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dft-pattern" class="md-nav__link">
    \dFt[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dgs-pattern" class="md-nav__link">
    \dg[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dl" class="md-nav__link">
    \dl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dls-pattern" class="md-nav__link">
    \dL[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-pattern" class="md-nav__link">
    \dn[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-pattern" class="md-nav__link">
    \do[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-pattern_1" class="md-nav__link">
    \dO[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dp-pattern" class="md-nav__link">
    \dp [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drds-role-pattern-database-pattern" class="md-nav__link">
    \drds [ role-pattern [ database-pattern ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drp-pattern" class="md-nav__link">
    \dRp[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drs-pattern" class="md-nav__link">
    \dRs[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dts-pattern" class="md-nav__link">
    \dT[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dus-pattern" class="md-nav__link">
    \du[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dx-pattern" class="md-nav__link">
    \dx[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dy-pattern" class="md-nav__link">
    \dy[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eedit-filename-line_number" class="md-nav__link">
    \e或\edit [ filename ] [ line_number ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#echo-text" class="md-nav__link">
    \echo text [ ... ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ef-function_description-line_number" class="md-nav__link">
    \ef [ function_description [ line_number ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encoding-encoding" class="md-nav__link">
    \encoding [ encoding ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#errverbose" class="md-nav__link">
    \errverbose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ev-view_name-line_number" class="md-nav__link">
    \ev [ view_name [ line_number ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-string" class="md-nav__link">
    \f [ string ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-filename-g-command" class="md-nav__link">
    \g [ filename ]，\g [ |command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gexec" class="md-nav__link">
    \gexec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gset-prefix" class="md-nav__link">
    \gset [ prefix ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gx-filename-gx-command" class="md-nav__link">
    \gx [ filename ]，\gx [ |command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#h-or-help-command" class="md-nav__link">
    \h or \help [ command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#h-or-html" class="md-nav__link">
    \H or \html
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-or-include-filename" class="md-nav__link">
    \i or \include filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-expressionelif-expressionelseendif" class="md-nav__link">
    \if expression，\elif expression，\else，\endif
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ir-or-include_relative-filename" class="md-nav__link">
    \ir or \include_relative filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l-or-list-pattern" class="md-nav__link">
    \l[+] or \list[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_export-loid-filename" class="md-nav__link">
    \lo_export loid filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_import-filename-comment" class="md-nav__link">
    \lo_import filename [ comment ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_list" class="md-nav__link">
    \lo_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_unlink-loid" class="md-nav__link">
    \lo_unlink loid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#o-or-out-filenameor-command" class="md-nav__link">
    \o or \out [ filenameor  |command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p-or-print" class="md-nav__link">
    \p or \print
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#password-username" class="md-nav__link">
    \password [ username ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-text-name" class="md-nav__link">
    \prompt [ text ] name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pset-option-value" class="md-nav__link">
    \pset [ option [ value ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q-or-quit" class="md-nav__link">
    \q or \quit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qecho-text" class="md-nav__link">
    \qecho text [ ... ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#r-or-reset" class="md-nav__link">
    \r or \reset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s-filename" class="md-nav__link">
    \s [ filename ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-name-value" class="md-nav__link">
    \set [ name [ value [ ... ] ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setenv-name-value" class="md-nav__link">
    \setenv name [ value ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sf-function_description" class="md-nav__link">
    \sf[+] function_description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sv-view_name" class="md-nav__link">
    \sv[+] view_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#t" class="md-nav__link">
    \t
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#t-table_options" class="md-nav__link">
    \T table_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing-on-off" class="md-nav__link">
    \timing [ on | off ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unset-name" class="md-nav__link">
    \unset name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#w-or-write-filenameor-command" class="md-nav__link">
    \w or \write [ filenameor |command]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#watch-seconds" class="md-nav__link">
    \watch [ seconds ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x-on-off-auto" class="md-nav__link">
    \x [ on | off | auto ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-pattern" class="md-nav__link">
    \z [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command_1" class="md-nav__link">
    ! [ command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topic" class="md-nav__link">
    \? [ topic ]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern" class="md-nav__link">
    模式（Pattern）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    示例
  </a>
  
    <nav class="md-nav" aria-label="示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    创建数据库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    更改提示符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    交叉表视图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pset" class="md-nav__link">
    pset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cqlsh" class="md-nav__link">
    cqlsh
  </a>
  
    <nav class="md-nav" aria-label="cqlsh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    特殊的命令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-admin" class="md-nav__link">
    bm-admin
  </a>
  
    <nav class="md-nav" aria-label="bm-admin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    集群命令
  </a>
  
    <nav class="md-nav" aria-label="集群命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_universe_config" class="md-nav__link">
    get_universe_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_config" class="md-nav__link">
    change_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_mserver_config" class="md-nav__link">
    change_mserver_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablet_servers" class="md-nav__link">
    list_tablet_servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablets" class="md-nav__link">
    list_tablets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_all_tablet_servers" class="md-nav__link">
    list_all_tablet_servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_all_mservers" class="md-nav__link">
    list_all_mservers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_replica_type_counts" class="md-nav__link">
    list_replica_type_counts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump_mservers_state" class="md-nav__link">
    dump_mservers_state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablet_server_log_locations" class="md-nav__link">
    list_tablet_server_log_locations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablets_for_tablet_server" class="md-nav__link">
    list_tablets_for_tablet_server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split_tablet" class="md-nav__link">
    split_tablet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mserver_leader_stepdown" class="md-nav__link">
    mserver_leader_stepdown
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bsql_catalog_version" class="md-nav__link">
    bsql_catalog_version
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    表命令
  </a>
  
    <nav class="md-nav" aria-label="表命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list_tables" class="md-nav__link">
    list_tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_table" class="md-nav__link">
    compact_table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_table_by_id" class="md-nav__link">
    compact_table_by_id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify_table_placement_info" class="md-nav__link">
    modify_table_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_transaction_table" class="md-nav__link">
    create_transaction_table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_transaction_tablet" class="md-nav__link">
    add_transaction_tablet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    备份与快照命令
  </a>
  
    <nav class="md-nav" aria-label="备份与快照命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_database_snapshot" class="md-nav__link">
    create_database_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_keyspace_snapshot" class="md-nav__link">
    create_keyspace_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_snapshots" class="md-nav__link">
    list_snapshots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_snapshot" class="md-nav__link">
    create_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore_snapshot" class="md-nav__link">
    restore_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_snapshot" class="md-nav__link">
    export_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_snapshot" class="md-nav__link">
    import_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_snapshot" class="md-nav__link">
    delete_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_snapshot_schedule" class="md-nav__link">
    create_snapshot_schedule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_snapshot_schedules" class="md-nav__link">
    list_snapshot_schedules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore_snapshot_schedule" class="md-nav__link">
    restore_snapshot_schedule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_snapshot_schedule" class="md-nav__link">
    delete_snapshot_schedule
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    多区，多地域部署命令
  </a>
  
    <nav class="md-nav" aria-label="多区，多地域部署命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modify_placement_info" class="md-nav__link">
    modify_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_preferred_zones" class="md-nav__link">
    set_preferred_zones
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    读副本部署命令
  </a>
  
    <nav class="md-nav" aria-label="读副本部署命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_read_replica_placement_info" class="md-nav__link">
    add_read_replica_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify_read_replica_placement_info" class="md-nav__link">
    modify_read_replica_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_read_replica_placement_info" class="md-nav__link">
    delete_read_replica_placement_info
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    安全命令
  </a>
  
    <nav class="md-nav" aria-label="安全命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_universe_key_to_all_mservers" class="md-nav__link">
    add_universe_key_to_all_mservers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all_mservers_have_universe_key_in_memory" class="md-nav__link">
    all_mservers_have_universe_key_in_memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rotate_universe_key_in_memory" class="md-nav__link">
    rotate_universe_key_in_memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable_encryption_in_memory" class="md-nav__link">
    disable_encryption_in_memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_encryption_enabled" class="md-nav__link">
    is_encryption_enabled
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    更改数据捕获命令
  </a>
  
    <nav class="md-nav" aria-label="更改数据捕获命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_change_data_stream" class="md-nav__link">
    create_change_data_stream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_change_data_streams" class="md-nav__link">
    list_change_data_streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_change_data_stream_info" class="md-nav__link">
    get_change_data_stream_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_change_data_stream" class="md-nav__link">
    delete_change_data_stream
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xdcr" class="md-nav__link">
    xDCR复制命令
  </a>
  
    <nav class="md-nav" aria-label="xDCR复制命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup_universe_replication" class="md-nav__link">
    setup_universe_replication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter_universe_replication" class="md-nav__link">
    alter_universe_replication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_universe_replication" class="md-nav__link">
    delete_universe_replication 
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_universe_replication_enabled" class="md-nav__link">
    set_universe_replication_enabled
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_cdc_streams" class="md-nav__link">
    list_cdc_streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_cdc_stream-force_delete" class="md-nav__link">
    delete_cdc_stream  [force_delete]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bootstrap_cdc_producer" class="md-nav__link">
    bootstrap_cdc_producer 
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_replication_status" class="md-nav__link">
    get_replication_status
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decommissioning-commands" class="md-nav__link">
    Decommissioning commands
  </a>
  
    <nav class="md-nav" aria-label="Decommissioning commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_leader_blacklist_completion" class="md-nav__link">
    get_leader_blacklist_completion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_blacklist" class="md-nav__link">
    change_blacklist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_leader_blacklist" class="md-nav__link">
    change_leader_blacklist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leader_stepdown" class="md-nav__link">
    leader_stepdown
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    负载均衡命令
  </a>
  
    <nav class="md-nav" aria-label="负载均衡命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set_load_balancer_enabled" class="md-nav__link">
    set_load_balancer_enabled
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_load_balancer_state" class="md-nav__link">
    get_load_balancer_state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_load_move_completion" class="md-nav__link">
    get_load_move_completion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_is_load_balancer_idle" class="md-nav__link">
    get_is_load_balancer_idle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bsql" class="md-nav__link">
    更新BSQL系统目录
  </a>
  
    <nav class="md-nav" aria-label="更新BSQL系统目录">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upgrade_bsql" class="md-nav__link">
    upgrade_bsql
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dbserver-ctl" class="md-nav__link">
    dbserver-ctl
  </a>
  
    <nav class="md-nav" aria-label="dbserver-ctl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    命令
  </a>
  
    <nav class="md-nav" aria-label="命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#are_tablets_running" class="md-nav__link">
    are_tablets_running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_server_ready" class="md-nav__link">
    is_server_ready
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_all_tiles" class="md-nav__link">
    compact_all_tiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_tile" class="md-nav__link">
    compact_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count_intents" class="md-nav__link">
    count_intents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current_hybrid_time" class="md-nav__link">
    current_hybrid_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_tile" class="md-nav__link">
    delete_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump_tile" class="md-nav__link">
    dump_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush_all_tiles" class="md-nav__link">
    flush_all_tiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush_tile" class="md-nav__link">
    flush_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tiles" class="md-nav__link">
    list_tiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reload_certificates" class="md-nav__link">
    reload_certificates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote_bootstrap" class="md-nav__link">
    remote_bootstrap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_flag" class="md-nav__link">
    set_flag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refresh_flags" class="md-nav__link">
    refresh_flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    标志
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-dump" class="md-nav__link">
    bm-dump
  </a>
  
    <nav class="md-nav" aria-label="bm-dump">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    概述
  </a>
  
    <nav class="md-nav" aria-label="概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    安装
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    在线帮助
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    内容和输出格式选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    数据库连接选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    环境
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    诊断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    注意事项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-dumpall" class="md-nav__link">
    bm-dumpall
  </a>
  
    <nav class="md-nav" aria-label="bm-dumpall">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    内容和输出格式选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    连接选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    环境
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    注意事项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-dev-ctl" class="md-nav__link">
    bm-dev-ctl
  </a>
  
    <nav class="md-nav" aria-label="bm-dev-ctl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    Commands
  </a>
  
    <nav class="md-nav" aria-label="Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop" class="md-nav__link">
    stop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destroy" class="md-nav__link">
    destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status_1" class="md-nav__link">
    status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    restart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wipe_restart" class="md-nav__link">
    wipe_restart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_node" class="md-nav__link">
    add_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_node" class="md-nav__link">
    remove_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start_node" class="md-nav__link">
    start_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop_node" class="md-nav__link">
    stop_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart_node" class="md-nav__link">
    restart_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_redis" class="md-nav__link">
    setup_redis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flags" class="md-nav__link">
    Flags
  </a>
  
    <nav class="md-nav" aria-label="Flags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-help-h" class="md-nav__link">
    --help, -h
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-binary_dir" class="md-nav__link">
    --binary_dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-data_dir" class="md-nav__link">
    --data_dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-mserver_flags" class="md-nav__link">
    --mserver_flags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-dbserver_flags" class="md-nav__link">
    --dbserver_flags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-placement_info" class="md-nav__link">
    --placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-replication_factor-rf" class="md-nav__link">
    --replication_factor, -rf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-require_clock_sync" class="md-nav__link">
    --require_clock_sync
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-listen_ip" class="md-nav__link">
    --listen_ip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-num_shards_per_dbserver" class="md-nav__link">
    --num_shards_per_dbserver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-timeout-bm-admin-sec" class="md-nav__link">
    --timeout-bm-admin-sec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-timeout-processes-running-sec" class="md-nav__link">
    --timeout-processes-running-sec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-verbose" class="md-nav__link">
    --verbose
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../09.3-%E9%85%8D%E7%BD%AE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    配置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../09.4-BSQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../09.5-BCQL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BCQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#clis" class="md-nav__link">
    CLIs
  </a>
  
    <nav class="md-nav" aria-label="CLIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sqlsh" class="md-nav__link">
    sqlsh
  </a>
  
    <nav class="md-nav" aria-label="sqlsh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    基本语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    标志
  </a>
  
    <nav class="md-nav" aria-label="标志">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-a-echo-all" class="md-nav__link">
    -a, --echo-all
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-a-no-align" class="md-nav__link">
    -A --no-align
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-b-echo-errors" class="md-nav__link">
    -b --echo-errors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-c-command-commandcommand" class="md-nav__link">
    -c command --command=command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-d-dbname-dbnamedbname" class="md-nav__link">
    -d dbname --dbname=dbname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-e-echo-queries" class="md-nav__link">
    -e, --echo-queries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-e-echo-hidden" class="md-nav__link">
    -E --echo-hidden
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-f-filename-filefilename" class="md-nav__link">
    -f filename --file=filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-f-separator-field-separatorseparator" class="md-nav__link">
    -F separator --field-separator=separator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-h-hostname-hosthostname" class="md-nav__link">
    -h hostname --host=hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-h-html" class="md-nav__link">
    -H --html
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-l-list" class="md-nav__link">
    -l --list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-l-filename-log-filefilename" class="md-nav__link">
    -L filename --log-file=filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-n-no-readline" class="md-nav__link">
    -n --no-readline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-o-filename-outputfilename" class="md-nav__link">
    -o filename --output=filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-p-port-portport" class="md-nav__link">
    -p port --port=port
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-p-assignment-psetassignment" class="md-nav__link">
    -P assignment --pset=assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-q-quiet" class="md-nav__link">
    -q --quiet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-r-separator-record-separatorseparator" class="md-nav__link">
    -R separator --record-separator=separator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-s-single-step" class="md-nav__link">
    -s --single-step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-s-single-line" class="md-nav__link">
    -S --single-line
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-t-tuples-only" class="md-nav__link">
    -t --tuples-only
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-t-table_options-table-attrtable_options" class="md-nav__link">
    -T table_options --table-attr=table_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-u-username-usernameusername" class="md-nav__link">
    -U username --username=username
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-v-assignment-setassignment-variableassignment" class="md-nav__link">
    -v assignment ，--set=assignment，--variable=assignment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-v-version" class="md-nav__link">
    -V --version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-w-no-password" class="md-nav__link">
    -w --no-password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-w-password" class="md-nav__link">
    -W --password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-x-expanded" class="md-nav__link">
    -x --expanded
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-x-no-psqlrc" class="md-nav__link">
    -X --no-psqlrc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-z-field-separator-zero" class="md-nav__link">
    -z --field-separator-zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-0-record-separator-zero" class="md-nav__link">
    -0 --record-separator-zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-1-single-transaction" class="md-nav__link">
    -1 --single-transaction
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-helptopic" class="md-nav__link">
    -? --help[=topic]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    变量
  </a>
  
    <nav class="md-nav" aria-label="变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#autocommit" class="md-nav__link">
    AUTOCOMMIT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comp_keyword_case" class="md-nav__link">
    COMP_KEYWORD_CASE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dbname" class="md-nav__link">
    DBNAME
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#echo" class="md-nav__link">
    ECHO
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#echo_hidden" class="md-nav__link">
    ECHO_HIDDEN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encoding" class="md-nav__link">
    ENCODING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetch_count" class="md-nav__link">
    FETCH_COUNT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#histcontrol" class="md-nav__link">
    HISTCONTROL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#histfile" class="md-nav__link">
    HISTFILE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#histsize" class="md-nav__link">
    HISTSIZE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#host" class="md-nav__link">
    HOST
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignoreeof" class="md-nav__link">
    IGNOREEOF
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lastoid" class="md-nav__link">
    LASTOID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on_error_rollback" class="md-nav__link">
    ON_ERROR_ROLLBACK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on_error_stop" class="md-nav__link">
    ON_ERROR_STOP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port" class="md-nav__link">
    PORT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt1-prompt2-prompt3" class="md-nav__link">
    PROMPT1 / PROMPT2 / PROMPT3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quiet" class="md-nav__link">
    QUIET
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server_version_name-server_version_num" class="md-nav__link">
    SERVER_VERSION_NAME / SERVER_VERSION_NUM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show_context" class="md-nav__link">
    SHOW_CONTEXT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#singleline" class="md-nav__link">
    SINGLELINE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#singlestep" class="md-nav__link">
    SINGLESTEP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    USER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verbosity" class="md-nav__link">
    VERBOSITY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version-version_name-version_num" class="md-nav__link">
    VERSION / VERSION_NAME / VERSION_NUM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql" class="md-nav__link">
    SQL中插入变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    环境变量
  </a>
  
    <nav class="md-nav" aria-label="环境变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#columns" class="md-nav__link">
    COLUMNS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pager" class="md-nav__link">
    PAGER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgdatabasepghostpgportpguser" class="md-nav__link">
    PGDATABASE，PGHOST，PGPORT，PGUSER
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql_editoreditorvisual" class="md-nav__link">
    SQL_EDITOR，EDITOR，VISUAL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psql_editor_linenumber_arg" class="md-nav__link">
    PSQL_EDITOR_LINENUMBER_ARG
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psql_history" class="md-nav__link">
    PSQL_HISTORY
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psqlrc" class="md-nav__link">
    PSQLRC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shell" class="md-nav__link">
    SHELL
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tmpdir" class="md-nav__link">
    TMPDIR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    提示符
  </a>
  
    <nav class="md-nav" aria-label="提示符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    预定义替换
  </a>
  
    <nav class="md-nav" aria-label="预定义替换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#m" class="md-nav__link">
    %M
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#m_1" class="md-nav__link">
    %m
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    %&gt;
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    %n
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    %/
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    %~
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    %
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p" class="md-nav__link">
    %p
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#r" class="md-nav__link">
    %R
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x" class="md-nav__link">
    %x
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l" class="md-nav__link">
    %l
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#digits" class="md-nav__link">
    %digits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#name" class="md-nav__link">
    %:name:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    %command
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    %[ ... %]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    命令行编辑
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    文件
  </a>
  
    <nav class="md-nav" aria-label="文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#psqlrc-and-psqlrc" class="md-nav__link">
    psqlrc and ~/.psqlrc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psql_history_1" class="md-nav__link">
    .psql_history
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqlsh_1" class="md-nav__link">
    sqlsh元命令
  </a>
  
    <nav class="md-nav" aria-label="sqlsh元命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    基本语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    \a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-or-connect-reuse-previousonoff-dbname-username-host-port-conninfo" class="md-nav__link">
    \c or \connect [ -reuse-previous=on|off ] [ dbname [ username ] [ host ] [ port ] | conninfo ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-title" class="md-nav__link">
    \C [title]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cd-directory" class="md-nav__link">
    \cd [ directory ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conninfo" class="md-nav__link">
    \conninfo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-table-column_list-query-from-to-filename-program-command-stdin-stdout-pstdin-pstdout-with-option" class="md-nav__link">
    \copy { table [ ( column_list ) ] | ( query ) } { from | to } { 'filename' | program 'command' | stdin | stdout | pstdin | pstdout } [ [ with ] ( option [, ...] ) ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copyright" class="md-nav__link">
    \copyright
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crosstabview-colv-colh-cold-sortcolh" class="md-nav__link">
    \crosstabview [ colV [ colH [ colD [ sortcolH ] ] ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ds-pattern" class="md-nav__link">
    \d[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#das-pattern" class="md-nav__link">
    \da[S] [ pattern ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#da-pattern" class="md-nav__link">
    \dA[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db-pattern" class="md-nav__link">
    \db[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcs-pattern" class="md-nav__link">
    \dc[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dc-pattern" class="md-nav__link">
    \dC[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dds-pattern" class="md-nav__link">
    \dd[S] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dds-pattern_1" class="md-nav__link">
    \dD[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ddp-pattern" class="md-nav__link">
    \ddp [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#des-dis-dms-dss-dts-dvs-pattern" class="md-nav__link">
    \dE[S+], \di[S+], \dm[S+], \ds[S+], \dt[S+], \dv[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#des-pattern" class="md-nav__link">
    \des[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#det-pattern" class="md-nav__link">
    \det[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deu-pattern" class="md-nav__link">
    \deu[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dew-pattern" class="md-nav__link">
    \dew[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dfantws-pattern" class="md-nav__link">
    \df[antwS+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#df-pattern" class="md-nav__link">
    \dF[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dfd-pattern" class="md-nav__link">
    \dFd[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dfp-pattern" class="md-nav__link">
    \dFp[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dft-pattern" class="md-nav__link">
    \dFt[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dgs-pattern" class="md-nav__link">
    \dg[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dl" class="md-nav__link">
    \dl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dls-pattern" class="md-nav__link">
    \dL[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-pattern" class="md-nav__link">
    \dn[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-pattern" class="md-nav__link">
    \do[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-pattern_1" class="md-nav__link">
    \dO[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dp-pattern" class="md-nav__link">
    \dp [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drds-role-pattern-database-pattern" class="md-nav__link">
    \drds [ role-pattern [ database-pattern ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drp-pattern" class="md-nav__link">
    \dRp[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drs-pattern" class="md-nav__link">
    \dRs[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dts-pattern" class="md-nav__link">
    \dT[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dus-pattern" class="md-nav__link">
    \du[S+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dx-pattern" class="md-nav__link">
    \dx[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dy-pattern" class="md-nav__link">
    \dy[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eedit-filename-line_number" class="md-nav__link">
    \e或\edit [ filename ] [ line_number ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#echo-text" class="md-nav__link">
    \echo text [ ... ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ef-function_description-line_number" class="md-nav__link">
    \ef [ function_description [ line_number ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encoding-encoding" class="md-nav__link">
    \encoding [ encoding ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#errverbose" class="md-nav__link">
    \errverbose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ev-view_name-line_number" class="md-nav__link">
    \ev [ view_name [ line_number ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#f-string" class="md-nav__link">
    \f [ string ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#g-filename-g-command" class="md-nav__link">
    \g [ filename ]，\g [ |command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gexec" class="md-nav__link">
    \gexec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gset-prefix" class="md-nav__link">
    \gset [ prefix ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gx-filename-gx-command" class="md-nav__link">
    \gx [ filename ]，\gx [ |command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#h-or-help-command" class="md-nav__link">
    \h or \help [ command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#h-or-html" class="md-nav__link">
    \H or \html
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#i-or-include-filename" class="md-nav__link">
    \i or \include filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-expressionelif-expressionelseendif" class="md-nav__link">
    \if expression，\elif expression，\else，\endif
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ir-or-include_relative-filename" class="md-nav__link">
    \ir or \include_relative filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l-or-list-pattern" class="md-nav__link">
    \l[+] or \list[+] [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_export-loid-filename" class="md-nav__link">
    \lo_export loid filename
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_import-filename-comment" class="md-nav__link">
    \lo_import filename [ comment ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_list" class="md-nav__link">
    \lo_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lo_unlink-loid" class="md-nav__link">
    \lo_unlink loid
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#o-or-out-filenameor-command" class="md-nav__link">
    \o or \out [ filenameor  |command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#p-or-print" class="md-nav__link">
    \p or \print
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#password-username" class="md-nav__link">
    \password [ username ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-text-name" class="md-nav__link">
    \prompt [ text ] name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pset-option-value" class="md-nav__link">
    \pset [ option [ value ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q-or-quit" class="md-nav__link">
    \q or \quit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qecho-text" class="md-nav__link">
    \qecho text [ ... ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#r-or-reset" class="md-nav__link">
    \r or \reset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#s-filename" class="md-nav__link">
    \s [ filename ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-name-value" class="md-nav__link">
    \set [ name [ value [ ... ] ] ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setenv-name-value" class="md-nav__link">
    \setenv name [ value ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sf-function_description" class="md-nav__link">
    \sf[+] function_description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sv-view_name" class="md-nav__link">
    \sv[+] view_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#t" class="md-nav__link">
    \t
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#t-table_options" class="md-nav__link">
    \T table_options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing-on-off" class="md-nav__link">
    \timing [ on | off ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unset-name" class="md-nav__link">
    \unset name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#w-or-write-filenameor-command" class="md-nav__link">
    \w or \write [ filenameor |command]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#watch-seconds" class="md-nav__link">
    \watch [ seconds ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#x-on-off-auto" class="md-nav__link">
    \x [ on | off | auto ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#z-pattern" class="md-nav__link">
    \z [ pattern]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command_1" class="md-nav__link">
    ! [ command ]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topic" class="md-nav__link">
    \? [ topic ]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern" class="md-nav__link">
    模式（Pattern）
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    示例
  </a>
  
    <nav class="md-nav" aria-label="示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    创建数据库
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    更改提示符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    交叉表视图
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pset" class="md-nav__link">
    pset
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cqlsh" class="md-nav__link">
    cqlsh
  </a>
  
    <nav class="md-nav" aria-label="cqlsh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    特殊的命令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-admin" class="md-nav__link">
    bm-admin
  </a>
  
    <nav class="md-nav" aria-label="bm-admin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    集群命令
  </a>
  
    <nav class="md-nav" aria-label="集群命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_universe_config" class="md-nav__link">
    get_universe_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_config" class="md-nav__link">
    change_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_mserver_config" class="md-nav__link">
    change_mserver_config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablet_servers" class="md-nav__link">
    list_tablet_servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablets" class="md-nav__link">
    list_tablets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_all_tablet_servers" class="md-nav__link">
    list_all_tablet_servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_all_mservers" class="md-nav__link">
    list_all_mservers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_replica_type_counts" class="md-nav__link">
    list_replica_type_counts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump_mservers_state" class="md-nav__link">
    dump_mservers_state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablet_server_log_locations" class="md-nav__link">
    list_tablet_server_log_locations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tablets_for_tablet_server" class="md-nav__link">
    list_tablets_for_tablet_server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split_tablet" class="md-nav__link">
    split_tablet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mserver_leader_stepdown" class="md-nav__link">
    mserver_leader_stepdown
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bsql_catalog_version" class="md-nav__link">
    bsql_catalog_version
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    表命令
  </a>
  
    <nav class="md-nav" aria-label="表命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list_tables" class="md-nav__link">
    list_tables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_table" class="md-nav__link">
    compact_table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_table_by_id" class="md-nav__link">
    compact_table_by_id
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify_table_placement_info" class="md-nav__link">
    modify_table_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_transaction_table" class="md-nav__link">
    create_transaction_table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_transaction_tablet" class="md-nav__link">
    add_transaction_tablet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    备份与快照命令
  </a>
  
    <nav class="md-nav" aria-label="备份与快照命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_database_snapshot" class="md-nav__link">
    create_database_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_keyspace_snapshot" class="md-nav__link">
    create_keyspace_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_snapshots" class="md-nav__link">
    list_snapshots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_snapshot" class="md-nav__link">
    create_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore_snapshot" class="md-nav__link">
    restore_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_snapshot" class="md-nav__link">
    export_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import_snapshot" class="md-nav__link">
    import_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_snapshot" class="md-nav__link">
    delete_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_snapshot_schedule" class="md-nav__link">
    create_snapshot_schedule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_snapshot_schedules" class="md-nav__link">
    list_snapshot_schedules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore_snapshot_schedule" class="md-nav__link">
    restore_snapshot_schedule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_snapshot_schedule" class="md-nav__link">
    delete_snapshot_schedule
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    多区，多地域部署命令
  </a>
  
    <nav class="md-nav" aria-label="多区，多地域部署命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modify_placement_info" class="md-nav__link">
    modify_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_preferred_zones" class="md-nav__link">
    set_preferred_zones
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    读副本部署命令
  </a>
  
    <nav class="md-nav" aria-label="读副本部署命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_read_replica_placement_info" class="md-nav__link">
    add_read_replica_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify_read_replica_placement_info" class="md-nav__link">
    modify_read_replica_placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_read_replica_placement_info" class="md-nav__link">
    delete_read_replica_placement_info
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    安全命令
  </a>
  
    <nav class="md-nav" aria-label="安全命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_universe_key_to_all_mservers" class="md-nav__link">
    add_universe_key_to_all_mservers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all_mservers_have_universe_key_in_memory" class="md-nav__link">
    all_mservers_have_universe_key_in_memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rotate_universe_key_in_memory" class="md-nav__link">
    rotate_universe_key_in_memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable_encryption_in_memory" class="md-nav__link">
    disable_encryption_in_memory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_encryption_enabled" class="md-nav__link">
    is_encryption_enabled
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    更改数据捕获命令
  </a>
  
    <nav class="md-nav" aria-label="更改数据捕获命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_change_data_stream" class="md-nav__link">
    create_change_data_stream
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_change_data_streams" class="md-nav__link">
    list_change_data_streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_change_data_stream_info" class="md-nav__link">
    get_change_data_stream_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_change_data_stream" class="md-nav__link">
    delete_change_data_stream
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xdcr" class="md-nav__link">
    xDCR复制命令
  </a>
  
    <nav class="md-nav" aria-label="xDCR复制命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup_universe_replication" class="md-nav__link">
    setup_universe_replication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter_universe_replication" class="md-nav__link">
    alter_universe_replication
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_universe_replication" class="md-nav__link">
    delete_universe_replication 
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_universe_replication_enabled" class="md-nav__link">
    set_universe_replication_enabled
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_cdc_streams" class="md-nav__link">
    list_cdc_streams
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_cdc_stream-force_delete" class="md-nav__link">
    delete_cdc_stream  [force_delete]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bootstrap_cdc_producer" class="md-nav__link">
    bootstrap_cdc_producer 
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_replication_status" class="md-nav__link">
    get_replication_status
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decommissioning-commands" class="md-nav__link">
    Decommissioning commands
  </a>
  
    <nav class="md-nav" aria-label="Decommissioning commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_leader_blacklist_completion" class="md-nav__link">
    get_leader_blacklist_completion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_blacklist" class="md-nav__link">
    change_blacklist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change_leader_blacklist" class="md-nav__link">
    change_leader_blacklist
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leader_stepdown" class="md-nav__link">
    leader_stepdown
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    负载均衡命令
  </a>
  
    <nav class="md-nav" aria-label="负载均衡命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set_load_balancer_enabled" class="md-nav__link">
    set_load_balancer_enabled
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_load_balancer_state" class="md-nav__link">
    get_load_balancer_state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_load_move_completion" class="md-nav__link">
    get_load_move_completion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_is_load_balancer_idle" class="md-nav__link">
    get_is_load_balancer_idle
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bsql" class="md-nav__link">
    更新BSQL系统目录
  </a>
  
    <nav class="md-nav" aria-label="更新BSQL系统目录">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upgrade_bsql" class="md-nav__link">
    upgrade_bsql
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dbserver-ctl" class="md-nav__link">
    dbserver-ctl
  </a>
  
    <nav class="md-nav" aria-label="dbserver-ctl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    命令
  </a>
  
    <nav class="md-nav" aria-label="命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#are_tablets_running" class="md-nav__link">
    are_tablets_running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_server_ready" class="md-nav__link">
    is_server_ready
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_all_tiles" class="md-nav__link">
    compact_all_tiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compact_tile" class="md-nav__link">
    compact_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count_intents" class="md-nav__link">
    count_intents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#current_hybrid_time" class="md-nav__link">
    current_hybrid_time
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_tile" class="md-nav__link">
    delete_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dump_tile" class="md-nav__link">
    dump_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush_all_tiles" class="md-nav__link">
    flush_all_tiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flush_tile" class="md-nav__link">
    flush_tile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list_tiles" class="md-nav__link">
    list_tiles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reload_certificates" class="md-nav__link">
    reload_certificates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote_bootstrap" class="md-nav__link">
    remote_bootstrap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_flag" class="md-nav__link">
    set_flag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    Status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refresh_flags" class="md-nav__link">
    refresh_flags
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    标志
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-dump" class="md-nav__link">
    bm-dump
  </a>
  
    <nav class="md-nav" aria-label="bm-dump">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    概述
  </a>
  
    <nav class="md-nav" aria-label="概述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    安装
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    在线帮助
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    内容和输出格式选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    数据库连接选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    环境
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    诊断
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    注意事项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-dumpall" class="md-nav__link">
    bm-dumpall
  </a>
  
    <nav class="md-nav" aria-label="bm-dumpall">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    概述
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    语法
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    内容和输出格式选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    连接选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    环境
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    注意事项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    示例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bm-dev-ctl" class="md-nav__link">
    bm-dev-ctl
  </a>
  
    <nav class="md-nav" aria-label="bm-dev-ctl">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#commands" class="md-nav__link">
    Commands
  </a>
  
    <nav class="md-nav" aria-label="Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create" class="md-nav__link">
    create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    start
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop" class="md-nav__link">
    stop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destroy" class="md-nav__link">
    destroy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status_1" class="md-nav__link">
    status
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    restart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wipe_restart" class="md-nav__link">
    wipe_restart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_node" class="md-nav__link">
    add_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_node" class="md-nav__link">
    remove_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start_node" class="md-nav__link">
    start_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stop_node" class="md-nav__link">
    stop_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart_node" class="md-nav__link">
    restart_node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_redis" class="md-nav__link">
    setup_redis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flags" class="md-nav__link">
    Flags
  </a>
  
    <nav class="md-nav" aria-label="Flags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-help-h" class="md-nav__link">
    --help, -h
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-binary_dir" class="md-nav__link">
    --binary_dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-data_dir" class="md-nav__link">
    --data_dir
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-mserver_flags" class="md-nav__link">
    --mserver_flags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-dbserver_flags" class="md-nav__link">
    --dbserver_flags
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-placement_info" class="md-nav__link">
    --placement_info
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-replication_factor-rf" class="md-nav__link">
    --replication_factor, -rf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-require_clock_sync" class="md-nav__link">
    --require_clock_sync
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-listen_ip" class="md-nav__link">
    --listen_ip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-num_shards_per_dbserver" class="md-nav__link">
    --num_shards_per_dbserver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-timeout-bm-admin-sec" class="md-nav__link">
    --timeout-bm-admin-sec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-timeout-processes-running-sec" class="md-nav__link">
    --timeout-processes-running-sec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-verbose" class="md-nav__link">
    --verbose
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>CLIs</h1>

<h2 id="clis"><strong>CLIs</strong></h2>
<p>提供如下的命令行界面（CLI）及其工具参考。</p>
<h3 id="sqlsh"><strong>sqlsh</strong></h3>
<h4 id="_1"><strong>概述</strong></h4>
<p>AiSQL提供了一个命令sqlsh，用于BSQL与AiSQL数据库进行交互。使用它，可以完成如下：</p>
<ul>
<li>以交互方式输入SQL查询并查看查询结果</li>
<li>从文件或命令行输入</li>
<li>使用sqlsh元命令进行脚本编写和管理</li>
</ul>
<p>sqlsh与AiSQL一起安装，位于安装目录的bin目录中。 </p>
<p>1）启动sqlsh
进入安装目录的bin目录，执行：</p>
<div class="highlight"><pre><span></span><code>./sqlsh
</code></pre></div>
<p>执行成功，将显示如下信息，并进入交互界面，等待用户下一步的指令。</p>
<div class="highlight"><pre><span></span><code>sqlsh (11.2)
Type &quot;help&quot; for help.

No entry for terminal type &quot;xterm-256color&quot;;
using dumb terminal settings.
biginsights=# 
</code></pre></div>
<p>2）联机帮助
进入安装目录的bin目录，执行：</p>
<div class="highlight"><pre><span></span><code>./sqlsh --help
</code></pre></div>
<p>可获取联机帮助</p>
<p>3）退出状态 
sqlsh在退出时会向shell返回以下内容：
0：正常完成
1：发生自身的致命错误（例如内存不足、找不到文件）
2：与服务器的连接出现问题并且会话没有交互
3：脚本中发生错误并且设置了变量ON_error_STOP</p>
<p>4）使用
一般要连接到数据库，可能需要提供以下信息：
1）目标数据库的名称
2）服务器的主机名和端口号
3）连接用户名
可以使用-d、-h、-p和-U标志来提供这些参数。详细使用请参见标志</p>
<p>sqlsh为这些值提供了以下默认值：
如果省略主机名，sqlsh将连接到默认编译的10.0.0.1，或者连接到本地主机上的服务器的Unix域套接字，或者在没有Unix域套接字的机器上使用TCP/IP连接到localhost。
默认端口号为2521。因为数据库服务器使用相同的默认值，所以在大多数情况下不必指定端口。
默认用户名为biginsights，默认数据库名称也是如此。如果发现一个不属于任何选项的参数，则将其解释为数据库名称（如果已给定数据库名称，则解释为用户名）。
当默认值不太正确时，可以通过将环境变量PGDATABASE、PGHOST、PGPORT和PGUSER设置为适当的值来节省一些输入。有一个~/.pgpass文件也很方便，可以避免经常输入密码。
指定连接参数的另一种方法是使用conninfo字符串或URI，而不是数据库名称。这种机制使您能够对连接进行广泛的控制。例如：</p>
<div class="highlight"><pre><span></span><code>./sqlsh &quot;service=myservice sslmode=require&quot;
./sqlsh postgresql://dbserver:2521/mydb?sslmode=require
</code></pre></div>
<p>如果由于任何原因（例如，权限不足、服务器未在目标主机上运行等）无法建立连接，sqlsh 将返回一个错误并终止。
如果标准输入和标准输出都是终端，那么bsql将客户端编码设置为auto，这将从区域设置（Linux系统上的LC_CTYPE环境变量）中检测适当的客户端编码。如果这没有按预期进行，则可以使用环境变量PGCLIENTENCODING覆盖客户端编码。 </p>
<p>在连接数据库成功后，可以开启输入SQL语句，并进行执行。
在正常操作中，sqlsh会提供一个提示，其中包含sqlsh当前连接的数据库的名称，后跟字符串=#。例如：</p>
<div class="highlight"><pre><span></span><code>biginsights=# 
</code></pre></div>
<p>在提示下，用户可以输入SQL语句。通常，当到达以分号（；）结尾的命令时，会将输入行发送到服务器。行尾不会终止语句。因此，为了清晰起见，命令可以分布在几行上。如果该语句被发送并执行时没有出现错误，则该语句的结果将显示在屏幕上。
注意：
如果不受信任的用户可以访问未采用安全架构使用模式的数据库，请通过从search_path中删除公共可写架构来开始会话。您可以将options=-csearch_path=添加到连接字符串，或者在其他SQL语句之前发出select pg_catalog.set_config（'search_path'，''，false）。这种考虑并不是sqlsh特有的；它适用于执行任意SQL语句的每个接口。
注意：
当使用\i还原AiSQL数据库时，由bm-dump和bm-dumpall生成的SQL脚本文件在执行任何其他SQL语句之前会发出select pg_catalog.set_config（'search_path'，''，false）语句。
每当执行语句时，sqlsh还会轮询LISTEN和NOTIFY生成的异步通知事件。 
当C样式块注释被传递到服务器进行处理和删除时，SQL标准注释会被sqlsh删除。 </p>
<h4 id="_2"><strong>基本语法</strong></h4>
<p>sqlsh [ <option>...] [ <dbname> [ <username> ]]</p>
<p>默认标志
运行sqlsh时，会设置以下默认标志。
主机：-h 10.0.0.1
端口：-p 2521
用户：-U biginsights</p>
<p>注意：
默认用户biginsights的默认密码是biginsights。如果启用了BSQL身份验证，则系统会提示biginsights用户输入此密码。</p>
<h4 id="_3"><strong>标志</strong></h4>
<p>sqlsh支持如下标志</p>
<h5 id="-a-echo-all"><strong>-a, --echo-all</strong></h5>
<p>把所有非空输入行按照它们被读入的形式打印到标准输出（不适用于交互式行读取）。这等效于把变量ECHO设置为 all。</p>
<h5 id="-a-no-align"><strong>-A --no-align</strong></h5>
<p>切换到非对齐输出模式（默认输出模式是对齐的）。这等效于\pset format unaligned。</p>
<h5 id="-b-echo-errors"><strong>-b --echo-errors</strong></h5>
<p>把失败的 SQL 命令打印到标准错误输出。这等效于把变量ECHO设置为errors。</p>
<h5 id="-c-command-commandcommand"><strong>-c command --command=command</strong></h5>
<p>指定sqlsh执行一个给定的命令字符串command。这个选项可以重复多次并且以任何顺序与-f选项组合在一起。当-c或者-f被指定时，sqlsh不会从标准输入读取命令，直到它处理完序列中所有的-c和-f选项之后终止。</p>
<p>command必须是一个服务器完全可解析的命令字符串（即不包含sqlsh相关的特性）或者单个反斜线（\）命令。因此不能在一个-c选项中混合SQL和sqlsh元命令。要那样做，可以使用多个-c选项或者把字符串用管道输送到sqlsh中，例如：</p>
<div class="highlight"><pre><span></span><code>./sqlsh -c &#39;\x&#39; -c &#39;select * FROM table;&#39;
</code></pre></div>
<p>或者</p>
<div class="highlight"><pre><span></span><code>echo &#39;\x \\ select * FROM table;&#39; | ./sqlsh
</code></pre></div>
<p>（\是分隔符元命令）。
每一个被传递给-c的SQL命令字符串会被当做一个单独的请求发送给服务器。因此，即便该字符串包括多个SQL命令，服务器也会把它当做一个事务来执行，除非在该字符串中有显式的BEGIN/COMMIT命令把它划分成多个事务。此外，sqlsh只会打印出该字符串中最后一个SQL命令的结果。这和从文件中读取同一字符串或者把同一字符串传给sqlsh的标准输出时的行为不同，因为那两种情况下sqlsh会独立地发送每一个SQL命令。</p>
<p>由于这种行为，把多于一个SQL命令放在-c字符串中通常会得到意料之外的结果。最好使用多个-c命令或者把多个命令输送给sqlsh的标准输入，按照上文所说的使用echo或者通过一个 shell，例如：</p>
<div class="highlight"><pre><span></span><code>./sqlsh&lt;&lt;EOF
\x
select * FROM table;
EOF
</code></pre></div>
<h5 id="-d-dbname-dbnamedbname"><strong>-d dbname --dbname=dbname</strong></h5>
<p>指定要连接的数据库的名称。这等效于指定dbname为命令行上的第一个非选项参数。</p>
<p>如果这个参数包含一个=符号或者以一个合法的URI前缀（postgresql://或者postgres://）开始，它会被当作一个conninfo字符串。</p>
<h5 id="-e-echo-queries"><strong>-e, --echo-queries</strong></h5>
<p>也把发送到服务器的所有 SQL 命令复制到标准输出。这等效于把变量ECHO设置为queries。</p>
<h5 id="-e-echo-hidden"><strong>-E --echo-hidden</strong></h5>
<p>回显\d以及其他反斜线命令生成的实际查询。可以用它来学习sqlsh的内部操作。这等效于把变量ECHO_HIDDEN设置为on。</p>
<h5 id="-f-filename-filefilename"><strong>-f filename --file=filename</strong></h5>
<p>从文件filename而不是标准输入中读取命令。这个选项可以被重复多次，也可以以任意顺序与-c选项组合。当-c或者-f被指定时，sqlsh不会从标准输入读取命令，直到它处理完序列中所有的-c和-f选项之后终止。除此以外，这个选项很大程度上等价于元命令\i。</p>
<p>如果filename是-（连字符），那么会读取标准输入直到遇见一个 EOF 指示或者\q元命令。这种方式可以用把自多个文件的输入组合成一种交互式输入。不过注意在这种情况下不会使用 Readline（很像指定了-n的情况）。</p>
<p>使用这个选项与sqlsh &lt; filename &gt;有细微的不同。通常，两种形式都可以做到我们所期望的，但是使用-f启用了一些好的特性，例如带有行号的错误消息。使用这个选项还有一丝机会可以降低启动开销。在另一方面，使用 shell输入重定向的变体（理论上）保证会得到与手工输入时相同的输出。</p>
<h5 id="-f-separator-field-separatorseparator"><strong>-F separator --field-separator=separator</strong></h5>
<p>使用separator作为非对齐输出的域分隔符。这等效于\pset fieldsep或者\f。</p>
<h5 id="-h-hostname-hosthostname"><strong>-h hostname --host=hostname</strong></h5>
<p>指定运行服务器的机器的主机名。如果这个值由一个斜线开始，它会被用作 Unix 域套接字的目录。默认值是：127.0.0.1。</p>
<h5 id="-h-html"><strong>-H --html</strong></h5>
<p>切换到HTML输出模式。这等效于\pset format html或者\H命令。</p>
<h5 id="-l-list"><strong>-l --list</strong></h5>
<p>列出所有可用的数据库，然后退出。其他非连接选项会被忽略。这与元命令\list类似。</p>
<p>在使用这个选项时，sqlsh将连接到数据库postgres，除非在命令行上提及一个不同的数据（选项-d或非选项参数，可能是通过一个服务项，但不能通过一个环境变量）。</p>
<h5 id="-l-filename-log-filefilename"><strong>-L filename --log-file=filename</strong></h5>
<p>除了把所有查询输出写到普通输出目标之外，还写到文件filename中。</p>
<h5 id="-n-no-readline"><strong>-n --no-readline</strong></h5>
<p>不使用Readline做行编辑并且不使用命令历史。在剪切和粘贴时，关掉 Tab 展开会有所帮助。</p>
<h5 id="-o-filename-outputfilename"><strong>-o filename --output=filename</strong></h5>
<p>把所有查询输出放到文件filename中。这等效于命令\o。</p>
<h5 id="-p-port-portport"><strong>-p port --port=port</strong></h5>
<p>指定服务器用于监听连接的 TCP 端口或者本地 Unix 域套接字文件扩展。默认是PGPORT环境变量的值，如果没有设置，则默认为编译时指定的端口号（通常是2521）。</p>
<h5 id="-p-assignment-psetassignment"><strong>-P assignment --pset=assignment</strong></h5>
<p>以\pset的形式指定打印选项。注意，这里你必须用一个等号而不是空格来分隔名称和值。例如，要设置输出格式为LaTeX，应该写成-P format=latex。</p>
<h5 id="-q-quiet"><strong>-q --quiet</strong></h5>
<p>指定sqlsh应该安静地工作。默认情况下，它会打印出欢迎消息以及多种输出。如果使用了这个选项，以上那些就都不会输出。在使用-c选项时，配合这个选项很有用。这等效于设置变量QUIET为on。</p>
<h5 id="-r-separator-record-separatorseparator"><strong>-R separator --record-separator=separator</strong></h5>
<p>把separator用作非对齐输出的记录分隔符。这等效于\pset recordsep命令。</p>
<h5 id="-s-single-step"><strong>-s --single-step</strong></h5>
<p>运行在单步模式中。这意味着在每个命令被发送给服务器之前都会提示用户一个可以取消执行的选项。使用这个选项可以调试脚本。</p>
<h5 id="-s-single-line"><strong>-S --single-line</strong></h5>
<p>运行在单行模式中，其中新行会终止一个 SQL 命令，就像分号的作用一样。</p>
<p>注意：这种模式被提供给那些坚持使用它的用户，但是并不一定要使用它。特别地，如果在一行中混合了SQL和元命令，那对于没有经的用户来说，它们的执行顺序可能不总是那么清晰。</p>
<h5 id="-t-tuples-only"><strong>-t --tuples-only</strong></h5>
<p>关闭打印列名和结果行计数页脚等。这等效于\t或者\pset tuples_only命令。</p>
<h5 id="-t-table_options-table-attrtable_options"><strong>-T table_options --table-attr=table_options</strong></h5>
<p>指定要替换HTML table标签的选项。详见\pset tableattr。</p>
<h5 id="-u-username-usernameusername"><strong>-U username --username=username</strong></h5>
<p>作为用户username而不是默认用户连接到数据库（当然，你必须具有这样做的权限）。</p>
<h5 id="-v-assignment-setassignment-variableassignment"><strong>-v assignment ，--set=assignment，--variable=assignment</strong></h5>
<p>执行一次变量赋值，和\set元命令相似。注意你必须在命令行上用等号分隔名字和值（如果有）。要重置一个变量，去掉等号(=) 就行。要把一个变量置为空值，使用等号但是去掉值。这些赋值在命令行处理期间被完成，因此反映连接状态的变量将在稍后被覆盖。</p>
<h5 id="-v-version"><strong>-V --version</strong></h5>
<p>打印sqlsh版本并且退出。</p>
<h5 id="-w-no-password"><strong>-w --no-password</strong></h5>
<p>从来不发出一个口令提示。如果服务器要求口令认证并且没有其他方式提供口令（例如一个.pgpass文件），那儿连接尝试将失败。这个选项对于批处理任务和脚本有用，因为在其中没有一个用户来输入口令。</p>
<p>注意这个选项将对整个会话保持设置，并且因此它会影响元命令\connect的使用，就像初始的连接尝试那样。</p>
<h5 id="-w-password"><strong>-W --password</strong></h5>
<p>强制sqlsh 在连接到一个数据库之前提示要求一个口令。</p>
<p>这个选项不是必不可少的，因为如果服务器要求口令认证，sqlsh将自动提示要求一个口令。但是，sqlsh将浪费一次连接尝试来发现服务器想要一个口令。在某些情况下值得用-W来避免额外的连接尝试。</p>
<p>注意这个选项将对整个会话保持设置，并且因此它会影响元命令\connect的使用，就像初始的连接尝试那样。</p>
<h5 id="-x-expanded"><strong>-x --expanded</strong></h5>
<p>打开扩展表格式模式。这等效于\x或者\pset expanded命令。</p>
<h5 id="-x-no-psqlrc"><strong>-X --no-psqlrc</strong></h5>
<p>不读取启动文件（要么是系统范围的psqlrc文件，要么是用户的~/.psqlrc文件）。</p>
<h5 id="-z-field-separator-zero"><strong>-z --field-separator-zero</strong></h5>
<p>设置非对齐输出的域分隔符为零字节。这等效于\pset fieldsep_zero。</p>
<h5 id="-0-record-separator-zero"><strong>-0 --record-separator-zero</strong></h5>
<p>设置非对齐输出的记录分隔符为零字节。这有助于接口，例如，xargs -0。这等效于\pset recordsep_zero。</p>
<h5 id="-1-single-transaction"><strong>-1 --single-transaction</strong></h5>
<p>这个选项只能被用于与一个或者多个-c以及/或者-f选项组合。它会让sqlsh在第一个上述选项之前发出一条BEGIN命令并且在最后一个上述选项之后发出一条COMMIT命令，这样就把所有的命令都包裹在一个事务中。这个选项可以保证要么所有的命令都成功地完成，要么不应用任何更改。</p>
<p>如果命令本身包含BEGIN、COMMIT或者ROLLBACK，这个选项将不会得到想要的效果。还有，如果当个命令不能在一个事务块中执行，指定这个选项将导致整个事务失败。</p>
<h5 id="-helptopic"><strong>-? --help[=topic]</strong></h5>
<p>显示有关sqlsh的帮助并且退出。可选的topic参数（默认为options）选择要解释哪一部分的sqlsh：commands描述sqlsh的反斜线命令；options描述可以被传递给sqlsh的命令行选项；而variables则显示有关sqlsh配置变量的帮助。</p>
<h4 id="_4"><strong>变量</strong></h4>
<p>sqlsh提供了和普通 Unix 命令 shell 相似的变量替换特性。变量简单来说就是一对名称/值，其中值可以是任意长度的任意字符串。名称必须由字母（包括非拉丁字母）、数字和下划线构成。</p>
<p>要设置一个变量，可以使用sqlsh的元命令\set。例如，</p>
<p>testdb=&gt; \set foo bar
会设置foo为值bar。要检索该变量的内容，可以在名称前放一个分号，例如：
testdb=&gt; \echo :foo
bar</p>
<p>这在常规 SQL 命令和元命令中均有效，下文的<a href="#_SQL中插入变量">SQL中插入变量</a>中有更多细节。</p>
<p>如果调用\set时没有第二个参数，该变量会被设置为一个空字符串值。要重置（即删除）一个变量，可以使用命令\unset。要显示所有变量的值，在调用\set时不带任何参数即可。</p>
<p>注意：
\set的参数服从与其他命令相同的替换规则。因此可以构造有趣的引用，例如\set :foo 'something'以及分别得到Perl或者PHP的“软链接”或者“可变变量”。不幸的是（或者幸运的是？），这些构造出来的东西并没有什么用处。在另一方面，\set bar :foo是一种很好的拷贝变量的方法。</p>
<p>有一些变量会被sqlsh特殊对待。它们表示特定的选项设置，运行时这类选项设置可以通过修改该变量的值来改变，或者在某些情况下它们表示sqlsh的可更改的状态。按照惯例，所有被特殊对待的变量的名称由全部大写形式的 ASCII 字母（还有可能是数字和下划线）组成。为了确保未来最大的兼容性，最好避免把这类变量名用于自己的目的。</p>
<p>控制sqlsh行为的变量通常不能被重置或者设置为无效值。允许\unset命令，但它会被解释为将变量设置为它的默认值。没有第二参数的\set命令会被解释为将变量设置为on（对于接受该值的控制变量），对不接受该值的变量则会拒绝这个命令。此外，接受值on和off的控制变量也能接受其他常见的布尔值拼写方式，例如true和false。</p>
<p>被特殊对待的变量是：</p>
<h5 id="autocommit"><strong>AUTOCOMMIT</strong></h5>
<p>在被设置为on（默认）时，每一个 SQL 命令在成功完成时会被自动提交。在这种模式中要推迟提交，必须输入一个BEGIN或者START TRANSACTION SQL 命令。当被设置为off或者被重置时，在显式发出COMMIT或者END之前，SQL 命令不会被提交。自动提交打开模式会为你发出一个隐式的BEGIN，这会发生在任何不在一个事务块中且本身即不是BEGIN及其他事务控制命令且不是无法在事务块中执行的命令（例如VACUUM）之前。</p>
<p>在自动提交关闭模式中，必须通过ABORT或者ROLLBACK显式地放弃任何失败的事务。还要记住，如果退出会话时没有提交，则所有的工作都会丢失。</p>
<p>自动提交打开模式是sqlsh的传统行为，但是自动提交关闭模式更接近于 SQL 的规范。如果更喜欢自动提交关闭模式，可以在系统级的psqlrc文件或者个人的~/.psqlrc文件中设置它。</p>
<h5 id="comp_keyword_case"><strong>COMP_KEYWORD_CASE</strong></h5>
<p>确定在补全一个 SQL 关键词时要使用的大小写形式。如果被设置为lower或者upper，补全后的词将分别是小写或者大写形式。如果被设置为preserve-lower或者preserve-upper（默认），补全后的词将会保持该词已输入部分的大小写形式，但是如果被补全的词还没有被输入，则它会被分别补全成小写或者大写形式。</p>
<h5 id="dbname"><strong>DBNAME</strong></h5>
<p>当前已连接的数据库名称。每次连接到一个数据库时都会设置该变量（包括程序启动时），但是可以被更改或者重置。</p>
<h5 id="echo"><strong>ECHO</strong></h5>
<p>如果被设置为all，所有非空输入行会被按照读入它们的样子打印到标准输出（不适用于交互式读取的行）。要在程序开始时选择这种行为，可以使用开关-a。如果被设置为queries，sqlsh会在发送每个查询给服务器时将它们打印到标准输出。选择这种行为的开关是-e。如果被设置为errors，那么只有失败的查询会被显示在标准错误输出上。这种行为的开关是-b。如果被重置或者设置为none（默认值）则不会显示任何查询。</p>
<h5 id="echo_hidden"><strong>ECHO_HIDDEN</strong></h5>
<p>当这个变量被设置为on且一个反斜线命令查询数据库时，相应的查询会被先显示。这种特性可以帮助我们学习sqlsh的内部并且在自己的程序中提供类似的功能（要在程序开始时选择这种行为，可以使用开关-E）。如果把这个变量设置为值noexec，则对应的查询只会被显示而并不真正被发送给服务器执行。默认值是off。</p>
<h5 id="encoding"><strong>ENCODING</strong></h5>
<p>当前的客户端字符集编码。每一次你连接到一个数据库（包括程序启动）时以及当你用\encoding更改编码时，这个变量都会被设置，但它可以被更改或者重置。</p>
<h5 id="fetch_count"><strong>FETCH_COUNT</strong></h5>
<p>如果这个变量被设置为一个大于零的整数值，SELECT查询的结果会以一组一组的方式取出并且显示（而不是像默认的那样把整个结果集拿到以后再显示），每一组就会包括这么多个行。因此，这种方式只会使用有限的内存量，而不管整个结果集的大小。在启用这个特性时，通常会使用 100 到 1000 的设置。记住在使用这种特性时，一个查询可能会在已经显示了一些行之后失败。</p>
<p>提示
尽管可以把这种特性用于任何的输出格式，但是默认的aligned格式看起来会比较糟糕，因为每一组的FETCH_COUNT个行将被单独格式化，这就会导致不同的行组的列宽不同。其他的输出格式会更好。</p>
<h5 id="histcontrol"><strong>HISTCONTROL</strong></h5>
<p>如果这个变量被设置为ignorespace，则以一个空格开始的行不会被放入到历史列表中。如果被设置为值ignoredups，则匹配之前的历史行的行不会被放入。值ignoreboth组合了上述两种值。如果被重置或者被设置为none（默认值），所有在交互模式中被读入的行都会保存在历史列表中。</p>
<h5 id="histfile"><strong>HISTFILE</strong></h5>
<p>该文件名将被用于存储历史列表。如果被重设，文件名将从PSQL_HISTORY环境变量中取得。如果该环境变量也没有被设置，则默认值是~/.psql_history。例如，</p>
<p>\set HISTFILE ~/.psql_history- :DBNAME
放在~/.psqlrc中将会导致sqlsh为每一个数据库维护一个单独的历史。</p>
<h5 id="histsize"><strong>HISTSIZE</strong></h5>
<p>存储在命令历史中的最大命令数（默认值是500）。如果被设置为一个负值，则不会应用限制。</p>
<h5 id="host"><strong>HOST</strong></h5>
<p>当前连接到的数据库服务器端口。每次连接到一个数据库时都会设置该变量（包括程序启动时），但是可以被更改或者重置。</p>
<h5 id="ignoreeof"><strong>IGNOREEOF</strong></h5>
<p>如果被设置为1或者更小，向一个sqlsh的交互式会话发送一个EOF字符（通常是Control+D）将会终止应用。如果设置为一个较大的数字值，则必须键入多个连续的EOF字符才能让交互式会话终止。如果该变量被设置为一个非数字值，则它会被解释为10。默认值为0。</p>
<h5 id="lastoid"><strong>LASTOID</strong></h5>
<p>最后被影响的 OID 的值，这可能会由INSERT或者\lo_import命令返回。这个变量只保证在下一个SQL命令被显示完之前有效。 </p>
<h5 id="on_error_rollback"><strong>ON_ERROR_ROLLBACK</strong></h5>
<p>当被设置为on时，如果事务块中的一个语句产生一个错误，该错误会被忽略并且该事务会继续。当被设置为interactive时，只在交互式会话中忽略这类错误，而读取脚本文件时则不会忽略错误。当被重置或者设置为off（默认值）时，事务块中产生错误的一个语句会中止整个事务。错误回滚模式的工作原理是在事务块的每个命令之前都为你发出一个隐式的SAVEPOINT，然后在该命令失败时回滚到该保存点。</p>
<h5 id="on_error_stop"><strong>ON_ERROR_STOP</strong></h5>
<p>默认情况下，出现一个错误后命令处理会继续下去。当这个变量被设置为on后，出现错误后命令处理会立即停止。在交互模式下，sqlsh将会返回到命令提示符；否则，sqlsh将会退出并且返回错误代码 3 来把这种情况与致命错误区分开来，致命错误会被报告为错误代码 1。在两种情况下，任何当前正在运行的脚本（顶层脚本以及任何它已经调用的其他脚本）将被立即中止。如果顶层命名字符串包含多个 SQL 命令，将在当前命令处停止处理。</p>
<h5 id="port"><strong>PORT</strong></h5>
<p>当前连接到的数据库服务器端口。每次连接到一个数据库时都会设置该变量（包括程序启动时），但是可以被更改或者重置。</p>
<h5 id="prompt1-prompt2-prompt3"><strong>PROMPT1 / PROMPT2 / PROMPT3</strong></h5>
<p>这些变量指定sqlsh发出的提示符的模样。见下文的<a href="#_提示符">提示符</a>。</p>
<h5 id="quiet"><strong>QUIET</strong></h5>
<p>把这个变量设置为on等效于命令行选项-q。在交互模式下可能用处不大。</p>
<h5 id="server_version_name-server_version_num"><strong>SERVER_VERSION_NAME / SERVER_VERSION_NUM</strong></h5>
<p>字符串形式的服务器版本号，例如11.2，以及数字形式的服务器版本号，例如110002。每次你连接到一个数据库（包括程序启动）时，这些都会被设置，但可以被改变或者重设。</p>
<h5 id="show_context"><strong>SHOW_CONTEXT</strong></h5>
<p>这个变量可以被设置为值never、errors或者always来控制是否在来自服务器的消息中显示CONTEXT域。默认是errors（表示在错误消息中显示上下文，但在通知和警告消息中不显示）。 当VERBOSITY被设置为terse时，这个设置无效（另见\errverbose，它可以用来得到刚遇到的错误的详细信息）。</p>
<h5 id="singleline"><strong>SINGLELINE</strong></h5>
<p>设置这个变量为on等效于命令行选项-S。</p>
<h5 id="singlestep"><strong>SINGLESTEP</strong></h5>
<p>设置这个变量为on等效于命令选项-s。</p>
<h5 id="user"><strong>USER</strong></h5>
<p>当前连接的数据库用户。每次连接到一个数据库时都会设置该变量（包括程序启动时），但是可以被更改或者重置。</p>
<h5 id="verbosity"><strong>VERBOSITY</strong></h5>
<p>这个变量可以被设置为值default、verbose或者terse来控制错误报告的详细程度（另见\errverbose，在想得到之前的错误的详细版本时使用）。</p>
<h5 id="version-version_name-version_num"><strong>VERSION / VERSION_NAME / VERSION_NUM</strong></h5>
<p>这些变量在程序启动时被设置以反映sqlsh的版本，分别是一个详细的字符串、一个短字符串（例如9.6.2、10.1或者11beta1）以及一个数字（例如90602或者100001）。它们可以被更改或重设。</p>
<h4 id="sql"><strong>SQL中插入变量</strong></h4>
<p>sqlsh变量的一个关键特性是可以把它们替换（“插入”）到常规SQL语句中，也可以把它们作为元命令的参数。此外，sqlsh还提供了功能来确保被用作 SQL 文字和标识符的变量值会被正确地引用。插入一个值而不需要加引用的语法是在变量名前面加上一个冒号（:）。例如，</p>
<div class="highlight"><pre><span></span><code>testdb=&gt; \set foo &#39;my_table&#39;
testdb=&gt; select * FROM :foo;
</code></pre></div>
<p>将查询表my_table。注意这可能会不安全：该变量的值会被按字面拷贝，因此它可能包含不平衡的引号甚至反斜线命令。必须确保把它放在那里是有意义的。</p>
<p>当一个值被用作 SQL 文本或者标识符时，最安全的是把它加上引用。要引用一个变量的值作为 SQL 文本，可以把变量名称放在单引号中并且在引号前面写一个冒号。要引用作为 SQL 标识符，则可以把变量名称放在双引号中并且在引号前面写一个冒号。这种结构可以正确地处理变量值中嵌入的引号和其他特殊字符。之前的例子用这种方法写会更安全：</p>
<div class="highlight"><pre><span></span><code>testdb=&gt; \set foo &#39;my_table&#39;
testdb=&gt; select * FROM :&quot;foo&quot;;
</code></pre></div>
<p>在被引用的SQL文本和标识符中将不会执行变量插入。因此，一个诸如':foo'的结构不会从一个变量的值产生一个被引用的文本（即便能够也会不安全，因为无法正确地处理嵌入在值中的引号）。</p>
<p>使用这种机制的一个例子是把一个文件的内容拷贝到一个表列中。首先把该文件载入到一个变量，然后把该变量的值作为一个被引用的字符串插入：</p>
<div class="highlight"><pre><span></span><code>testdb=&gt; \set content `cat my_file.txt`
testdb=&gt; INSERT INTO my_table VALUES (:&#39;content&#39;);
</code></pre></div>
<p>注意如果my_file.txt包含 NUL 字节，这样也不行。sqlsh不支持在变量值中嵌入 NUL 字节）。</p>
<p>因为冒号可以合法地出现在 SQL 命令中，一次明显的插入尝试（即:name、:'name'或者:"name"）不会被替换，除非所提及的变量就是当前被设置的。在任何情况下，可以用一个反斜线对冒号进行转义以避免它被替换。</p>
<p>变量的冒号语法对嵌入式查询语言（例如ECPG）来说是标准的SQL。用于数组切片和类型造型的冒号语法是sqlsh扩展，它有时可能会与标准用法冲突。把一个变量值转义成 SQL 文本或者标识符的冒号引用语法是一种sqlsh扩展。</p>
<h4 id="_5"><strong>环境变量</strong></h4>
<p>使用以下环境变量来配置和自定义编辑器。使用\setenv 元命令可以设置环境变量。sqlsh还使用libpq支持的环境变量。 </p>
<h5 id="columns"><strong>COLUMNS</strong></h5>
<p>如果\pset columns为零，这个环境变量控制用于wrapped格式的宽度，以及用来确定是否输出需要用到分页器，或者切换到扩展自动模式中的垂直格式的宽度。</p>
<h5 id="pager"><strong>PAGER</strong></h5>
<p>如果一个查询的结果在屏幕上放不下，它们会通过这个命令分页显示。典型的值是more或less。默认情况取决于平台。可以通过将pager设置为空，或使用\pset 元命令的分页器相关的选项。</p>
<h5 id="pgdatabasepghostpgportpguser"><strong>PGDATABASE，PGHOST，PGPORT，PGUSER</strong></h5>
<p>默认连接参数</p>
<h5 id="sql_editoreditorvisual"><strong>SQL_EDITOR，EDITOR，VISUAL</strong></h5>
<p>\e、\ef以及\ev命令所使用的编辑器。会按照列出的顺序检查这些变量，第一个被设置的将被使用。在Linux系统上，默认使用的编辑器是vi。</p>
<h5 id="psql_editor_linenumber_arg"><strong>PSQL_EDITOR_LINENUMBER_ARG</strong></h5>
<p>当\e、\ef或者\ev带有一个行号参数时，这个变量指定用于传递起始行号给用户编辑器的命令行参数。对于Emacs或者vi之类的编辑器，这个变量是一个加(+)号。如果需要在选项名称和行号之间有空格，可以在该变量的值中包括一个结尾的空格。例如：</p>
<div class="highlight"><pre><span></span><code>PSQL_EDITOR_LINENUMBER_ARG=&#39;+&#39;
PSQL_EDITOR_LINENUMBER_ARG=&#39;--line &#39;
</code></pre></div>
<p>在 Linux系统上默认是 +（对应于默认编辑器vi，且对很多其他常见编辑器可用）。</p>
<h5 id="psql_history"><strong>PSQL_HISTORY</strong></h5>
<p>命令历史文件的替代位置。波浪线（~）扩展会被执行。</p>
<h5 id="psqlrc"><strong>PSQLRC</strong></h5>
<p>用户的.psqlrc文件的替代位置。波浪线（~）扩展会被执行。</p>
<h5 id="shell"><strong>SHELL</strong></h5>
<p>被 ! 命令执行的命令。</p>
<h5 id="tmpdir"><strong>TMPDIR</strong></h5>
<p>存储临时文件的目录。默认是 /tmp。</p>
<h4 id="_6"><strong>提示符</strong></h4>
<p>sqlsh发出的提示符可以根据用户的喜好自定义。PROMPT1、PROMPT2和PROMPT3这三个变量包含了描述提示符外观的字符串和特殊转义序列。
Prompt 1 是当sqlsh等待新命令时发出的常规提示符。
Prompt 2 是在命令输入时需要更多输入时发出的提示符，例如因为当命令没有被分号终止或者引用没有被关闭时就会发出这个提示符。
Prompt 3是在运行一个SQL COPY FROM STDIN命令并且需要在终端上输入一个行值时，会发出Prompt 3。</p>
<p>sqlsh会打印被选中的提示符变量，除非碰到一个百分号（%），在这种情况下，它会替换“<a href="#_预定义替换">预定义替换</a>”中定义的其他文本。</p>
<p>要在提示中插入百分号，请写%%。 </p>
<p>对于Prompt 1和Prompt 2，默认的提示符是 '%/%R%# ' ，对于prompt 3 是'&gt;&gt; ' 。</p>
<h5 id="_7"><strong>预定义替换</strong></h5>
<h6 id="m">%M</h6>
<p>数据库服务器的完整主机名（带有域名），或者当该连接是建立在一个 Unix 域套接字上时则是[local]，或者当 Unix 域套接字不在编译在系统内的默认位置上时则是[local:/dir/name]。</p>
<h6 id="m_1">%m</h6>
<p>数据库服务器的主机名称（在第一个点处截断），或者当连接建立在一个 Unix 域套接字上时是[local]。</p>
<h6 id="_8">%&gt;</h6>
<p>数据库服务器正在监听的端口号。</p>
<h6 id="n">%n</h6>
<p>数据库会话的用户名（在数据库会话期间，这个值可能会因为命令SET SESSION AUTHORIZATION的结果而改变）。</p>
<h6 id="_9">%/</h6>
<p>当前数据库的名称。</p>
<h6 id="_10">%~</h6>
<p>和 %/ 类似，但是如果数据库是默认数据库时输出是~（波浪线）。</p>
<h6 id="_11">%</h6>
<p>如果会话用户时一个数据库超级用户，则是#，否则是一个&gt;（在数据库会话期间，这个值可能会因为命令SET SESSION AUTHORIZATION的结果而改变）。</p>
<h6 id="p">%p</h6>
<p>当前连接到的后端的进程 ID。</p>
<h6 id="r">%R</h6>
<p>在prompt 1下通常是 = ，但如果会话位于一个条件块的一个非活动分支中则是@，如果会话处于单行模式中则是^，如果会话从数据库断开连接（\connect失败时会发生这种情况）则是!。
在prompt 2 中，根据sqlsh期待更多的输入，%R会被一个相应的字符替换：</p>
<p>1) 如果命令还没有被终止是-，如果有一个未完的/<em> ... </em>/注释则是*
2) 如果有一个未完的被引用字符串则是一个单引号 ‘
3) 如果有一个未完的被引用标识符则是一个双引号 “
4) 如果有一个未完的美元引用字符串则是一个美元符号 $
5) 如果有一个还没有被配对的左圆括号则是(</p>
<p>在prompt 3 中%R不会产生任何东西。</p>
<h6 id="x">%x</h6>
<p>事务状态：当不在事务块中时是一个空字符串，在一个事务块中时是*，在一个失败的事务块中时是!，当事务状态是未判定时（例如因为没有连接）为?。</p>
<h6 id="l">%l</h6>
<p>当前语句中的行号，从1开始。</p>
<h6 id="digits">%digits</h6>
<p>带有指定的八进制码的字符会被替换。</p>
<h6 id="name">%:name:</h6>
<p>sqlsh变量name的值。详见<a href="#_变量">变量</a>。</p>
<h6 id="command">%<code>command</code></h6>
<p>command的输出，类似于平常的“反引号”替换。</p>
<h6 id="_12">%[ ... %]</h6>
<p>提示符可以包含终端控制字符，例如改变提示符文本的颜色、背景或者风格以及更改终端窗口标题的控制字符。为了让Readline的行编辑特性正确工作，这些不可打印的控制字符必须被包裹在%[和%]之间以指定它们是不可见的。在提示附中可以出现多个这样的标识对。例如：</p>
<p>testdb=&gt; \set PROMPT1 '%[%033[1;33;40m%]%n@%/%R%[%033[0m%]%# '
会导致一个在兼容 VT100 的彩色终端上的粗体（1;）的、黑底黄字（33;40）的提示符。</p>
<h5 id="_13"><strong>命令行编辑</strong></h5>
<p>为了方便的行编辑和检索，sqlsh支持Readline库。sqlsh退出时命令历史会被自动保存，而当sqlsh启动时命令历史会被重新载入。sqlsh也支持 tab 补全，不过补全逻辑绝不是一个SQL解析器。tab 补全产生的查询也可能会受其他 SQL 命令干扰，例如SET TRANSACTION ISOLATION LEVEL。如果出于某种原因不想用 tab 键补全，可以把下面的代码放在主目录下的名为.inputrc文件中关闭该特性：</p>
<div class="highlight"><pre><span></span><code>$if psql
set disable-completion on
$endif
</code></pre></div>
<p>（这不是sqlsh特性而是Readline的特性。进一步的细节请阅读它的文档。）</p>
<h4 id="_14"><strong>文件</strong></h4>
<h5 id="psqlrc-and-psqlrc"><strong>psqlrc and ~/.psqlrc</strong></h5>
<p>如果没有-X选项，在连接到数据库后但在接收正常的命令之前，sqlsh会尝试依次从系统级的启动文件（psqlrc）和用户的个人启动文件（~/.psqlrc）中读取并且执行命令。这些文件可以被用来设置客户端或者服务器，通常是一些\set和SET命令。</p>
<p>系统级的启动文件是psqlrc，它应该在安装好的“系统配置”目录中，最可靠的定位方法是运行pg_config --sysconfdir。默认情况下，这个目录将是../etc/（相对于包含PostgreSQL可执行文件的目录）。可以通过PGSYSCONFDIR环境变量显式地设置这个目录的名称。</p>
<p>用户个人的启动文件是.psqlrc，它应该在调用用户的主目录中。用户启动文件的位置可以通过PSQLRC环境变量设置。</p>
<p>系统级和用户个人的启动文件都可以弄成是针对特定sqlsh版本的，方法是在文件名后面加上一个横线以及AiSQL的主、次版本号，例如~/.psqlrc-10.2或者~/.psqlrc-10.2.5。版本最为匹配的文件会优先于不那么匹配的文件读入。</p>
<h5 id="psql_history_1"><strong>.psql_history</strong></h5>
<p>命令行历史被存储在文件~/.psql_history中。</p>
<p>历史文件的位置可以通过sqlsh HISTFILE 变量或者PSQL_HISTORY环境变量明确的设置。</p>
<h4 id="sqlsh_1"><strong>sqlsh元命令</strong></h4>
<p>与psql类似，sqlsh提供了许多元命令，使sqlsh更适合管理或编写脚本。元命令通常称为斜杠或反斜杠命令。您在sqlsh中输入的任何以未加引号的反斜杠开头的内容都是由sqlsh自身处理的元命令。</p>
<p>注意：
cloud shell
出于安全原因，AiSQL托管云外壳只能访问元命令的一个子集。除了以只读方式访问/share目录以加载示例数据集之外，访问文件系统的命令在cloud shell中不起作用。</p>
<h5 id="_15"><strong>基本语法</strong></h5>
<p>sqlsh命令的格式是用反斜线后面直接跟上一个命令动词，然后是一些参数。参数与命令动词和其他参数之间用任意多个空白字符分隔开。</p>
<p>要在一个参数中包括空白，可以将它加上单引号(' ')。要在一个参数中包括一个单引号，则需要在文本中写上两个单引号 (' ... '' ...')。任何包含在单引号中的东西都服从与 C 语言中\n（新行）、\t（制表符）、\b（退格）、\r（回车）、\f（换页）、\digits（10 进制）以及\xdigits（16 进制）类似的替换规则。单引号内文本中的其他任何字符（不管它是什么）前面的反斜线都没有实际意义（会被忽略）。</p>
<p>如果在一个参数中出现一个未加引号的冒号（:）后面跟着一个sqlsh变量名，它会被该变量的值替换，如<a href="#_SQL中插入变量">SQL 中插入变量中</a>所述。在其中描述的形式:'variable_name'和:"variable_name"也有同样的效果。</p>
<p>在一个参数中，封闭在反引号（`）中的文本会被当做一个传递给shell的命令行。该命令的输出（移除任何拖尾的新行）会替换反引号文本。在封闭在反引号的文本中，不会有特别的引号或者其他处理发生，:variable_name的出现除外，其中variable_name是一个会被其值替换的sqlsh变量名。此外，:'variable_name'的出现会被替换为该变量的值，而值会被适当地加以引用以变成一个单一shell命令参数（后一种形式几乎总是优先，除非你非常确定变量中有什么）。因为回车和换行字符在所有的平台上都不能被安全地引用，:'variable_name'形式会打印一个错误消息并且在这类字符出现在值中时不替换该变量值。</p>
<p>有些命令把SQL标识符（例如一个表名）当作参数。这些参数遵循SQL的语法规则：无引号的字母被强制变为小写，而双引号（"）可以保护字母避免大小写转换并且允许在标识符中包含空白。 在双引号内，成对的双引号会被缩减为结果名称中的单个双引号。例如，FOO"BAR"BAZ会被解释成fooBARbaz，而"A weird"" name"会变成A weird" name。</p>
<p>对参数的解析会在行尾或者碰到另一个未加引号的反斜线时停止。一个未加引号的反斜线被当做新元命令的开始。特殊的序列\（两个反斜线）表示参数结束并且应继续解析SQL命令（如果还有）。使用这种方法，SQL命令和sqlsh命令可以被自由地混合在一行中。但是无论在何种情况中，元命令的参数都无法跨越一行。</p>
<p>很多元命令作用在当前查询缓冲区上。这就是一个缓冲区而已，它保存任何已经被键入但是还没有发送到服务器执行的SQL命令文本。这将包括之前输入的行以及在该元命令同一行上出现在前面的任何文本。</p>
<p>可以使用下列元命令：</p>
<h5 id="a"><strong>\a</strong></h5>
<p>如果当前的表输出格式是非对齐的，则切换成对齐格式。如果不是非对齐格式，则设置成非对齐格式。保留这个命令是为了向后兼容性。更一般的方案请见\pset。</p>
<h5 id="c-or-connect-reuse-previousonoff-dbname-username-host-port-conninfo"><strong>\c or \connect [ -reuse-previous=on|off ] [ dbname [ username ] [ host ] [ port ] | conninfo ]</strong></h5>
<p>与一台AiSQL服务器建立一个新连接。可以使用位置语法指定要使用的连接参数，或者使用conninfo连接串。</p>
<p>在省略了数据库名、用户、主机或者端口的命令中，新的连接将会重用之前一个连接的值。默认情况下，前一个连接的值将会被重用，除非给出了一个conninfo串。给出第一个参数-reuse-previous=on或者-reuse-previous=off可以覆盖默认行为。当这个命令既没有指定一个参数也没有重用它时，将使用libpq的默认值。把dbname、username、host或者port中的任何一个指定为-等价于省略该参数。</p>
<p>如果新连接成功地被建立，之前的连接会被关闭。如果连接尝试失败（错误的用户名、访问被拒绝等），只有在sqlsh处于交互模式的情况下才会保留之前的连接。当执行一个非交互式脚本时出现连接尝试失败，处理将被立即停止，并且报出一个错误。这种区别一方面可以帮助用户发现打字错误，另一方面也可以作为一种安全机制防止脚本在错误的数据库上执行动作。</p>
<p>例子：
=&gt; \c mydb myuser host.dom 6432
=&gt; \c service=foo
=&gt; \c "host=localhost port=5432 dbname=mydb connect_timeout=10 sslmode=disable"
=&gt; \c postgresql://tom@localhost/mydb?application_name=myapp</p>
<h5 id="c-title"><strong>\C [title]</strong></h5>
<p>设置作为查询结果打印的任何表的标题，或取消设置任何此类标题。此命令相当于\pset title。（此命令的名称源自“caption”，因为它以前只用于在HTML表中设置标题。）</p>
<h5 id="cd-directory"><strong>\cd [ directory ]</strong></h5>
<p>把当前工作目录改为directory。如果不带参数，则切换到当前用户的主目录。
提示：
要打印当前的工作目录，可以使用! pwd</p>
<h5 id="conninfo"><strong>\conninfo</strong></h5>
<p>输出有关当前数据库连接的信息，包括数据库，用户，和端口。</p>
<h5 id="copy-table-column_list-query-from-to-filename-program-command-stdin-stdout-pstdin-pstdout-with-option"><strong>\copy { table [ ( column_list ) ] | ( query ) } { from | to } { 'filename' | program 'command' | stdin | stdout | pstdin | pstdout } [ [ with ] ( option [, ...] ) ]</strong></h5>
<p>执行一次前端拷贝。这个操作会运行一个SQL COPY命令，不过不是服务器读取或者写入指定的文件，而是由sqlsh读写文件并且把数据从本地文件系统导向服务器。这意味着文件的可访问性和权限是本地用户的而非服务器上的，并且不需要 SQL 超级用户特权。</p>
<p>当program被指定时，command被sqlsh执行并且传给command的数据或者从command传出的数据会在服务器和客户端之间流动。同样地，执行特权是本地用户的而非服务器上的，并且不需要 SQL 超级用户特权。</p>
<p>对于\copy ... from stdin，数据行从发出该命令的同一来源读取，一直到读到 . 或者数据流到达EOF。这个选项可以用来填充内嵌在一个 SQL 脚本文件中的表。对于\copy ... to stdout，输出被发送到与sqlsh命令输出相同的位置，并且COPY count命令的状态不会被打印（因为它会被一个数据行搞乱）。要读/写sqlsh的标准输入或者输出而不管当前命令的来源或者\o选项，可以写from pstdin或者to pstdout。</p>
<p>这个命令的语法和SQL COPY命令类似。所有除开数据来源/目的地的选项都和COPY指定的一样。因此，\copy元命令由特殊的解析规则。与大部分其他元命令不同，该行的所有剩余部分总是会被当做\copy的参数，并且在参数中不会执行变量篡改以及反引号展开。</p>
<p>提示：
获得与\copy ... to相同结果的另一种方法是使用SQL COPY ... TO STDOUT 命令并使用\g filename或\ g | program 终止它。
与\copy不同，此方法允许命令跨越多行; 此外，可以使用变量插值和反引号扩展。
这些操作不如带有文件或程序数据源或目标的SQL COPY命令有效， 因为所有数据都必须通过客户端/服务器连接。 对于大量数据，SQL命令可能更可取。</p>
<h5 id="copyright"><strong>\copyright</strong></h5>
<p>显示PostgreSQL的版权以及发布条款，AiSQL源于PostgreSQL。</p>
<h5 id="crosstabview-colv-colh-cold-sortcolh"><strong>\crosstabview [ colV [ colH [ colD [ sortcolH ] ] ] ]</strong></h5>
<p>执行当前的查询缓冲区（像\g那样）并且在一个交叉表格子中显示结果。该查询必须返回至少三列。由colV标识的输出列会成为垂直页眉，并且colH所标识的输出列会成为水平页眉。colD标识显示在格子中的输出列。sortcolH标识用于水平页眉的可选的排序列。</p>
<p>每一个列说明可以是一个列编号（从 1 开始）或者一个列名。常用的 SQL 大小写折叠和引用规则适用于列名。如果省略，colV被当做列 1 ，并且colH被当做列 2。colH必须和colV不同。如果没有指定colD，那么在查询结果中必须正好有三列，并且colV和colH之外的那一列会被当做colD。</p>
<p>垂直页眉显示为最左边的列，它包含列colV中找到的值，值的顺序和查询结果中的顺序相同，但是重复值会被移除。</p>
<p>水平页眉显示为第一行，它包含列colH中找到的值，其中的重复值被移除。默认情况下，这些值会以查询结果中相同的顺序出现。但是如果给出了可选的sortcolH参数，它标识一个值必须为整数编号的列，并且来自colH的值将会根据相应的sortcolH值排序后出现在水平页眉中。</p>
<p>在交叉表格子中，对于colH的每一个不同的值x，以及colV的每一个不同的值y，位于交叉点(x,y)的单元包含colH值为x且colV值为y的查询结果行中colD列的值。如果没有这样的行，则该单元为空。如果有多个这样的行，则会报告一个错误。</p>
<h5 id="ds-pattern"><strong>\d[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>对于每一个匹配pattern的关系（表、视图、物化视图、索引、序列或者外部表）或者组合类型，显示所有的列、它们的类型、表空间（如果非默认表空间）以及任何诸如NOT NULL或者默认值的特殊属性。相关的索引、约束、规则以及触发器也会被显示。对于外部表，还会显示相关的外部服务器（下文的模式（Pattern）中定义了“匹配模式”）。</p>
<p>对于某些类型的关系，\d会为每一列显示额外的信息：对于序列会显示列值，对于索引显示被索引的表达式，对于外部表显示外部数据包装器选项。</p>
<p>命令形式\d+是一样的，不过会显示更多信息：与该表的列相关的任何注释，表中是否存在 OID，如果关系是视图则显示视图定义。</p>
<p>默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。</p>
<p>注意
如果使用\d但不带有pattern参数，它等价于\dtvmsE，后者将显示所有可见的表、视图、物化视图、序列和外部表的列表。</p>
<h5 id="das-pattern"><strong>\da[S] [ pattern ]</strong></h5>
<p>列出聚集函数，以及它们的返回类型和它们所操作的数据类型。如果指定了pattern，只显示名称匹配该模式的聚集。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。</p>
<h5 id="da-pattern"><strong>\dA[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出访问方法。如果指定了pattern，只显示名称匹配该模式的访问方法。如果在命令名称后面追加+，则与访问方法相关的处理器函数和描述也会和访问方法本身一起被列出。</p>
<h5 id="db-pattern"><strong>\db[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出表空间。如果指定了pattern，只显示名称匹配该模式的表空间。如果在命令名称后面追加+，则与表空间相关的选项、磁盘上的尺寸、权限以及描述也会和表空间本身一起被列出。</p>
<h5 id="dcs-pattern"><strong>\dc[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出字符集编码之间的转换。如果指定了pattern，只列出名称匹配该模式的转换。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。如果在命令名称后面追加+，则每一个对象相关的描述也会被列出。</p>
<h5 id="dc-pattern"><strong>\dC[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出类型转换。如果指定了pattern，只列出源类型和目标类型匹配该模式的转换。如果在命令名称后面追加+，则每一个对象相关的描述也会被列出。</p>
<h5 id="dds-pattern"><strong>\dd[S] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>显示约束、操作符类、操作符族、规则以及触发器类型对象的描述。所有其他注释可以通过那些对象类型相应的反斜线命令查看。</p>
<p>\dd显示匹配pattern的对象的描述，如果没有给出参数则显示合适类型的可见对象的描述。但是在任一种情况下都只列出具有描述的对象。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。</p>
<p>对象的描述可以用SQL命令COMMENT创建。</p>
<h5 id="dds-pattern_1"><strong>\dD[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出域。如果指定了pattern，只有名称匹配该模式的域会被显示。默认情况下，只有用户创建的对象会被显示，可以提供一个模式或者S修饰符以包括系统对象。如果+被追加到命令名称上，每一个被列出的对象会带有其相关的权限和描述。</p>
<h5 id="ddp-pattern"><strong>\ddp [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出默认的访问特权设置。对那些默认特权设置已经被改变得与内建默认值不同的角色（以及模式，如果适用），为每一个角色（以及模式）显示一项。如果指定了pattern，只列出角色名称或者模式名称匹配该模式的项。</p>
<p>ALTER DEFAULT PRIVILEGES命令被用来设置默认访问特权。</p>
<h5 id="des-dis-dms-dss-dts-dvs-pattern"><strong>\dE[S+], \di[S+], \dm[S+], \ds[S+], \dt[S+], \dv[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>在这一组命令中，字母E、i、m、s、t和v分别对应着外部表、索引、物化视图、序列、表和视图。你可以以任何顺序指定这些字母中的任意一个或者多个，这样可以得到这些类型的对象的列表。例如，\dit会列出索引和表。如果在命令名称后面追加+，则每一个对象的物理尺寸以及相关的描述也会被列出。如果指定了pattern，只列出名称匹配该模式的对象。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。</p>
<h5 id="des-pattern"><strong>\des[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出外部服务器（助记：“外部服务器”）。如果指定了pattern，只列出名称匹配该模式的那些服务器。如果使用了\des+形式，将显示每个服务器的完整描述，包括该服务器的访问特权、类型、版本、选项和描述。</p>
<h5 id="det-pattern"><strong>\det[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出外部表（助记：“外部表”）。如果指定了pattern，只列出表名称或者模式名称匹配该模式的项。如果使用了\det+选项，一般选项和外部表描述也会被显示。</p>
<h5 id="deu-pattern"><strong>\deu[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出用户映射（助记：“外部用户”）。如果指定了pattern，只列出用户名匹配该模式的那些映射。如果使用了\deu+形式，有关每个映射的额外信息也会被显示。
注意：
\deu+可能也会显示远程用户的用户名和口令，所以要小心不要把它们泄露出去。</p>
<h5 id="dew-pattern"><strong>\dew[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出外部数据包装器（助记：“外部包装器”）。如果指定了pattern，只列出名称匹配该模式的那些外部数据包装器。如果使用了\dew+形式，外部数据包装器的访问特权、选项和描述也会被显示。</p>
<h5 id="dfantws-pattern"><strong>\df[antwS+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出函数，以及它们的结果数据类型、参数数据类型和函数类型，函数类型被分为“agg”（聚集）、“normal”、“trigger”以及“window”。如果要只显示指定类型的函数，可以在该命令上增加相应的字母a、n、t或者w。如果指定了pattern，只显示名称匹配该模式的函数。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。如果使用了\df+形式，则有关每个函数的额外信息也会被显示，包括易失性、并行安全性、拥有者、安全性分类、访问特权、语言、源代码和描述。</p>
<p>提示
如果要查找接收指定数据类型参数或者返回指定类型值的函数，可以使用分页器的搜索能力来滚动显示\df输出。</p>
<h5 id="df-pattern"><strong>\dF[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出文本搜索配置。如果指定了pattern，只显示名称匹配该模式的配置。如果使用了\dF+形式，每种配置的完整描述也会被显示，包括底层的文本搜索解析器和用于每一种解析器记号类型的字典列表。</p>
<h5 id="dfd-pattern"><strong>\dFd[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出文本搜索字典。如果指定了pattern，只显示名称匹配该模式的字典。如果使用了\dFd+形式，有关每一种选中的字典的额外信息也会被显示，包括底层的文本搜索模板和选项值。</p>
<h5 id="dfp-pattern"><strong>\dFp[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出文本搜索解析器。如果指定了pattern，只显示名称匹配该模式的解析器。如果使用了\dFp+形式，每一种解析器的完整描述也会被显示，包括底层的函数和可识别的记号类型列表。</p>
<h5 id="dft-pattern"><strong>\dFt[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出文本搜索模板。如果指定了pattern，只显示名称匹配该模式的模板。如果使用了\dFt+形式，每一种模板有关的额外信息也会被显示，包括底层的函数名称。</p>
<h5 id="dgs-pattern"><strong>\dg[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出数据库角色（因为“用户”和“组”的概念已经被统一成“角色”，这个命令现在等价于\du）。默认情况下只会显示用户创建的角色，提供一个模式或者S修饰符可以把系统角色包括在内。如果指定了pattern，只列出名称匹配该模式的那些角色。如果使用了\dg+形式，有关每种角色的额外信息也将被显示，当前这种形式会为角色增加显示注释。</p>
<h5 id="dl"><strong>\dl</strong></h5>
<p>这是\lo_list的一个别名，它显示大对象的列表。</p>
<h5 id="dls-pattern"><strong>\dL[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出过程语言。如果指定了pattern，只列出名称匹配该模式的语言。默认情况下只会显示用户创建的语言，提供一个模式或者S修饰符可以把系统对象包括在内。如果向命令名称追加+，则每一种语言会和它的调用处理器、验证器、访问特权以及它是否为系统对象一起列出。</p>
<h5 id="dns-pattern"><strong>\dn[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出模式（名字空间）。如果指定了pattern，只列出名称匹配该模式的模式。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。如果向命令名称追加+，每个对象会与它相关的权限及描述（如果有）一起被列出。</p>
<h5 id="dos-pattern"><strong>\do[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出操作符及其操作数和结果类型。如果指定了pattern，只列出名称匹配该模式的操作符。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。如果向命令名称追加+，有关每个操作符的额外信息也将被显示，当前只包括底层函数的名称。</p>
<h5 id="dos-pattern_1"><strong>\dO[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出排序规则。如果指定了pattern，只列出名称匹配该模式的排序规则。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。如果向命令名称追加+，每个排序规则将和它相关的描述（如果有）一起被列出。注意只有可用于当前数据库编码的排序规则会被显示，因此在同一个安装下的不同数据库中执行此命令可能会得到不同的结果。</p>
<h5 id="dp-pattern"><strong>\dp [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出表、视图和序列，包括与它们相关的访问特权。如果指定了pattern，只列出名称匹配该模式的表、视图以及序列。</p>
<p>GRANT和REVOKE命令被用来设置访问特权。</p>
<h5 id="drds-role-pattern-database-pattern"><strong>\drds [ role-pattern [ database-pattern ] ]</strong></h5>
<p>列出已定义的配置设置。这些设置可以是针对角色的、针对数据库的或者同时针对两者的。role-pattern和database-pattern分别被用来选择要列出的角色和数据库。如果省略它们或者指定了*，则会列出所有设置，分别会包括针对角色和针对数据库的设置。</p>
<p>ALTER ROLE以及ALTER DATABASE命令可以用来定义一个角色以及一个数据库的配置设置。</p>
<h5 id="drp-pattern"><strong>\dRp[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出复制的publication。如果指定有pattern，只有那些名称匹配该模式的publication会被列出。如果+被追加到命令的名称上，与每个publication相关的表也会被显示。</p>
<h5 id="drs-pattern"><strong>\dRs[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出复制的订阅。如果指定有pattern，只有那些名字匹配该模式的订阅才会被列出。如果+被追加到命令的名称上，订阅的额外属性会被显示。</p>
<h5 id="dts-pattern"><strong>\dT[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出数据类型。如果指定了pattern，只列出名称匹配该模式的类型。如果向命令名称追加+，每一种类型、其内部名称和尺寸、允许的值（如果是一种枚举类型）以及相关权限会被一同列出。默认情况下只会显示用户创建的对象，提供一个模式或者S修饰符可以把系统对象包括在内。</p>
<h5 id="dus-pattern"><strong>\du[S+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出数据库角色（因为“用户”和“组”的概念已经被统一成“角色”，这个命令现在等价于\dg）。默认情况下只会显示用户创建的角色，提供一个模式或者S修饰符可以把系统角色包括在内。如果指定了pattern，只列出名称匹配该模式的那些角色。如果使用了\du+形式，有关每一种角色的额外信息也会被显示，当前只会多显示角色的注释。</p>
<h5 id="dx-pattern"><strong>\dx[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出已安装的扩展。如果指定了pattern，只列出名称匹配该模式的那些扩展。如果使用了\dx+形式，所有属于每个匹配扩展的对象会被列出。</p>
<h5 id="dy-pattern"><strong>\dy[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出事件触发器。如果指定了pattern，只列出名称匹配该模式的事件触发器。如果在命令名称后面加上+，还会为每个列出的对象显示其相关的描述。</p>
<h5 id="eedit-filename-line_number"><strong>\e或\edit [ filename ] [ line_number ]</strong></h5>
<p>如果指定了filename，则它是被编辑的文件，在编辑器退出后，该文件的内容会被拷贝到当前查询缓冲区中。如果没有给定filename，当前查询缓冲区会被拷贝到一个临时文件中，并且接着以相同的方式编辑。或者，如果当前查询缓冲区为空，则最近被执行的查询会被拷贝到一个临时文件并且以同样的方式编辑。</p>
<p>然后会根据sqlsh的一般规则重新解析查询缓冲区的新内容，把整个缓冲区当作一个单一行来处理。任何完整的查询都会被立即执行，也就是说，如果查询缓冲区包含一个分号或者以一个分号结尾，则到分号处为止的所有东西都会被执行。剩下的东西会在查询缓冲区中等待，输入分号或者\g会把它发送出去，输入\r会通过清除查询缓冲区来取消它。把缓冲区当作单一行主要会影响元命令：缓冲区中在一个元命令之后的任何东西都将被当作该元命令的参数，即便元命令之后的内容跨越多行也是如此。（因此不能以这种方式来制作使用元命令的脚本。应该使用\i。）</p>
<p>如果指定了一个行号，sqlsh将会把游标（注意不是服务器端的游标）定位到文件或者查询缓冲区的指定行上。注意如果给出了一个全是数字的参数，sqlsh就会假定它是行号而不是文件名。</p>
<h5 id="echo-text"><strong>\echo text [ ... ]</strong></h5>
<p>把参数打印到标准输出，参数之间用一个空格分隔，最后加上一个新行。这可以用来在脚本的输出中间混入信息，例如：</p>
<p>=&gt; \echo <code>date</code>
Tue Oct 26 21:40:57 CEST 1999
如果第一个参数是一个没有加引号的-n，则不会加上最后的新行。</p>
<p>提示：
如果使用\o命令来重定向查询的输出，你可能希望使用\qecho来取代这个命令。</p>
<h5 id="ef-function_description-line_number"><strong>\ef [ function_description [ line_number ] ]</strong></h5>
<p>这个命令会以一个CREATE OR REPLACE FUNCTION或CREATE OR REPLACE PROCEDURE命令的形式取出并且编辑指定函数或过程的定义。编辑的方式与\edit完全相同。在编辑器退出后，更新过的命令将在查询缓冲区中等待，可以键入分号或者\g把它发出，也可以用\r取消之。</p>
<p>目标函数可以单独用名称或者用名称和参数（例如foo(integer, text)）来指定。如果有多于一个函数具有同样的名称，则必须给出参数的类型。</p>
<p>如果没有指定函数，将会给出一个空白的CREATE FUNCTION模板来编辑。</p>
<p>如果指定了一个行号，sqlsh将把游标定位在该函数体的指定行上（注意函数体通常不是开始于文件的第一行）。</p>
<p>和大部分其他元命令不同，该行的整个剩余部分总是会被当作\ef的参数，并且在参数中不会执行变量篡改以及反引号展开。</p>
<h5 id="encoding-encoding"><strong>\encoding [ encoding ]</strong></h5>
<p>设置客户端字符集编码。如果没有参数，这个命令会显示当前的编码。</p>
<h5 id="errverbose"><strong>\errverbose</strong></h5>
<p>以最详细的程度重复最近的服务器错误消息，就好像VERBOSITY被设置为verbose且SHOW_CONTEXT被设置为always。</p>
<h5 id="ev-view_name-line_number"><strong>\ev [ view_name [ line_number ] ]</strong></h5>
<p>这个命令会以一个CREATE OR REPLACE VIEW的形式取出并且编辑指定函数的定义。编辑的方式与\edit完全相同。在编辑器退出后，更新过的命令将在查询缓冲区中等待，可以键入分号或者\g把它发出，也可以用\r取消之。</p>
<p>如果没有指定函数，将会给出一个空白的CREATE VIEW模板来编辑。</p>
<p>如果指定了一个行号，sqlsh将把游标定位在该视图定义的指定行上。</p>
<p>和大部分其他元命令不同，该行的整个剩余部分总是会被当作\ev的参数，并且在参数中不会执行变量篡改以及反引号展开。</p>
<h5 id="f-string"><strong>\f [ string ]</strong></h5>
<p>设置用于非对齐查询输出的域分隔符。默认值是竖线（|）。它等效于\pset fieldsep。</p>
<h5 id="g-filename-g-command"><strong>\g [ filename ]，\g [ |command ]</strong></h5>
<p>把当前查询缓冲区发送给服务器执行。如果给出一个参数，查询的输出将被写到提到的文件或者用管道导向给定的shell命令，而不是按照惯常显示出来。只有该查询成功地返回零或更多个元组时才会写文件或命令，如果查询失败或者不是一个数据返回SQL命令，则不会写文件或者导向shell命令。</p>
<p>如果当前查询缓冲区为空，则重新执行最近一次被发送的查询。除了这种行为之外，没有参数的\g实际上等效于一个分号。一个带有参数的\g是\o命令的一种“一次性”选择。</p>
<p>如果该参数以 | 开始，则该行的所有剩余部分总是会被当做要执行的command，并且在参数中不会执行变量篡改以及反引号展开。该行的剩余部分会被简单地按字面传给shell。</p>
<h5 id="gexec"><strong>\gexec</strong></h5>
<p>把当前查询缓冲区发送到服务器，然后该查询输出（如果有）中的每一行的每一列都当作一个要被执行的 SQL 语句。例如，要在my_table的每一列上都创建一个索引：</p>
<div class="highlight"><pre><span></span><code>=&gt; select format(&#39;create index on my_table(%I)&#39;, attname)
-&gt; FROM pg_attribute
-&gt; WHERE attrelid = &#39;my_table&#39;::regclass AND attnum &gt; 0
-&gt; ORDER BY attnum
-&gt; \gexec
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
</code></pre></div>
<p>产生的查询会按照其所在行被返回的顺序执行，如果有多个列，则同一行中按照从左至右的顺序执行。NULL 域会被忽略。产生的查询会被原样发送给服务器处理，因此它们即不能是sqlsh 元命令，也不能包含sqlsh 变量引用。如果其中任何一个查询失败，剩余查询的执行将会继续，除非设置了ON_ERROR_STOP。每个查询的执行都遵照ECHO的处理（在使用\gexec时，通常建议设置ECHO为all或者queries）。查询日志、单步模式、计时以及其他查询执行特性也适用于每一个生成的查询。</p>
<p>如果当前查询缓冲区为空，则会重新执行最近被发送的查询。</p>
<h5 id="gset-prefix"><strong>\gset [ prefix ]</strong></h5>
<p>把当前查询输入缓冲区发送给服务器并且将查询的输出存储在sqlsh 变量中（见<a href="#_变量">变量</a>）。被执行的查询必须只返回一行。该行的每一列会被存储到一个单独的变量中，变量和该列的名字一样。例如：</p>
<div class="highlight"><pre><span></span><code>=&gt; select &#39;hello&#39; AS var1, 10 AS var2
-&gt; \gset
=&gt; \echo :var1 :var2
hello 10
</code></pre></div>
<p>如果指定了一个prefix，那么该字符串会被追加在该查询的输出列名称之前用来创建要使用的变量名：</p>
<div class="highlight"><pre><span></span><code>=&gt; select &#39;hello&#39; AS var1, 10 AS var2
-&gt; \gset result_
=&gt; \echo :result_var1 :result_var2
hello 10
</code></pre></div>
<p>如果一个列的结果为 NULL，那么对应的变量会被重置而不是被设置。
如果查询失败或者没有返回一行，则不会有任何变量被更改。
如果当前查询缓冲区为空，则重新执行最近被发送的查询。</p>
<h5 id="gx-filename-gx-command"><strong>\gx [ filename ]，\gx [ |command ]</strong></h5>
<p>\gx等效于\g，但会为这个查询强制扩展的输出模式。请参考\x。</p>
<h5 id="h-or-help-command"><strong>\h or \help [ command ]</strong></h5>
<p>给出指定SQL命令的语法帮助。如果没有指定command，则sqlsh会列出可以显示语法帮助的所有命令。如果command是一个星号（*），则会显示所有SQL命令的语法帮助。</p>
<p>与大部分其他元命令不同，该行的所有剩余部分总是会被当做\help的参数，并且在参数中不会执行变量篡改以及反引号展开。
注意
为了简化输入，由几个词构成的命令不需要被加上引号。因此，键入\help alter table是可以的。</p>
<h5 id="h-or-html"><strong>\H or \html</strong></h5>
<p>开启HTML查询输出格式。如果HTML格式已经开启，这会把它切换回默认的对齐文本格式。这个命令是为了兼容性和方便，有关设置其他输出选项请见\pset。</p>
<h5 id="i-or-include-filename"><strong>\i or \include filename</strong></h5>
<p>从文件filename读取输入并且把它当作从键盘输入的命令来执行。</p>
<p>如果filename是-（连字符），那么会一直读取标准输入直到碰到一个 EOF 指示符或者\q元命令。这可以用来把交互式输入与文件输入混杂。注意只有在最外层激活了 readline 行为的情况下才将会使用 readline 行为。</p>
<p>注意
如果想在屏幕上看到被读入的行，必须把变量ECHO设置成all。</p>
<h5 id="if-expressionelif-expressionelseendif"><strong>\if expression，\elif expression，\else，\endif</strong></h5>
<p>这一组命令实现可嵌套的条件块。条件块必须以一个\if开始并且以一个\endif结束。两者之间可能有任意数量的\elif子句，后面也可能有选择地跟着一个单一的\else子句。一般查询以及其他类型的反斜线命令可以出现在这些命令之间构成条件块。</p>
<p>\if和\elif命令读取它们的参数并且将它们作为布尔表达式进行计算。如果表达式得到真则处理正常继续下去，否则会跳过下面的行直到到达一个匹配的\elif、\else或者\endif。一旦一个\if或者\elif测试成功，同一个块中后面的\elif命令的参数将不会被计算但会被当作为假。跟在一个\else后面的行只有在先前的匹配的\if或\elif成功时才被处理。</p>
<p>就像任何其他反斜线命令参数一样，\if或者\elif命令的expression参数服从变量篡改以及反引号展开。然后会像一个on/off选项变量的值一样来计算它。因此，对下列项无歧义、大小写无关的匹配都是有效的值：true、false、1、0、on、off、yes、no。例如，t、T以及tR都将被认为是真。</p>
<p>无法被正确计算为真或假的表达式将产生一个警告并且被当做假。</p>
<p>正在被跳过的行还是会被正常地解析以标识查询和反斜线命令，但是查询不会被发送到服务器，并且非条件（\if、\elif、\else、\endif）反斜线命令会被忽略。条件命令会被检查以判断嵌套是否有效。被跳过的行中的变量引用不会被展开，并且也不会执行反引号展开。</p>
<p>一个给定条件块中的所有反斜线命令必须出现在相同的源文件中。如果在所有的本地\if块被关闭之前，主输入文件或者一个\include进来的文件上就达到了EOF，则sqlsh将产生一个错误。</p>
<p>这里是一个例子：</p>
<div class="highlight"><pre><span></span><code>SELECT
    EXISTS(select 1 FROM customer WHERE customer_id = 123) as is_customer,
    EXISTS(select 1 FROM employee WHERE employee_id = 456) as is_employee
\gset
\if :is_customer
    select * FROM customer WHERE customer_id = 123;
\elif :is_employee
    \echo &#39;is not a customer but is an employee&#39;
    select * FROM employee WHERE employee_id = 456;
\else
    \if yes
        \echo &#39;not a customer or employee&#39;
    \else
        \echo &#39;this will never print&#39;
    \endif
\endif
</code></pre></div>
<h5 id="ir-or-include_relative-filename"><strong>\ir or \include_relative filename</strong></h5>
<p>\ir命令类似于\i，但是以不同的方式处理相对路径文件名。在交互模式中执行时，这两个命令的行为相同。不过，当被从脚本中调用时，\ir相对于脚本所在的目录而不是根据当前工作目录来解释文件名。</p>
<h5 id="l-or-list-pattern"><strong>\l[+] or \list[+] [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出服务器中的数据库并且显示它们的名称、拥有者、字符集编码以及访问特权。如果指定了pattern，则只列出名称匹配该模式的数据库。如果向命令名称追加+，则还会显示数据库的尺寸大小、默认表空间以及描述（尺寸大小信息只对当前用户能连接的数据库可用）。</p>
<h5 id="lo_export-loid-filename"><strong>\lo_export loid filename</strong></h5>
<p>从数据库中读取具有OID loid的大对象并且将它写入到filename。注意这和服务器函数lo_export有微妙的不同，后者会以运行数据库服务器的用户权限来执行并且运行在服务器的文件系统上。</p>
<p>提示
使用\lo_list可以找出大对象的OID。</p>
<h5 id="lo_import-filename-comment"><strong>\lo_import filename [ comment ]</strong></h5>
<p>把该文件存储到AiSQL大对象。可选地，它可以把给定的注释关联到该对象。例如：</p>
<div class="highlight"><pre><span></span><code>foo=&gt; \lo_import &#39;/home/peter/pictures/photo.xcf&#39; &#39;a picture of me&#39;
lo_import 152801
</code></pre></div>
<p>该响应表示该大对象得到的对象 ID 是 152801，未来可以用这个 ID 来访问这个新创建的大对象。为了便于阅读，推荐总是给每一个对象都关联人类可读的注释。OID 和注释都可以用\lo_list命令查看。</p>
<p>注意这个命令和服务器端的lo_import有微妙的不同，因为它以本地文件系统上的本地用户的身份运行，而不是服务器用户和文件系统。</p>
<h5 id="lo_list"><strong>\lo_list</strong></h5>
<p>显示当前存储在数据库中的所有AiSQL大对象，同时显示它们的任何注释。</p>
<h5 id="lo_unlink-loid"><strong>\lo_unlink loid</strong></h5>
<p>从数据库中删除OID为loid的大对象。</p>
<p>提示
使用\lo_list可以找出该大对象的OID。</p>
<h5 id="o-or-out-filenameor-command"><strong>\o or \out [ filenameor  |command ]</strong></h5>
<p>安排把未来的查询结果保存到文件filename中或者用管道导向到 shell 命令command。如果没有指定参数，查询输出会被重置到标准输出。</p>
<p>如果该参数以 | 开始，则该行的所有剩余部分总是会被当做要执行的command，并且在参数中不会执行变量篡改以及反引号展开。该行的剩余部分会被简单地按字面传给shell。</p>
<p>“查询结果”包括从数据库服务器得到的所有表、命令响应和提示，还有查询数据库的各种反斜线命令（如\d）的输出，但不包括错误消息。</p>
<p>提示
要在查询结果之间混入文本输出，可以使用\qecho。</p>
<h5 id="p-or-print"><strong>\p or \print</strong></h5>
<p>把当前查询缓冲区打印到标准输出。如果当前查询缓冲区为空，会打印最近被执行的查询。</p>
<h5 id="password-username"><strong>\password [ username ]</strong></h5>
<p>更改指定用户（默认情况下是当前用户）的口令。这个命令会提示要求输入新口令、对口令加密然后把加密后的口令作为一个ALTER ROLE命令发送到服务器。这确保新口令不会以明文的形式出现在命令历史、服务器日志或者其他地方。</p>
<h5 id="prompt-text-name"><strong>\prompt [ text ] name</strong></h5>
<p>提示用户提供一个文本用于分配给变量name。可以指定一个可选的提示字符串text（对于多个词组成的提示，把文本包裹在单引号中）。</p>
<p>默认情况下，\prompt使用终端进行输入和输出。不过，如果使用了-f命令行开关，\prompt会使用标准输入和标准输出。</p>
<h5 id="pset-option-value"><strong>\pset [ option [ value ] ]</strong></h5>
<p>这个命令设置影响查询结果表输出的选项。option表示要设置哪个选项。value的语义取决于选中的选项。对于某些选项，如果省略value会导致该选项值被切换或者被重置，具体是哪些选项可见特定选项的描述。如果没有上面提到的那种行为，那么省略value只会导致当前设置被显示。</p>
<p>不带任何参数的\pset显示所有打印选项的当前状态。</p>
<p>基本语法：
\pset [ option [ value ] ]</p>
<p>解释：
    option ：表示要设置哪个选项
    value ：语义取决于选中的选项</p>
<p>可调整的打印选项（option）有：
<strong>border</strong>
value必须是一个数字。通常，数字越大，表格就会有更多的边框和线条，但具体要看是哪一种格式。在HTML格式中，这会直接被转换成border=...属性。在大部分其他格式中，只有值 0（没有边框）、1（内部分隔线）和 2（表格边框）有意义，并且 2 以上的值会被视为与border = 2相同。latex和latex-longtable格式会额外地允许一个值 3 表示在数据行之间增加分隔线。</p>
<p><strong>columns</strong>
为wrapped格式设置目标宽度，还有扩展自动模式中决定输出是否足够多到需要分页器或者切换到垂直显示的宽度限制。0（默认）导致目标宽度由环境变量COLUMNS所控制，如果没有设置COLUMNS则使用检测到的屏幕宽度。此外，如果columns为0，则wrapped格式只影响屏幕输出。如果columns为非零则文件和管道输出也会被包裹成该宽度。</p>
<p><strong>expanded (or x)</strong>
如果value被指定，它必须是on或者off，它们分别会启用或者禁用扩展模式，也可以是auto。如果value被省略，则该命令会在开启和关闭设置之间切换。当扩展模式被启用时，查询结果被显示在两列中，第一列是列名而第二列是列值，列名在左边，数据在右边。如果在通常的“水平”模式中数据不适合屏幕，则可以用这种模式。在自动设置中，只要查询输出有多于一列并且比屏幕宽，就会使用扩展模式。否则，将使用常规模式。只有在对齐格式和 wrapped 格式中自动设置才有效。在其他格式中，它的行为总是像扩展模式被关闭一样。</p>
<p><strong>fieldsep</strong>
指定在非对齐输出格式中使用的域分隔符。例如，您可以创建以制表符或逗号分隔的输出，这种形式其他程序可能更喜欢。要设置 tab 为域分隔符，可以键入\pset fieldsep '\t'。默认的域分隔符是 '|'（一个竖线）。</p>
<p><strong>fieldsep_zero</strong>
把用在非对齐输出格式中的域分隔符设置为一个零字节。</p>
<p><strong>footer</strong>
如果value被指定，它必须是on或者off，它们分别会启用或者禁用表格页脚（(n rows)计数）的显示。如果value被省略，则该命令会切换页脚显示为打开或者关闭。</p>
<p><strong>format</strong>
设置输出格式为下列的一种： aligned, asciidoc, html, latex(使用tabular), latex-longtable, troff-ms, unaligned, 或 wrapped。允许唯一的缩写。</p>
<p>aligned 格式是标准，普通人可阅读的、良好格式化的文本输出；这是默认值。
unaligned格式把一个数据行的所有列都写在一行上，之间用当前活动的域分隔符分隔。这可用于生成意图由其他程序读取的输出，例如，tab 分隔或者逗号分隔格式。
wrapped格式和aligned相似，但是前者会把过宽的数据值分成多个行以便输出能够适合目标行的宽度。目标行的宽度由columns选项决定。注意sqlsh将不会尝试对列头部标题进行换行，因此如果列头部需要的总宽度超过目标宽度，wrapped格式的行为就变得和aligned一样了。
asciidoc, html,latex, latex-longtable, 和troff-ms 格式分别用相应的标记语言把要输出的表格放在文档中，不过它们的输出并不是完整的文档。 这在HTML中也许不重要，但是在LaTeX中必须有完整的文档包装器。 latex-longtable 格式需要 LaTeX、longtable 和 booktabs 包。</p>
<p><strong>linestyle</strong>
设置边框线的绘制样式为ascii或者unicode之一。允许不产生歧义的缩写（这意味着一个字母就足够了）。默认的设置是ascii。这个选项只影响aligned以及wrapped输出格式。
ascii样式使用纯ASCII字符。数据中的新行使用一个+符号在右边的空白处显示。当在wrapped格式中包裹两行中间没有新行字符的数据时，会在第一行右边空白处显示一个点号（.），并且在下一行的左边空白处也显示一个点号（.）。
unicode样式使用 Unicode 的方框绘制字符。数据中的新行会使用一个回车符号显示在右边的空白处。当数据从一行换行到下一行而不使用换行符时，省略号将显示在第一行的右边，并再次显示在下一行的左边。
当border设置大于0时，linestyle选项也决定边框线用什么字符绘制。纯ASCII字符到处都可以使用，但是在识别 Unicode 字符的显示上使用 Unicode 字符会更好看。</p>
<p><strong>null</strong>
设置要用来替代空值被打印的字符串。默认是什么也不打印，对于一个空字符串这很容易弄错。例如，有人可能更想用\pset null '(null)'。</p>
<p><strong>numericlocale</strong>
如果value被指定，它必须是on或者off，它们将分别启用或者禁用一个与区域相关的字符来分隔数字和左边的十进制标记。如果value被省略，该命令会在常规输出和区域相关的数字输出之间切换。</p>
<p><strong>pager</strong>
控制对查询和sqlsh的帮助输出使用分页器程序。如果环境变量PAGER被设置，输出会被用管道输送到指定的程序。否则将使用与平台相关的默认分页器程序（例如more）。</p>
<p>如果pager选项被设为off，则不会使用分页器程序。如果pager选项被设为on，则会在适当的时候使用分页器，即当输出到终端并且无法适合屏幕时就会使用分页器。pager选项也可以被设置为always，这会导致对所有的终端输出都是用分页器而不管输出是否适合屏幕。不带value的\pset pager会切换分页器开、关状态。</p>
<p><strong>pager_min_lines</strong>
如果pager_min_lines被设置为一个大于页面高度的数字，在至少这么多输出行被显示之前都不会调用分页器程序。默认设置为 0。</p>
<p><strong>recordsep</strong>
指定用在非对齐输出格式中的记录（行）分隔符。默认为换行符。</p>
<p><strong>recordsep_zero</strong>
把用在非对齐输出格式中的记录分隔符设置为一个零字节。</p>
<p><strong>tableattr (or T)</strong>
在HTML格式中，这会指定要放在table标记内的属性。例如，这可能是cellpadding或者bgcolor。注意你可能不想在这里指定border，因为那由\pset border负责。如果没有给出value，则表属性不会被设置。</p>
<p>在latex-longtable格式中，这个选项控制每个包含左对齐数据类型的列的宽度比例。这个选项的值是一个由空格分隔的值列表，例如'0.2 0.2 0.6'。没有指定的输出列会使用最后一个指定的值。</p>
<p><strong>title (or C)</strong>
设置用于任何后续被打印表的表标题。这可以用来给输出加上描述性的标签。如果没有给出value，这个标题不会被设置。</p>
<p><strong>tuples_only (or t)</strong>
如果value被指定，它必须是on或者off，这个选项将启用或者禁用只显示元组的模式。如果value被省略，则该命令会在常规输出和只显示元组输出之间切换。常规输出包括列头、标题以及多种页脚之类的额外信息。在只显示元组的模式中，只会显示实际的表数据。</p>
<p><strong>unicode_border_linestyle</strong>
设置unicode线型的边框绘制风格为single或者double之一。</p>
<p><strong>unicode_column_linestyle</strong>
设置unicode线型的列绘制风格为single或者double之一。</p>
<p><strong>unicode_header_linestyle</strong>
设置unicode线型的页眉绘制风格为single或者double之一。</p>
<p>提示
\pset有多种快捷命令。请参见\a、\C、\f、\H、\t、\T以及\x。</p>
<h5 id="q-or-quit"><strong>\q or \quit</strong></h5>
<p>退出sqlsh程序。在一个脚本文件中，只有该脚本的执行会被终止。</p>
<h5 id="qecho-text"><strong>\qecho text [ ... ]</strong></h5>
<p>这个命令和\echo一样，不过输出将被写到\o所设置的查询输出通道。</p>
<h5 id="r-or-reset"><strong>\r or \reset</strong></h5>
<p>重置（清除）查询缓冲区。</p>
<h5 id="s-filename"><strong>\s [ filename ]</strong></h5>
<p>打印sqlsh的命令行历史到filename。如果省略filename，该历史会被写入到标准输出（如果适用则使用分页器）。如果编译sqlsh时没有加上Readline支持，则这个命令不可用。</p>
<h5 id="set-name-value"><strong>\set [ name [ value [ ... ] ] ]</strong></h5>
<p>设置sqlsh变量name为value，如果给出了多于一个值，则把该变量的值设置为所有给出的值的串接。如果只给了一个参数，该变量会被设置为空字符串值。要重置一个变量，可以使用\unset 命令。</p>
<p>不带任何参数的\set显示所有当前设置的sqlsh变量的名称和值。</p>
<p>合法的变量名可以包含字母、数字和下划线。变量名是大小写敏感的。
某些变量是特殊的，它们控制sqlsh的行为，或者会被自动设置以反映连接状态。这些变量在下文的变量中记录。</p>
<p>注意
这个命令和SQL命令SET无关。</p>
<h5 id="setenv-name-value"><strong>\setenv name [ value ]</strong></h5>
<p>把环境变量name设置为value，如果没有提供value，则不会设置该环境变量。例如：</p>
<div class="highlight"><pre><span></span><code>testdb=&gt; \setenv PAGER less
testdb=&gt; \setenv LESS -imx4F
</code></pre></div>
<h5 id="sf-function_description"><strong>\sf[+] function_description</strong></h5>
<p>这个命令以一个CREATE OR REPLACE FUNCTION命令或者CREATE OR REPLACE PROCEDURE命令取出并且显示指定函数或者过程的定义。定义会被打印到当前的查询输出渠道，就像\o所作的那样。</p>
<p>目标函数可以单独用名称指定，也可以用名称和参数指定，例如foo(integer, text)。如果有多于一个函数具有相同的名字，则必须给出参数的类型。</p>
<p>如果向命令名称追加 + ，那么输出行会被编号，函数体的第一行会被编为 1。</p>
<p>与大部分其他元命令不同，该行的所有剩余部分总是会被当做\sf的参数，并且在参数中不会执行变量篡改以及反引号展开。</p>
<h5 id="sv-view_name"><strong>\sv[+] view_name</strong></h5>
<p>这个命令以一个CREATE OR REPLACE VIEW命令取出并且显示指定视图的定义。定义会被打印到当前的查询输出渠道，就像\o所作的那样。</p>
<p>如果在命令名称上追加+，那么输出行会从 1 开始编号。</p>
<p>与大部分其他元命令不同，该行的所有剩余部分总是会被当做\sv的参数，并且在参数中不会执行变量篡改以及反引号展开。</p>
<h5 id="t"><strong>\t</strong></h5>
<p>切换输出列名标题和行计数页脚的显示。这个命令等效于\pset tuples_only，提供它只是为了使用方便而已。</p>
<h5 id="t-table_options"><strong>\T table_options</strong></h5>
<p>指定在HTML输出格式中，要放在table标签内的属性。这个命令等效于\pset tableattr table_options。</p>
<h5 id="timing-on-off"><strong>\timing [ on | off ]</strong></h5>
<p>如果给出一个参数，这个参数用来打开或者关闭对每个SQL语句执行时长的显示。如果没有参数，则在打开和关闭之间切换。显示的数据以毫秒为单位，超过1秒的区间还会被显示为“分钟:秒”的格式，如果必要还会加上小时和日的字段。</p>
<h5 id="unset-name"><strong>\unset name</strong></h5>
<p>重置（删除）sqlsh变量name。</p>
<p>大部分控制sqlsh行为的变量不能被重置，相反，\unset命令会被解释为把它们设置为其默认值。请参考下文的变量。</p>
<h5 id="w-or-write-filenameor-command"><strong>\w or \write</strong> <strong>[</strong> <strong>filenameor</strong> <strong>|command]</strong></h5>
<p>把当前查询缓冲区写到文件filename或者用管道导出到 shell 命令command。如果当前查询缓冲区为空，则写最近被执行的查询。</p>
<p>如果参数以 | 开始，则该行的整个剩余部分会被当做要执行的command，并且在参数中不会执行变量篡改以及反引号展开。该行的剩余部分会被简单地按字面传递给shell。</p>
<h5 id="watch-seconds"><strong>\watch [ seconds ]</strong></h5>
<p>反复执行当前的查询缓冲区（就像\g那样）直到被中止或者查询失败。两次执行之间等待指定的秒数（默认是 2 秒）。显示每个查询结果时带上一个由\pset title字符串（如果有）、从查询开始起的时间以及延时间隔组成的页眉。</p>
<p>如果当前查询缓冲区为空，则会重新执行最近被发送的查询。</p>
<h5 id="x-on-off-auto"><strong>\x [ on | off | auto ]</strong></h5>
<p>设置或者切换扩展表格格式化模式。究其本身而言，这个命令等效于\pset expanded。</p>
<h5 id="z-pattern"><strong>\z [</strong> <a href="#_模式（Pattern）">pattern</a><strong>]</strong></h5>
<p>列出表、视图和序列，以及它们相关的访问特权。如果指定了pattern，则只会列出名称匹配该模式的表、视图和序列。</p>
<p>这是\dp（“display privileges”）的一个别名。</p>
<h5 id="command_1"><strong>! [ command ]</strong></h5>
<p>如果没有参数，就跳出到一个子shell，当子shell退出时sqlsh会继续。如果有一个参数，则执行shell命令command。</p>
<p>与大部分其他元命令不同，该行的所有剩余部分总是会被当做 ! 的参数，并且在参数中不会执行变量篡改以及反引号展开。该行的剩余部分会被简单地按字面传递给shell。</p>
<h5 id="topic"><strong>\? [ topic ]</strong></h5>
<p>显示帮助信息。可选的topic参数（默认是commands）选择解释sqlsh的哪一部分：commands表示sqlsh的反斜线命令；options表示可以传递给sqlsh的命令行选项；而variables显示有关sqlsh配置变量的帮助。</p>
<h4 id="pattern"><strong>模式（Pattern）</strong></h4>
<p>很多\d命令都可以用一个pattern参数来指定要被显示的对象名称。在最简单的情况下，模式正好就是该对象的准确名称。在模式中的字符通常会被变成小写形式（就像在 SQL 名称中那样），例如\dt FOO将会显示名为foo的表。就像在 SQL 名称中那样，把模式放在双引号中可以阻止它被转换成小写形式。如果需要在一个模式中包括一个真正的双引号字符，则需要把它写成两个相邻的双引号，这同样是符合 SQL 引用标识符的规则。例如，\dt "FOO""BAR"将显示名为FOO"BAR（不是foo"bar）的表。和普通的 SQL 名称规则不同，你不能只在模式的一部分周围放上双引号，例如\dt FOO"FOO"BAR将会显示名为fooFOObar的表。</p>
<p>只要pattern参数被完全省略，\d命令会显示在当前 schema 搜索路径中可见的全部对象 — 这等价于用<em>作为模式（如果一个对象所在的 schema 位于搜索路径中并且没有同类且同名的对象出现在搜索路径中该 schema 之前的 schema 中，则说该对象是可见的。这表示可以直接用名称引用该对象，而不需要用 schema 来进行限定）。要查看数据库中所有的对象而不管它们的可见性，可以把</em>.*用作模式。</p>
<p>如果放在一个模式中，<em>将匹配任意字符序列（包括空序列），而?会匹配任意的单个字符（这种记号方法就像 Unix shell 的文件名模式一样）。例如，\dt int</em>会显示名称以int开始的表。但是如果被放在双引号内，*和?就会失去这些特殊含义而变成普通的字符。</p>
<p>包含一个点号（.）的模式被解释为一个 schema 名称模式后面跟上一个对象名称模式。例如，\dt foo<em>.</em>bar*会显示名称以foo开始的 schema 中所有名称包括bar的表。如果没有出现点号，那么模式将只匹配当前 schema 搜索路径中可见的对象。同样，双引号内的点号会失去其特殊含义并且变成普通的字符。</p>
<p>高级用户可以使用字符类等正则表达式记法，如[0-9]可以匹配任意数字。所有的正则表达式特殊字符都按照规定工作，以下字符除外：<strong>.</strong> 会按照上面所说的作为一种分隔符，<em>会被翻译成正则表达式记号 </em><em>.</em><em><em> ，? 会被翻译成 . ，而$则按字面意思匹配。根据需要，可以通过书写?、(R+|)、(R|)来分别模拟模式字符 .、R</em>和R?。$不需要作为一个正则表达式字符，因为模式必须匹配整个名称，而不是像正则表达式的常规用法那样解释（换句话说，$会被自动地追加到模式上）。如果不希望该模式的匹配位置被固定，可以在开头或者结尾写上</em>。注意在双引号内，所有的正则表达式特殊字符会失去其特殊含义并且按照其字面意思进行匹配。还有，在操作符名称模式中（即作为\do的参数），正则表达式特殊字符也按照字面意思进行匹配。</p>
<h4 id="_16"><strong>示例</strong></h4>
<h5 id="_17"><strong>创建数据库</strong></h5>
<p>启动一个sqlsh会话，然后输入以下命令以创建并连接到数据库：</p>
<div class="highlight"><pre><span></span><code>CREATE DATABASE testdb;
\c testdb;
</code></pre></div>
<p>以下创建表的命令显示了如何将SQL语句分布在多行输入中。请注意更改提示： </p>
<div class="highlight"><pre><span></span><code>CREATE TABLE my_table (
     first integer not null default 0,
     second text)
;

testdb=# CREATE TABLE my_table (
testdb(#    first integer not null default 0,
testdb(#    second text)
testdb-# ;
CREATE TABLE
</code></pre></div>
<p>查看表定义：</p>
<div class="highlight"><pre><span></span><code>\d my_table

Table &quot;public.my_table&quot;
Column |  Type   | Collation | Nullable | Default
----------+-------------+-----------+----------+---------
first    | integer   |        | not null | 0
second  | text     |        |       |
</code></pre></div>
<p>插入数据：</p>
<div class="highlight"><pre><span></span><code>INSERT INTO my_table VALUES (1, &#39;one&#39;);
INSERT INTO my_table VALUES (2, &#39;two&#39;);
INSERT INTO my_table VALUES (3, &#39;three&#39;);
INSERT INTO my_table VALUES (4, &#39;four&#39;);
</code></pre></div>
<div class="highlight"><pre><span></span><code>select * FROM my_table;

 first | second
-------+--------
     1 | one
     2 | two
     3 | three
     4 | four
(4 rows)
</code></pre></div>
<h5 id="_18"><strong>更改提示符</strong></h5>
<p>将提示更改为更有趣的内容：</p>
<div class="highlight"><pre><span></span><code>\set PROMPT1 &#39;%n@%m %~%R%# &#39;

biginsights@localhost testdb=#
</code></pre></div>
<h5 id="_19"><strong>交叉表视图</strong></h5>
<p>可以使用\crostabview命令在交叉表中显示查询结果</p>
<div class="highlight"><pre><span></span><code>select first, second, first &gt; 2 AS gt2 FROM my_table;

 first | second | gt2
-------+--------+-----
     1 | one    | f
     2 | two    | f
     3 | three  | t
     4 | four   | t
(4 rows)
</code></pre></div>
<div class="highlight"><pre><span></span><code>\crosstabview first second

 first | one | two | three  | four
-------+-----+-----+-------+------
   1 | f   |    |      |
   2 |    | f   |      |
   3 |    |    | t     |
   4 |    |    |      | t
(4 rows)
</code></pre></div>
<p>以下示例显示了表中的行按相反的数字顺序排列，列按独立的升序排列。</p>
<div class="highlight"><pre><span></span><code>select t1.first as &quot;A&quot;, t2.first+100 AS &quot;B&quot;, t1.first*(t2.first+100) as &quot;AxB&quot;,
 row_number() over(order by t2.first) AS ord
 FROM my_table t1 CROSS JOIN my_table t2 ORDER BY 1 DESC
 \crosstabview &quot;A&quot; &quot;B&quot; &quot;AxB&quot; ord
</code></pre></div>
<div class="highlight"><pre><span></span><code> A | 101 | 102 | 103 | 104
---+-----+-----+-----+-----
 4 | 404 | 408 | 412 | 416
 3 | 303 | 306 | 309 | 312
 2 | 202 | 204 | 206 | 208
 1 | 101 | 102 | 103 | 104
(4 rows)
</code></pre></div>
<h5 id="pset"><strong>pset</strong></h5>
<p>可以使用\pset命令以不同的方式显示表格：</p>
<div class="highlight"><pre><span></span><code>\pset border 2

Border style is 2.
</code></pre></div>
<div class="highlight"><pre><span></span><code>select * FROM my_table;
</code></pre></div>
<div class="highlight"><pre><span></span><code>+-------+--------+
| first | second |
+-------+--------+
|     1 | one    |
|     2 | two    |
|     3 | three  |
|     4 | four   |
+-------+--------+
(4 rows)
</code></pre></div>
<div class="highlight"><pre><span></span><code>\pset format unaligned

Output format is unaligned.

\pset fieldsep ,

Field separator is &quot;,&quot;.

\pset tuples_only

Showing only tuples.

select second, first FROM my_table;

one,1
two,2
three,3
four,4
</code></pre></div>
<p>或者，使用简短的命令：</p>
<p>\a \t \x</p>
<div class="highlight"><pre><span></span><code>Output format is aligned.
Tuples only is off.
Expanded display is on.

select * FROM my_table;

-[ RECORD 1 ]-
first  | 1
second | one
-[ RECORD 2 ]-
first  | 2
second | two
-[ RECORD 3 ]-
first  | 3
second | three
-[ RECORD 4 ]-
first  | 4
second | four
</code></pre></div>
<h3 id="cqlsh"><strong>cqlsh</strong></h3>
<p>用于与 AiSQL BCQL API 交互的 Shell</p>
<h4 id="_20"><strong>概述</strong></h4>
<p>BCQL shell (cqlsh) 是一个使用 BCQL 与 AiSQL 交互的 CLI。</p>
<p><strong>1.安装</strong>
cqlsh 作为 AiSQL 的一部分安装，位于 AiSQL 主目录的 bin 目录中。 您还可以从 cqlsh GitHub 存储库下载它。</p>
<p>如果您愿意，可以使用 shell 脚本安装独立版本：</p>
<div class="highlight"><pre><span></span><code>curl -sSL https://downloads.bigmath.com/get_clients.sh | bash
</code></pre></div>
<p>如果您有 wget，则可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>wget -q -O - https://downloads.bigmath.com/get_clients.sh | sh
</code></pre></div>
<p><strong>2.启动</strong> <strong>cqlsh</strong></p>
<div class="highlight"><pre><span></span><code>./bin/cqlsh
</code></pre></div>
<div class="highlight"><pre><span></span><code>Connected to local cluster at 127.0.0.1:9542.
[cqlsh 5.0.1 | Cassandra 3.9-SNAPSHOT | CQL spec 3.4.2 | Native protocol v4]
Use HELP for help.
cqlsh&gt;
</code></pre></div>
<p><strong>3.在线帮助</strong>
运行 cqlsh --help 显示在线帮助。</p>
<h4 id="_21"><strong>语法</strong></h4>
<p>cqlsh [flags] [host [port]]</p>
<p>host 是运行DBServer 的主机的IP 地址。 默认为本地主机 127.0.0.1。
port 是 DBServer 侦听 BCQL 连接的 TCP 端口。 默认值为 9542。</p>
<p>1.示例
./bin/cqlsh --execute "select cluster_name, data_center, rack from system.local" 127.0.0.1</p>
<div class="highlight"><pre><span></span><code> cluster_name  | data_center | rack
---------------+-------------+-------
 local cluster | datacenter1 | rack1
</code></pre></div>
<p>2.标志</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>简写</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>--color</td>
<td>-C</td>
<td></td>
<td>强制颜色输出</td>
</tr>
<tr>
<td>--no-color</td>
<td></td>
<td></td>
<td>禁用颜色输出。</td>
</tr>
<tr>
<td>--browser</td>
<td></td>
<td></td>
<td>指定用于显示 cqlsh 帮助的浏览器。 这可以是受支持的浏览器名称之一（例如 Firefox），也可以是后跟 %s 的浏览器路径（例如 /usr/bin/google-chrome-stable %s）。</td>
</tr>
<tr>
<td>--ssl</td>
<td></td>
<td></td>
<td>连接到 AiSQL 时使用 SSL。</td>
</tr>
<tr>
<td>--user</td>
<td>-u</td>
<td></td>
<td>用于对 AiSQL 进行身份验证的用户名。</td>
</tr>
<tr>
<td>--password</td>
<td>-p</td>
<td></td>
<td>用于对AiSQL进行身份验证的密码应，与--user 结合使用</td>
</tr>
<tr>
<td>--keyspace</td>
<td>-k</td>
<td></td>
<td>用于身份验证的密钥空间，应与 --user 结合使用。</td>
</tr>
<tr>
<td>--file</td>
<td>-f</td>
<td></td>
<td>从给定文件执行命令，然后退出。</td>
</tr>
<tr>
<td>--debug</td>
<td></td>
<td></td>
<td>打印附加调试信息。</td>
</tr>
<tr>
<td>--encoding</td>
<td></td>
<td>UTF-8</td>
<td>指定输出的非默认编码。</td>
</tr>
<tr>
<td>--cqlshrc</td>
<td></td>
<td></td>
<td>指定 cqlshrc 文件的位置。 cqlshrc 文件包含 cqlsh 的配置选项。 默认情况下，它位于用户主目录 ~/.cassandra/cqlsh 中。</td>
</tr>
<tr>
<td>--execute</td>
<td>-e</td>
<td></td>
<td>执行给定的语句，然后退出。</td>
</tr>
<tr>
<td>--connect-timeout</td>
<td></td>
<td>2</td>
<td>指定连接超时（以秒为单位）。</td>
</tr>
<tr>
<td>--request-timeout</td>
<td></td>
<td>10</td>
<td>指定请求超时（以秒为单位）。</td>
</tr>
<tr>
<td>--tty</td>
<td>-t</td>
<td></td>
<td>强制 tty 模式（命令提示符）。</td>
</tr>
<tr>
<td>--refresh_on_describe</td>
<td>-r</td>
<td></td>
<td>强制刷新 DESCRIBE 上的架构元数据</td>
</tr>
</tbody>
</table>
<p>3.将 BCQL 输出保存到文件
要将 BCQL 语句的输出保存到文件，请使用 --execute 标志运行该语句，并将输出重定向到文件。
例如，要保存 SELECT 语句的输出：</p>
<div class="highlight"><pre><span></span><code>./bin/cqlsh -e &quot;SELECT * FROM mytable&quot; &gt; output.txt
</code></pre></div>
<h4 id="_22"><strong>特殊的命令</strong></h4>
<p>除了支持常规的BCQL语句外，cqlsh还支持下列特殊命令。</p>
<p>1.Captures 
Captures命令输出并将其附加到指定的文件中。当输出被Captures时，它不会显示在控制台。</p>
<div class="highlight"><pre><span></span><code>CAPTURE &#39;&lt;file&gt;&#39;
CAPTURE OFF
CAPTURE
</code></pre></div>
<ul>
<li>要附加的文件的路径必须在字符串文字内给出。 该路径是相对于当前工作目录解释的。 支持使用波形符简写符号 (~/mydir) 来引用 $HOME。</li>
<li>仅捕获查询结果输出。 仅 cqlsh 命令的错误和输出仍显示在 cqlsh 会话中。</li>
<li>要停止捕获输出并再次在 cqlsh 会话中显示它，请使用 CAPTURE OFF。</li>
<li>要查看当前捕获配置，请使用不带参数的 CAPTURE。</li>
</ul>
<p>2.clear
清除控制台。</p>
<div class="highlight"><pre><span></span><code>CLEAR
CLS
</code></pre></div>
<p>3.CONSISTENCY 
CONSISTENCY <consistency level></p>
<p>设置后续读取操作的一致性级别。 有效参数包括：</p>
<table>
<thead>
<tr>
<th>一致性级别</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>QUORUM</td>
<td>从Tile的法定人数中读取高度一致的结果。 读取请求将仅由 Tablet Leader 处理。 这是默认的一致性级别。</td>
</tr>
<tr>
<td>ONE</td>
<td>从具有宽松一致性保证的追随者处读取</td>
</tr>
</tbody>
</table>
<p>4.COPY FROM
将数据从 CSV 文件复制到表。
COPY <table name> [(<column>, ...)] FROM <file name> WITH <copy flag> [AND <copy flag> ...]</p>
<p>默认情况下，COPY FROM 将所有列从 CSV 文件复制到表中。 要复制列的子集，请在表名称后面添加用括号括起来的以逗号分隔的列名称列表。</p>
<p>file name应该是表示源文件路径的字符串文字（带单引号）。 使用特殊值 STDIN（不带单引号）从 stdin 读取 CSV 数据。</p>
<table>
  <thead>
    <tr>
        <th>标志</th>
        <th>默认值</th>
        <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
        <td>INGESTRATE</td>
        <td>100000</td>
        <td>每秒处理的最大行数。</td>
    </tr>
    <tr>
        <td>MAXROWS</td>
        <td>-1</td>
        <td>要导入的最大行数。 -1表示无限制。</td>
    </tr>
    <tr>
        <td>SKIPROWS</td>
        <td>0</td>
        <td>要跳过的初始行数。</td>
    </tr>
    <tr>
        <td>SKIPCOLS</td>
        <td></td>
        <td>要忽略的以逗号分隔的列名称列表。 默认情况下，不跳过任何列。</td>
    </tr>
    <tr>
        <td>MAXPARSEERRORS</td>
        <td>-1</td>
        <td>要忽略的最大全局解析错误数。 -1表示无限制。</td>
    </tr>
    <tr>
        <td>MAXINSERTERRORS</td>
        <td>1000</td>
        <td>要忽略的最大全局插入错误数。 -1表示无限制。</td>
    </tr>
    <tr>
        <td>ERRFILE=</td>
        <td></td>
        <td>一个文件，用于存储所有无法导入的行； 默认情况下，这是 import_&lt;ks&gt;_&lt;table&gt;.err 其中 &lt;ks&gt; 是键空间，&lt;table&gt; 是表名称。</td>
    </tr>
    <tr>
        <td>MAXBATCHSIZE</td>
        <td>20</td>
        <td>单个批次中插入的最大行数。</td>
    </tr>
    <tr>
        <td>MINBATCHSIZE</td>
        <td>2</td>
        <td>在单个批次中插入的最小行数。</td>
    </tr>
    <tr>
        <td>CHUNKSIZE</td>
        <td>1000</td>
        <td>一次从主进程传递给子工作进程的行数。</td>
    </tr>
  </tbody>
</table>

<p>请参阅 COPY TO 了解 COPY TO 和 COPY FROM 共有的其他标志</p>
<p>5.COPY TO 
将数据从表复制到 CSV 文件。
COPY <table name> [(<column>, ...)] TO <file name> WITH <copy flag> [AND <copy flag> ...]</p>
<p>默认情况下，COPY TO 将表中的所有列复制到 CSV 文件。 要复制列的子集，请在表名称后面添加用括号括起来的以逗号分隔的列名称列表。</p>
<p>文件名应该是一个字符串文字（带单引号），表示目标文件的路径。 您还可以使用特殊值 STDOUT（不带单引号）将 CSV 打印到 stdout。</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAXREQUESTS</td>
<td>6</td>
<td>同时获取的最大令牌数量范围。</td>
</tr>
<tr>
<td>PAGESIZE</td>
<td>1000</td>
<td>单页中要获取的行数。</td>
</tr>
<tr>
<td>PAGETIMEOUT</td>
<td>10</td>
<td>页面大小或更小的每 1000 个条目的超时（以秒为单位）。</td>
</tr>
<tr>
<td>BEGINTOKEN，ENDTOKEN</td>
<td></td>
<td>要导出的令牌范围。 默认导出整个环。</td>
</tr>
<tr>
<td>MAXOUTPUTSIZE</td>
<td>-1</td>
<td>输出文件的最大大小（以行数为单位）； 超过此最大值，输出文件将被分成多个段。 -1表示无限制。</td>
</tr>
<tr>
<td>ENCODING</td>
<td>utf8</td>
<td>用于字符的编码。</td>
</tr>
</tbody>
</table>
<p>以下标志对于 COPY TO 和 COPY FROM 都是通用的。</p>
<table>
<thead>
<tr>
<th>标志</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>NULLVAL</td>
<td>null</td>
<td>空值的字符串占位符。</td>
</tr>
<tr>
<td>HEADER</td>
<td>false</td>
<td>对于 COPY TO，控制 CSV 输出文件中的第一行是否包含列名称。 对于 COPY FROM，指定 CSV 输入文件中的第一行是否包含列名称。</td>
</tr>
<tr>
<td>DELIMITER</td>
<td>,</td>
<td>用于分隔字段（列）的字符。</td>
</tr>
<tr>
<td>DECIMALSEP</td>
<td>.</td>
<td>用作小数点分隔符的字符。</td>
</tr>
<tr>
<td>THOUSANDSSEP</td>
<td></td>
<td>用于分隔千位的字符。 默认为空字符串。</td>
</tr>
<tr>
<td>BOOLSTYlE</td>
<td>True,False</td>
<td>布尔值的字符串文字格式。</td>
</tr>
<tr>
<td>NUMPROCESSES</td>
<td></td>
<td>为 COPY 任务创建的子工作进程数。 COPY FROM 的最大值默认为 4，COPY TO 的最大值默认为 16。 但是，最多会创建 (num_cores - 1) 个进程。</td>
</tr>
<tr>
<td>MAXATTEMPTS</td>
<td>5</td>
<td>在放弃之前尝试获取一系列数据（使用 COPY TO 时）或插入一块数据（使用 COPY FROM 时）失败的最大次数。</td>
</tr>
<tr>
<td>REPORTFREQUENCY</td>
<td>0.25</td>
<td>状态更新的刷新频率（以秒为单位）。</td>
</tr>
<tr>
<td>RATEFILE</td>
<td></td>
<td>用于输出速率统计数据的可选文件。 默认情况下，统计信息不会输出到文件中。</td>
</tr>
</tbody>
</table>
<p>6.DESCRIBE
打印模式元素或集群的描述（通常是一系列 DDL 语句）。 使用 DESCRIBE 转储全部或部分架构。</p>
<div class="highlight"><pre><span></span><code>ESCRIBE CLUSTER
DESCRIBE SCHEMA
DESCRIBE KEYSPACES
DESCRIBE KEYSPACE &lt;keyspace name&gt;
DESCRIBE TABLES
DESCRIBE TABLE &lt;table name&gt;
DESCRIBE INDEX &lt;index name&gt;
DESCRIBE TYPES
DESCRIBE TYPE &lt;type name&gt;
</code></pre></div>
<p>在任何命令中，可以使用 DESC 代替 DESCRIBE。
DESCRIBE CLUSTER 命令打印集群名称：</p>
<div class="highlight"><pre><span></span><code>cqlsh&gt; DESCRIBE CLUSTER

Cluster: local cluster
</code></pre></div>
<p>DESCRIBE SCHEMA 命令打印重新创建整个架构所需的 DDL 语句。 使用此命令转储架构； 然后，您可以使用生成的文件克隆集群或从备份恢复。</p>
<p>7.EXIT
结束当前会话并终止 cqlsh 进程。</p>
<div class="highlight"><pre><span></span><code>EXIT
QUIT
</code></pre></div>
<p>8.EXPAND
启用或禁用行的垂直打印。 当获取很多列或者单个列的内容很大时，请使用 EXPAND。</p>
<div class="highlight"><pre><span></span><code>EXPAND ON
EXPAND OFF
</code></pre></div>
<p>要查看当前的扩展设置，请使用不带参数的 EXPAND</p>
<p>9.HELP 
提供有关 cqlsh 命令的信息。 要查看可用主题，请输入不带任何参数的 HELP。 要查看某个主题的帮助，请使用 HELP <topic>。 另请参阅 --browser 参数，用于控制使用哪个浏览器显示帮助。</p>
<div class="highlight"><pre><span></span><code>HELP &lt;topic&gt;
</code></pre></div>
<p>10.LOGIN
以当前会话的指定 AiSQL 用户身份进行身份验证</p>
<div class="highlight"><pre><span></span><code>LOGIN &lt;username&gt; [&lt;password&gt;]
</code></pre></div>
<p>11.PAGING 
启用分页、禁用分页或设置读取查询的页面大小。 启用分页后，一次仅获取一页数据，并会出现获取下一页的提示。 一般来说，最好在交互式会话中启用分页，以避免一次获取和打印大量数据。</p>
<div class="highlight"><pre><span></span><code>PAGING ON
PAGING OFF
PAGING &lt;page size in rows&gt;
</code></pre></div>
<p>要查看当前分页设置，请使用不带参数的 PAGING。</p>
<p>12.SHOW HOST 
打印 cqlsh 连接到的 DBServer 服务器的 IP 地址和端口以及集群名称。 例子：</p>
<div class="highlight"><pre><span></span><code>cqlsh&gt; SHOW HOST

Connected to local cluster at 127.0.0.1:9542.
</code></pre></div>
<p>13.SHOW VERSION
打印正在使用的 cqlsh、Cassandra、CQL 和本机协议版本。 例子：</p>
<div class="highlight"><pre><span></span><code>cqlsh&gt; SHOW VERSION

[cqlsh 5.0.1 | Cassandra 3.9-SNAPSHOT | CQL spec 3.4.2 | Native protocol v4]
</code></pre></div>
<p>14.SOURCE
读取文件的内容并将每一行作为 BCQL 语句或特殊 cqlsh 命令执行。</p>
<div class="highlight"><pre><span></span><code>SOURCE &#39;&lt;file&gt;&#39;
</code></pre></div>
<p>示例：</p>
<div class="highlight"><pre><span></span><code>cqlsh&gt; SOURCE &#39;/home/bigmath/commands.cql&#39;
</code></pre></div>
<p>15.TIMING
启用或禁用基本请求往返计时，在当前 BCQL shell 会话上测量。</p>
<div class="highlight"><pre><span></span><code>TIMING ON | OFF
</code></pre></div>
<p>TIMING ON：为所有进一步的请求启用往返定时。
TIMING OFF：禁用定时。
TIMING（无参数）：输出当前计时状态。</p>
<p>示例：
您可以使用 TIMING 并从 BCQL 会话运行查询，如下所示：</p>
<div class="highlight"><pre><span></span><code>cqlsh&gt; TIMING

Timing is currently disabled. Use TIMING ON to enable.
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh&gt; TIMING ON

Now Timing is enabled
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh&gt; use example;

26.18 milliseconds elapsed
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh:example&gt; CREATE TABLE employees(department_id INT, employee_id INT,name TEXT, PRIMARY KEY(department_id, employee_id));

1042.67 milliseconds elapsed
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh:example&gt; INSERT INTO employees(department_id, employee_id, name) VALUES (1, 1, &#39;John&#39;);

16.89 milliseconds elapsed
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh:example&gt; INSERT INTO employees(department_id, employee_id, name) VALUES (1, 2, &#39;Jane&#39;);

11.65 milliseconds elapsed
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh:example&gt; SELECT * FROM employees;

 department_id | employee_id | name
---------------+-------------+------
             1 |           1 | John
             1 |           2 | Jane
5.76 milliseconds elapsed
(2 rows)
</code></pre></div>
<div class="highlight"><pre><span></span><code>cqlsh:example&gt; TIMING OFF

Disabled Timing.
</code></pre></div>
<h3 id="bm-admin"><strong>bm-admin</strong></h3>
<p>实用管理程序位于AiSQL home的bin目录中，为管理集群提供了一个命令行接口。它调用bm-mserver和bm-dbserver服务来执行必要的管理。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    [ -mserver_addresses &lt;mserver-addresses&gt; ]  \
    [ -timeout_ms &lt;millisec&gt; ] \
    [ -certs_dir_name &lt;dir_name&gt; ] \
    &lt;command&gt; [ command_flags ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
timeout_ms：RPC超时，以毫秒为单位。默认值为60000。值为0表示不要等待，-1表示无限期等待。
certs_dir_name：包含用于安全服务器连接的证书的目录。默认值为“”。要连接到启用TLS的群集，必须在根证书所在的目录位置中包含-certs_dir_name标志。
command：要执行的操作。有关语法详细信息和示例，请参阅下述的<a href="#_Commands">命令</a>相关章节。
command_flags：可以应用于命令的配置标志。</p>
<h4 id="_23"><strong>集群命令</strong></h4>
<h5 id="get_universe_config"><strong>get_universe_config</strong></h5>
<p>获取集群的配置信息。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;mserver-addresses&gt; \
    get_universe_config
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin  -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 get_universe_config
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>{&quot;version&quot;:2,&quot;replicationInfo&quot;:{&quot;liveReplicas&quot;:{&quot;numReplicas&quot;:3,&quot;placementBlocks&quot;:[{&quot;cloudInfo&quot;:{&quot;placementCloud&quot;:&quot;cloud1&quot;,&quot;placementRegion&quot;:&quot;datacenter1&quot;,&quot;placementZone&quot;:&quot;rack1&quot;},&quot;minNumReplicas&quot;:1}]}},&quot;clusterUuid&quot;:&quot;749de444-7fb8-4d25-be53-e7de3ec38b5e&quot;}
</code></pre></div>
<h5 id="change_config"><strong>change_config</strong></h5>
<p>更改分片配置。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    change_config &lt;tablet_id&gt; \
    [ ADD_SERVER | REMOVE_SERVER ] \
    &lt;peer_uuid&gt; \
    [ PRE_VOTER | PRE_OBSERVER ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
tablet_id：分片标识符（id）。
ADD_SERVER|REMOVE_SERVER：增加或删除服务的子命令。
peer_uid：承载每一个分片的分片服务器dbserver的uuid。
PRE_VOTER|PRE_OBSERVER：加入仲裁的新同等地位的角色。使用ADD_SERVER子命令时需要。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 
change_config 5d02e371c8d74e459cf27c404dbc7627 
REMOVE_SERVER 3b56c099059347f38bb48dedb4c4c44e
</code></pre></div>
<p>注意：
如果您需要暂时关闭一个节点，但又想重新启动它，则不需要使用REMOVE_SERVER子命令。</p>
<ul>
<li>如果节点关闭的时间少于15分钟，那么当它重新联机时，它将通过RPC调用进行追赶。</li>
<li>如果节点离线时间超过15分钟，则它将通过远程引导，当前领导者将转发所有相关文件来赶上。</li>
</ul>
<p>如果您不打算恢复某个节点（可能是为了维护而将其关闭，但发现磁盘坏了），则需要解除该节点的任务（使用REMOVE_SERVER子命令），然后增加一个新节点（使用ADD_SERVER子命令）。</p>
<h5 id="change_mserver_config"><strong>change_mserver_config</strong></h5>
<p>改变mserver的配置。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    change_mserver_config \
    [ ADD_SERVER|REMOVE_SERVER ] \
    &lt;ip_addr&gt; &lt;port&gt; \
    [&lt;uuid&gt;]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>ADD_SERVER | REMOVE_SERVER: 增加或删除mserver服务的子命令。</p>
<p>增加或删除节点后，在mserver UI页面上验证mserver服务器的状态(http://node-ip:10000)或者运行bm-admin dump_mservers_state命令。</p>
<p>ip_addr: 服务节点的IP地址
port: 服务节点的端口
uuid: 增加或者删除的服务的UUID</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 
change_mserver_config ADD_SERVER 10.0.0.4:11000 
</code></pre></div>
<h5 id="list_tablet_servers"><strong>list_tablet_servers</strong></h5>
<p>列出指定分片所在的分片服务器信息。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code> ./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_tablet_servers &lt;tablet_id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
tablet_id：分片标志符（id）</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000
list_tablet_servers 1cccc061ca2549af99b8d3b31301ecde
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Server UUID                           RPC Host/Port       Role
2292778daffa4dca91f74555ec59525a        10.0.0.1:21000     LEADER
afbd4a615b374153bcb9f17a12caca61        10.0.0.2:21000     FOLLOWER
f83579d710d54598951707675d86ced1       10.0.0.3:21000     FOLLOWER
</code></pre></div>
<h5 id="list_tablets"><strong>list_tablets</strong></h5>
<p>列出表的相关分片信息。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_tablets &lt;keyspace_type&gt;.&lt;keyspace_name&gt; &lt;table&gt; [max_tablets]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
keyspace_type：keyspace类型，bsql 或者 bcql。
keyspace_name：命名空间，或者数据库名，或者keyspace名
table：表名。
max_tablets: 返回最大的分片数量。缺省值为10。设置为0，代表返回所有的分片。 </p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000
list_tablets bsql.biginsights t_test 0
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Tablet-UUID                     Range             Leader-IP               Leader-UUID
1adf622d660c49e4964780eefb823bbd   partition_key_start: &quot;&quot; partition_key_end: &quot;UU&quot;                 10.0.0.1:21000     f83579d710d54598951707675d86ced1

94825af55a084f65abf80539db9b6010   partition_key_start: &quot;UU&quot; partition_key_end: &quot;\252\252&quot;         10.0.0.2:21000     afbd4a615b374153bcb9f17a12caca61

12bd887821684825b816e163690129e9  partition_key_start: &quot;\252\252&quot; partition_key_end: &quot;&quot;           10.0.0.3:21000     2292778daffa4dca91f74555ec59525a
</code></pre></div>
<h5 id="list_all_tablet_servers"><strong>list_all_tablet_servers</strong></h5>
<p>列出所有的分片服务器。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_all_tablet_servers
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_all_tablet_servers
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Tablet Server UUID                 RPC Host/Port Heartbeat delay Status   Reads/s  Writes/s Uptime   SST total size  SST uncomp size SST #files      Memory   Broadcast Host/Port 

afbd4a615b374153bcb9f17a12caca61   10.0.0.1:21000         0.28s   ALIVE    0.40     0.00     5714     3.77 MB         6.03 MB         45              93.13 MB N/A

f83579d710d54598951707675d86ced1 10.0.0.2:21000           0.96s     ALIVE    0.40     0.00     24764    2.75 MB         4.39 MB         33              83.84 MB N/A

2292778daffa4dca91f74555ec59525a 10.0.0.3:21000            0.29s      ALIVE    0.20     0.20     2222     3.04 MB         4.83 MB         37              68.52 MB N/A
</code></pre></div>
<h5 id="list_all_mservers"><strong>list_all_mservers</strong></h5>
<p>列出所有的mserver的UUID、RPC主机和端口、状态（ALIVE或DEAD）和角色（LEADER、FOLLOWER或UNKNOWN_role）的信息。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_all_mservers
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_all_mservers
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>mserver UUID                       RPC Host/Port   State     Role     Broadcast Host/Port 
5712445eec394ad7a5e1bb7a207c5d32   10.0.0.1:11000    ALIVE   LEADER          N/A                 
3a2a586e213840e7b29a2651ae704fa5   10.0.0.2:11000    ALIVE   FOLLOWER        N/A                 
3f24393f534645bf9675da7a592e21a2   10.0.0.3:11000    ALIVE   FOLLOWER        N/A 
</code></pre></div>
<h5 id="list_replica_type_counts"><strong>list_replica_type_counts</strong></h5>
<p>列出指定表的副本类型和数量。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_replica_type_counts &lt;keyspace_type&gt;.&lt;keyspace_name&gt; &lt;table_name&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
keyspace_type：keyspace类型，bsql 或者 bcql。
keyspace_name：命名空间，或者数据库名，或者keyspace名
table_name：表名</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000  list_replica_type_counts bsql.biginsights t_test
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>dbserver ID                           Placement ID     Live count     Read only count
2292778daffa4dca91f74555ec59525a             3             0
afbd4a615b374153bcb9f17a12caca61             3             0
f83579d710d54598951707675d86ced1            3             0
</code></pre></div>
<h5 id="dump_mservers_state"><strong>dump_mservers_state</strong></h5>
<p>转储mserver服务器的状态。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    dump_mservers_state
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000  dump_mservers_state
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>mserver state dump has been completed and saved into the mserver respective log files.
</code></pre></div>
<h5 id="list_tablet_server_log_locations"><strong>list_tablet_server_log_locations</strong></h5>
<p>列出分片服务器的日志位置。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_tablet_server_log_locations
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_tablet_server_log_locations
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>TS UUID                           RPC Host/Port   LogLocation
68c51c43d6c54c739da9b81c285ac093    10.0.0.1:21000   /$Home/disk2/bm-data/dbserver/logs
659d4bc33edf412483f803dda392c400    10.0.0.2:21000   /$Home/disk2/bm-data/dbserver/logs
cb985ff4636d483887b165ba0bb0479f    10.0.0.3:21000   /$Home/disk2/bm-data/dbserver/logs
</code></pre></div>
<h5 id="list_tablets_for_tablet_server"><strong>list_tablets_for_tablet_server</strong></h5>
<p>列出指定分片服务器的所有分片信息。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_tablets_for_tablet_server &lt;ts_uuid&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
ts_uuid: 分片服务器的UUID（dbserver）</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_tablets_for_tablet_server 659d4bc33edf412483f803dda392c400
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Table name  Tablet ID                            Is Leader   State        Num SST Files   Num Log Segments        Num Memtables (Intents/Regular)

Test       362c75c27357459ca7bf16ab5896a357        0       RUNNING   0      
2       1/1
</code></pre></div>
<h5 id="split_tablet"><strong>split_tablet</strong></h5>
<p>分隔指定的哈希分片，并计算分片范围的中间值做为分隔点。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    split_tablet -mserver_addresses &lt;mserver-addresses&gt; &lt;tablet_id_to_split&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
tablet_id_to_split：要分隔的分片ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 split_tablet 9991368c4b85456988303cd65a3c6503
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Tablet UUID                               Range                       Leader
20998f68c3fa4d299e8af7c04410e230   key_start: &quot;&quot; key_end: &quot;\177\377&quot;      10.0.0.1:21000
a89ecb84ad1b488b893b6e7762a6ca2a  key_start: &quot;\177\377&quot; key_end: &quot;&quot;      10.0.0.3:21000
</code></pre></div>
<h5 id="mserver_leader_stepdown"><strong>mserver_leader_stepdown</strong></h5>
<p>强制Leader让位于指定的mserver节点。</p>
<p>注意：执行此命令存在停机的可能性，请谨慎使用。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt;
mserver_leader_stepdown [ &lt;new_leader_id&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
new_leader_id：（可选）新mserver Leader的标识符（UUID）。如果未指定，则会自动选择新Leader。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000  mserver_leader_stepdown 
</code></pre></div>
<h5 id="bsql_catalog_version"><strong>bsql_catalog_version</strong></h5>
<p>打印当前BSQL架构目录版本。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    bsql_catalog_version
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 bsql_catalog_version
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Version: 0
</code></pre></div>
<h4 id="_24"><strong>表命令</strong></h4>
<h5 id="list_tables"><strong>list_tables</strong></h5>
<p>打印所有表的列表。（可选）包括数据库类型、表ID和表类型。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_tables \
    [ include_db_type ] [ include_table_id ] [ include_table_type ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
include_db_type：（可选）添加此标志以包括每个表的数据库类型。 
include_table_id：（可选）添加此标志以包括每个表的表id。 
include_table_type：（可选）添加此标志以包括每个表的表类型。 
根据使用的标志，返回以下格式的表：
＜数据库类型＞&lt;命名空间&gt;&lt;表名称&gt;表id表类型
db_type：数据库的类型。有效值包括bsql、bcql、bedis和unknown。
namespace：数据库的名称（对于BSQL）或命名空间（对于BCQL）。
table_name：表的名称。
table_type：表的类型。有效值包括catalog, table, index和 other.。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000  list_tables
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>...
system_schema.functions
template0.pg_statistic
system.local
...
</code></pre></div>
<h5 id="compact_table"><strong>compact_table</strong></h5>
<p>触发表上的手动压缩。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    compact_table &lt;keyspace&gt; &lt;table_name&gt; \
    [timeout_in_seconds] [ADD_INDEXES]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
keyspace：指定数据库bsql.db-name或键空间bcql.keyspace-name。
table_name：指定表名。
timeout_in_seconds：指定bm-admin等待压缩结束的持续时间（以秒为单位）。默认值为20。
ADD_INDEXES：是否压缩与表关联的索引。默认值为false。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 compact_table bsql.biginsights t
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Compacted [biginsights.t] tables.
</code></pre></div>
<h5 id="compact_table_by_id"><strong>compact_table_by_id</strong></h5>
<p>触发表上的手动压缩。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    compact_table_by_id &lt;table_id&gt; \
    [timeout_in_seconds] [ADD_INDEXES]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
table_id：指定表ID。
timeout_in_seconds：指定bm-admin等待压缩结束的持续时间（以秒为单位）。默认值为20。
ADD_INDEXES：是否压缩与表关联的索引。默认值为false。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 compact_table_by_id 000033e8000030008000000000004105
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Compacted [000033e8000030008000000000004105] tables.
</code></pre></div>
<h5 id="modify_table_placement_info"><strong>modify_table_placement_info</strong></h5>
<p>修改表的放置信息（cloud, region, 和zone）</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    modify_table_placement_info &lt;keyspace&gt; &lt;table_name&gt; &lt;placement_info&gt; &lt;replication_factor&gt; \
    [ &lt;placement_id&gt; ]
</code></pre></div>
<p>或者</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    modify_table_placement_info tableid.&lt;table_id&gt; &lt;placement_info&gt; &lt;replication_factor&gt; \
    [ &lt;placement_id&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
table_name：表名
table_id：与要更改其放置策略的表关联的唯一UUID。
placement_info： 逗号分隔的cloud.region.zone列表，默认值为cloud1.datacenter1.rack1.
replication_factor： 副本因子
placement_id：（可选）主集群的标识符。如果设置了，它必须与集群配置中为主集群指定的placement_id相匹配。</p>
<p>注意：
对于启用了读取副本或引导关联策略的集群，不支持设置表的位置。
使用此命令仅可以为BCQL表或事务状态表创建自定义放置策略。对于BSQL表，请改用表空间（Tablespaces） 。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 modify_table_placement_info testdatabase testtable aws.us-west.us-west-2a,aws.us-west.us-west-2b,aws.us-west.us-west-2c 3
</code></pre></div>
<h5 id="create_transaction_table"><strong>create_transaction_table</strong></h5>
<p>创建要在区域中使用的事务状态表。此命令后面应始终跟有modify_table_placement_info，以设置新创建的事务状态表的放置信息。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    create_transaction_table \    
&lt;table_name&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
table_name：要创建的事务状态表名，必须以transactions_开头命名，事务状态表将被以system.<table_name>创建。</p>
<p>注意：
使用BSQL创建事务状态表的首选方法是创建一个具有适当位置的表空间。当您使用新表空间创建第一个表时，AiSQL会使用表空间的位置自动创建事务表。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 create_transaction_table transactions_us_east
</code></pre></div>
<p>接下来，在新创建的事务表上设置位置：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000    modify_table_placement_info system transactions_us_east aws.us-east.us-east-1a,aws.us-east.us-east-1b,aws.us-east.us-east-1c 3
</code></pre></div>
<p>负载平衡器运行后，system.transactions_us_est的所有分片现在都应该只位于aws.us-east。</p>
<h5 id="add_transaction_tablet"><strong>add_transaction_tablet</strong></h5>
<p>增加一个分片到事务状态表中。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    add_transaction_tablet \
    &lt;table_id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
table_id：表的标识符UUID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 add_transaction_tablet 000033eb000030008000000000004002
</code></pre></div>
<h4 id="_25"><strong>备份与快照命令</strong></h4>
<h5 id="create_database_snapshot"><strong>create_database_snapshot</strong></h5>
<p>创建指定BSQL数据库的快照，当运行此命令时，将产生并打印一个快照id：snapshot_id。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    create_database_snapshot &lt;database_name&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
database_name：BSQL数据库名。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses  10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000  create_database_snapshot biginsights
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Started snapshot creation: 7c5716ad-3daf-4eb1-b918-c0afd2e811d5
</code></pre></div>
<h5 id="create_keyspace_snapshot"><strong>create_keyspace_snapshot</strong></h5>
<p>创建指定BCQL Keyspace的快照，当运行此命令时，将产生并打印一个快照id：snapshot_id。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
create_keyspace_snapshot &lt;keyspace_name&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
keyspace_name：BCQL keyspace名。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 create_keyspace_snapshot bcql.my_space
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Started snapshot creation: 67bb96e2-6d20-4d18-ba84-29a6cedd484a
</code></pre></div>
<h5 id="list_snapshots"><strong>list_snapshots</strong></h5>
<p>打印所有快照ID、恢复ID和状态的列表。可选项，以JSON格式打印详细信息（包括键空间、表和索引）。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
  -mserver_addresses &lt;mserver-addresses&gt; \
    list_snapshots \
[ show_details ] [ not_show_restored ] [ show_deleted ] [JSON]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
show_details：（可选）打印快照细节，包括键空间、表和索引
not_show_restored：（可选）不显示成功的“恢复”（即“完成”）。用于查看仅未完成或失败的还原操作的列表。
show_deleted：（可选）显示被删除，但仍然保存在内存中的快照。
JSON：（可选）已JSON格式打印输出的信息。</p>
<p>对于创建和恢复快照的state的值可能有如下：
create_snapshot: CREATING, COMPLETE, DELETING, DELETED, 或者FAILED.
restore_snapshot: COMPLETE, DELETING, DELETED, 或者 FAILED.</p>
<p>默认情况下，此命令将打印如下操作的当前值：
create_snapshot: snapshot_id, keyspace, table, state
restore_snapshot: snapshot_id, restoration_id, state.
delete_snapshot: snapshot_id, state.</p>
<p>当使用show_details 时，此命令将以JSON格式打印如下详细信息：</p>
<div class="highlight"><pre><span></span><code>type: NAMESPACE
        id: &lt;snapshot_id&gt; or &lt;restoration_id&gt;
        data:
            name: &quot;&lt;namespace_name&gt;&quot;
            database_type: &quot;BQL_DATABASE_PGSQL&quot;
            colocated: true or false
            state: &quot;&lt;state&gt;&quot;
    type: TABLE &lt;== Use for table or index
        id: &quot;&lt;table_id&gt;&quot; or &quot;&lt;index_id&gt;&quot;
        data:
            name: &quot;&lt;table_name&gt;&quot; or &quot;&lt;index_id&gt;&quot;
            version: &quot;&lt;table_version&gt;&quot;
            state: &quot;&lt;state&gt;&quot;
            state_msg: &quot;&lt;state_msg&gt;&quot;
            next_column_id: &quot;&lt;column_id&gt;&quot;
            table_type: &quot;PGSQL_TABLE_TYPE&quot;
            namespace_id: &quot;&lt;namespace_id&gt;&quot;
            indexed_table_id (index only): &lt;table_id&gt;
            is_local_index (index only): true or false
            is_unique_index (index only): true or false
</code></pre></div>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_snapshots show_details 
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Snapshot UUID                           State           Creation Time
5b51ccfb-acbe-42cb-be2f-a71d640dfa52    COMPLETE        2023-06-14 14:56:43.967306
        {&quot;type&quot;:&quot;NAMESPACE&quot;,&quot;id&quot;:&quot;066ec5ed9d8f4f1bb16b8630846301f5&quot;,&quot;data&quot;:{&quot;name&quot;:&quot;ydb&quot;,&quot;database_type&quot;:&quot;BQL_DATABASE_CQL&quot;,&quot;colocated&quot;:false,&quot;state&quot;:&quot;RUNNING&quot;}}
        {&quot;type&quot;:&quot;TABLE&quot;,&quot;id&quot;:&quot;cdbb40823d4f4673a0842e755b907e58&quot;,&quot;data&quot;:{&quot;name&quot;:&quot;test_tb&quot;,&quot;version&quot;:0,&quot;state&quot;:&quot;RUNNING&quot;,&quot;next_column_id&quot;:3,&quot;table_type&quot;:&quot;BQL_TABLE_TYPE&quot;,&quot;namespace_id&quot;:&quot;066ec5ed9d8f4f1bb16b8630846301f5&quot;,&quot;namespace_name&quot;:&quot;ydb&quot;}}
</code></pre></div>
<h5 id="create_snapshot"><strong>create_snapshot</strong></h5>
<p>创建指定BCQL表及其索引的快照。在v.2.1.8之前，索引不会自动包含在内。您可以指定多个表，甚至可以从不同的键空间指定。</p>
<p>注意：
快照不会自动过期
通过create_snapshot创建的快照将一直保留在磁盘上，直到您使用delete_snaphot命令删除它们为止。
使用create_snapshot_schedule命令可以创建在指定时间间隔后过期的快照。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    create_snapshot &lt;keyspace&gt; &lt;table_name&gt; | &lt;table_id&gt; \
    [&lt;keyspace&gt; &lt;table_name&gt; | &lt;table_id&gt; ]... \
    [flush_timeout_in_seconds]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
keyspace：数据库或者键空间名，格式为：<bcql|bsql|bedis>..
table_name：表名
table_id：表标志ID
flush_timeout_in_seconds：指定刷新快照之前的持续时间（以秒为单位）。默认值为60。若要跳过刷新，请将该值设置为0。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 create_snapshot ydb test_tb
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Flushed [ydb.test_tb] tables and associated indexes.
Started snapshot creation: 5b51ccfb-acbe-42cb-be2f-a71d640dfa52
</code></pre></div>
<h5 id="restore_snapshot"><strong>restore_snapshot</strong></h5>
<p>恢复指定的快照，包括表和索引。当操作开始时，会生成一个restoration_id。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    restore_snapshot &lt;snapshot_id&gt; &lt;restore-target&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
snapshot_id：快照的标识符（id）。
restore target：恢复快照的时间。这可以是绝对Unix时间，也可以是相对时间，例如minus 5m（恢复到5分钟前）。可选项，忽略恢复到给定快照的创建时间。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 restore_snapshot 5b51ccfb-acbe-42cb-be2f-a71d640dfa52
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Started restoring snapshot: 5b51ccfb-acbe-42cb-be2f-a71d640dfa52
Restoration id: d21a9eea-baad-4797-a722-d7ac4bad705a
</code></pre></div>
<p>之后，执行./bm-admin list_snapshots命令，可以看到如下信息：</p>
<div class="highlight"><pre><span></span><code>Restoration UUID                        State
d21a9eea-baad-4797-a722-d7ac4bad705a    RESTORED
</code></pre></div>
<h5 id="export_snapshot"><strong>export_snapshot</strong></h5>
<p>导出指定的快照生成元数据文件，列出各种对象（表、分片等）的所有相关内部UUID。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    export_snapshot &lt;snapshot_id&gt; &lt;file_name&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
snapshot_id：快照的标识符（id）。
file_name：要包含元数据的文件的名称，建议的文件扩展名为.snapshot。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 export_snapshot e33e7703-7921-4aa1-bbe7-2fb119289854 ydb.snapshot
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Exporting snapshot e33e7703-7921-4aa1-bbe7-2fb119289854 (COMPLETE) to file ydb.snapshot
Snapshot metadata was saved into file: ydb.snapshot
</code></pre></div>
<h5 id="import_snapshot"><strong>import_snapshot</strong></h5>
<p>导入指定快照生成的元数据文件。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    import_snapshot &lt;file_name&gt; \
    [&lt;keyspace&gt; &lt;table_name&gt; [&lt;keyspace&gt; &lt;table_name&gt;]...]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
file_name：要导入的快照文件的名称。
keyspace：数据库或者键空间名，格式为：<bcql|bsql|bedis>..
table_name：表名</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 import_snapshot  ydb.snapshot
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Read snapshot meta file ydb.snapshot
Importing snapshot e33e7703-7921-4aa1-bbe7-2fb119289854 (COMPLETE)
Target imported BCQL keyspace name: ydb
BCQL keyspace being imported: ydb
Table type: table
Table being imported: ydb.test_tb
Successfully applied snapshot.
Object                 Old ID                                 New ID                          
Keyspace      066ec5ed9d8f4f1bb16b8630846301f5      066ec5ed9d8f4f1bb16b8630846301f5
Table         cdbb40823d4f4673a0842e755b907e58      cdbb40823d4f4673a0842e755b907e58
Tablet 0       88c308cd0a1648ac88d312270b60d977      88c308cd0a1648ac88d312270b60d977
Tablet 1       f88c2269a2684a4a91028ccde91b4276       f88c2269a2684a4a91028ccde91b4276
Tablet 2       ff5086fd3c5b430da23e135cf28d17fb        ff5086fd3c5b430da23e135cf28d17fb
Snapshot      e33e7703-7921-4aa1-bbe7-2fb119289854    dfe43cd7-7656-4c81-b5b1-5e9abf34fe98
</code></pre></div>
<p>注意：
键空间和表可以与导出的不同。</p>
<h5 id="delete_snapshot"><strong>delete_snapshot</strong></h5>
<p>删除指定的快照。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    delete_snapshot &lt;snapshot_id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
snapshot_id：快照的标识符（id）。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 delete_snapshot 5b51ccfb-acbe-42cb-be2f-a71d640dfa52
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Deleted snapshot: 5b51ccfb-acbe-42cb-be2f-a71d640dfa52
</code></pre></div>
<h5 id="create_snapshot_schedule"><strong>create_snapshot_schedule</strong></h5>
<p>创建快照计划。快照计划包括要包含在快照中的对象列表、产生快照的时间间隔以及保留时间。</p>
<p>返回JSON格式的计划ID。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin create_snapshot_schedule \
    -mserver_addresses &lt;mserver-addresses&gt; \
    &lt;snapshot-interval&gt;\
    &lt;retention-time&gt;\
    &lt;filter-expression&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
snapshot-interval：产生快照的频率，以分钟为单位
retention-time：在删除快照之前保留快照的分钟数。
filter-expression：要包含在快照中的对象集，是可接受对象的列表，这些对象可以是原始表，也可以是键空间（BCQL）或数据库（BSQL）。为了保证适当的一致性，建议在每个键空间（BCQL）或每个数据库（BSQL）级别上进行设置。</p>
<p>例如：
每分钟产生一次数据库的快照，并将每个快照保留10分钟： </p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 create_snapshot_schedule 1 10 bsql.test
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>{
    &quot;schedule_id&quot;: &quot;a9914c9e-8a75-455c-8ea1-60b7ad5a2849&quot;
}
</code></pre></div>
<h5 id="list_snapshot_schedules"><strong>list_snapshot_schedules</strong></h5>
<p>列出与给定计划关联的快照列表；或者列出所有相关快照的计划列表。</p>
<p>计划列表包含：</p>
<p>1) 计划ID
2) 计划选项（间隔和保留时间）
3) 系统自动产生的快照列表</p>
<p>快照列表包括：</p>
<p>1) 快照的唯一ID
2) 快照的创建时间
3) 上一个快照的创建时间（如果可用）。利用这段时间来确保在恢复时选择了正确的快照，这保证了快照中包含要恢复的数据。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_snapshot_schedules &lt;schedule-id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
schedule-id：快照计划的唯一标识符。ID是可选的；省略ID则返回系统中的所有计划。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_snapshot_schedules 
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>{
    &quot;schedules&quot;: [
        {
            &quot;id&quot;: &quot;a9914c9e-8a75-455c-8ea1-60b7ad5a2849&quot;,
            &quot;options&quot;: {
                &quot;filter&quot;: &quot;bsql.test&quot;,
                &quot;interval&quot;: &quot;1 min&quot;,
                &quot;retention&quot;: &quot;10 min&quot;
            },
            &quot;snapshots&quot;: [
                {
                    &quot;id&quot;: &quot;4baa82dc-a893-4a8f-9361-859080addac7&quot;,
                    &quot;snapshot_time&quot;: &quot;2023-06-15 14:01:15.618289&quot;,
                    &quot;previous_snapshot_time&quot;: &quot;2023-06-15 14:00:10.594836&quot;
                },
                {
                    &quot;id&quot;: &quot;ca8d9749-33fc-4df1-ba5b-829e43345747&quot;,
                    &quot;snapshot_time&quot;: &quot;2023-06-15 14:02:20.641016&quot;,
                    &quot;previous_snapshot_time&quot;: &quot;2023-06-15 14:01:15.618289&quot;
                },
                {
                    &quot;id&quot;: &quot;977cdf87-42b7-49c0-95d6-40c101efbcb0&quot;,
                    &quot;snapshot_time&quot;: &quot;2023-06-15 14:03:25.662123&quot;,
                    &quot;previous_snapshot_time&quot;: &quot;2023-06-15 14:02:20.641016&quot;
                }
            ]
        }
    ]
}
</code></pre></div>
<h5 id="restore_snapshot_schedule"><strong>restore_snapshot_schedule</strong></h5>
<p>将一系列项编组到一个单独的跟踪对象中。当需要恢复时，可以选择特定的计划，特定的时间点，并将所有受影响对象的状态恢复到选定的时间。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    restore_snapshot_schedule &lt;schedule-id&gt; &lt;restore-target&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
schedule-id：快照计划的唯一标识符。
restore target：在计划中恢复快照的时间。这可以是绝对的Unix时间戳，也可以是相对时间，例如minus 5m（恢复到5分钟前）。</p>
<p>如果愿意，还也可以将 BSQL 时间戳或者BCQL 时间戳与restore命令一起使用。除了恢复到特定的时间戳，您还可以从相对时间进行恢复，例如“ten minutes ago”。</p>
<p>指定相对时间时，可以指定任意或全部天、小时、分钟和秒。例如：
minus 5m ：从5分钟前恢复
minus 1h ：从1小时前恢复
minus 3d ：从3天前恢复
minus 1h 5m ：从1小时零5分钟前恢复 </p>
<p>相对时间可以采用以下任何格式（可以指定任何或全部天、小时、分钟和秒）：
ISO 8601: 3d 4h 5m 6s
缩写PostgreSQL: 3 d 4 hrs 5 mins 6 secs
传统PostgreSQL: 3 days 4 hours 5 minutes 6 seconds
SQL 标准: D H:M:S</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 restore_snapshot_schedule  a9914c9e-8a75-455c-8ea1-60b7ad5a2849 minus 60s
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>{
    &quot;snapshot_id&quot;: &quot;d46e59e1-83d8-41f8-86f2-ea3db364b6ee&quot;,
    &quot;restoration_id&quot;: &quot;1bc5feb9-8f5d-4bc7-8823-37b96fd6716e&quot;
}
</code></pre></div>
<h5 id="delete_snapshot_schedule"><strong>delete_snapshot_schedule</strong></h5>
<p>删除具有给定ID的快照计划以及与该计划关联的所有快照。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    delete_snapshot_schedule &lt;schedule-id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
schedule-id：快照计划的唯一标识符。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 delete_snapshot_schedule a9914c9e-8a75-455c-8ea1-60b7ad5a2849 
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>{
    &quot;schedule_id&quot;: &quot;a9914c9e-8a75-455c-8ea1-60b7ad5a2849&quot;
}
</code></pre></div>
<h4 id="_26"><strong>多区，多地域部署命令</strong></h4>
<h5 id="modify_placement_info"><strong>modify_placement_info</strong></h5>
<p>修改部署的放置信息（cloud、region和zone）。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    modify_placement_info &lt;placement_info&gt; &lt;replication_factor&gt; \
    [ &lt;placement_id&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
placement_info：cloud.region.zone的逗点分隔的放置列表。做为可选项，在每个放置块之后，我们还可以指定用冒号分隔的最小副本计数。此计数表示我们希望在该放置块中每个分片的最小副本数量。其默认值为1。不建议多次重复相同的放置，而是在冒号后指定总计数。但是，如果用户多次指定一个位置，则会获取所有提及的总数。
replication_factor：每个分片的副本数。此值应大于或等于placement_info中指定的副本计数的总和。
placement_id：主集群的标识符，可以是任何唯一的字符串。做为可选项，如果未设置，将使用随机生成的ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 modify_placement_info cloud1.datacenter1.rack1 2 
</code></pre></div>
<h5 id="set_preferred_zones"><strong>set_preferred_zones</strong></h5>
<p>设置首选可用性区域（AZ）和地域。按照偏好的顺序，分片的Leader被放置在活跃和健康的节点的AZ下。当在最优选的AZ中没有可用的健康节点时（优选值1），则从下一个优选的AZs中挑选活动的和健康的节点。没有偏好的AZs同样有资格担任分片Leader。
让所有分片Leader都位于一个区域，可以减少数据库写入事务的网络跳数，从而提高性能并减少延迟。
注意以下几点：
1）请确保您事先已经运行了modify_placement_info命令。
2）默认情况下，交易状态分片Leader不关注这些首选区域，而是在所有节点之间保持平衡。事务包括从用户到为事务提供服务的事务分片的往返—使用离用户最近的Leader，而不是强制往返于首选区域，可以提高性能。
3）无论其偏好如何，被列入黑名单的节点不会担任Leader角色。
4）集群配置将首选区域存储在affinitized_leaders 或者 multi_affinitized_leaders对象中。
5）表空间不会继承集群级别的放置信息、Leader首选项或读副本配置。
6）如果客户端应用程序使用智能驱动程序，请将拓扑密钥设置为针对首选区域。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    set_preferred_zones &lt;cloud.region.zone&gt;[:preference] \
    [&lt;cloud.region.zone&gt;[:preference]]...
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
cloud.region.zone：指定 cloud，region，和zone，默认值为cloud1.datacenter1.rack1
preference：指定分区的Leader首选项。值必须是连续的非零整数。多个分区可以具有相同的值。默认值为1。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>/bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 set_preferred_zones cloud1.datacenter1.rack1:1 cloud1.datacenter1.rack2:1 cloud1.datacenter2.rack3:2
</code></pre></div>
<h4 id="_27"><strong>读副本部署命令</strong></h4>
<h5 id="add_read_replica_placement_info"><strong>add_read_replica_placement_info</strong></h5>
<p>将读副本添加到mserver配置中。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    add_read_replica_placement_info &lt;placement_info&gt; \
    &lt;replication_factor&gt; \
    [ &lt;placement_id&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
placement_info：cloud.region.zone的逗点分隔的放置列表。默认值为cloud1.datacenter1.rack1
replication_factor：副本因子
placement_id：读副本集群的标识符，可以是任何唯一的字符串。如果未设置，将使用随机生成的ID。主集群和读副本集群必须使用不同的放置ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 add_read_replica_placement_info c1.r1.z1_rr:1 3 rr
</code></pre></div>
<h5 id="modify_read_replica_placement_info"><strong>modify_read_replica_placement_info</strong></h5>
<p>修改读副本的mserver配置。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    modify_read_replica_placement_info &lt;placement_info&gt; \
    &lt;replication_factor&gt; \
    [ &lt;placement_id&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
placement_info：cloud.region.zone的逗点分隔的放置列表。默认值为cloud1.datacenter1.rack1
replication_factor：副本因子
placement_id：读副本集群的标识符，可以是任何唯一的字符串。如果未设置，将使用随机生成的ID。主集群和读副本集群必须使用不同的放置ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 modify_read_replica_placement_info c1.r1.z1_rr:1 3 rr
</code></pre></div>
<h5 id="delete_read_replica_placement_info"><strong>delete_read_replica_placement_info</strong></h5>
<p>删除读副本</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    delete_read_replica_placement_info [ &lt;placement_id&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
placement_id：读副本集群的标识符，可以是任何唯一的字符串。如果未设置，将使用随机生成的ID。主集群和读副本集群必须使用不同的放置ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 delete_read_replica_placement_info rr
</code></pre></div>
<h4 id="_28"><strong>安全命令</strong></h4>
<p>静态加密命令，有关在静态加密的详细信息，请参阅<a href="#_静态加密">静态加密</a>。</p>
<h5 id="add_universe_key_to_all_mservers"><strong>add_universe_key_to_all_mservers</strong></h5>
<p>在每个mserver节点的内存中设置key_path的内容。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    add_universe_key_to_all_mservers &lt;key_id&gt; &lt;key_path&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
key_id：唯一标识符（可以是任何字符串，例如UUID的字符串），它将以byte[]的形式与key_path内容中包含的密钥相关联。
key_path：包含密钥文件的路径。</p>
<p>请注意：
将密钥添加到所有mserver节点后，可以使用bm-admin all_mservers_have_universe_key_in_memory命令验证密钥是否存在，并使用rotate_universe_key_in_memory命令启用加密。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 add_universe_key_to_all_mservers  test_key_id  /cluster_key
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Successfully added key to the node 10.0.0.1:11000.
Successfully added key to the node 10.0.0.2:11000.
Successfully added key to the node 10.0.0.3:11000.
</code></pre></div>
<h5 id="all_mservers_have_universe_key_in_memory"><strong>all_mservers_have_universe_key_in_memory</strong></h5>
<p>检查与所提供的key_id相关联的密钥是否存在于每个mserver主节点上的存储器中。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    all_mservers_have_universe_key_in_memory &lt;key_id&gt; 
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
key_id：唯一标识符（可以是任何字符串，例如UUID的字符串），它将以byte[]的形式与key_path内容中包含的密钥相关联。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 all_mservers_have_universe_key_in_memory test_key_id 
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Node 10.0.0.1:11000 has universe key in memory: 1
Node 10.0.0.2:11000 has universe key in memory: 1
Node 10.0.0.3:11000 has universe key in memory: 1
</code></pre></div>
<h5 id="rotate_universe_key_in_memory"><strong>rotate_universe_key_in_memory</strong></h5>
<p>轮换内存中的密钥，以使用与所提供的key_id关联的密钥开始对于新写入的数据文件进行加密。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
 -mserver_addresses &lt;mserver-addresses&gt; rotate_universe_key_in_memory &lt;key_id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
key_id：唯一标识符（可以是任何字符串，例如UUID的字符串），它将以byte[]的形式与key_path内容中包含的密钥相关联。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 rotate_universe_key_in_memory test_key_id 
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Rotated universe key in memory
</code></pre></div>
<h5 id="disable_encryption_in_memory"><strong>disable_encryption_in_memory</strong></h5>
<p>对于新写入的数据文件禁，用处于静态加密。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    disable_encryption_in_memory
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 disable_encryption_in_memory
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Encryption disabled
</code></pre></div>
<h5 id="is_encryption_enabled"><strong>is_encryption_enabled</strong></h5>
<p>验证加密是否已启用</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
 -mserver_addresses &lt;mserver-addresses&gt;  is_encryption_enabled
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000  is_encryption_enabled
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Encryption status: ENABLED with key id test_key_id
</code></pre></div>
<h4 id="_29"><strong>更改数据捕获命令</strong></h4>
<h5 id="create_change_data_stream"><strong>create_change_data_stream</strong></h5>
<p>为指定的数据库创建更改数据捕获数据库流。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    create_change_data_stream bsql.&lt;namespace_name&gt; 
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
namespace_name：要在其上创建数据库流ID的命名空间。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 create_change_data_stream bsql.testdb 
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>CDC Stream ID: b5c79d74b77e49f3a7deb1f357034301
</code></pre></div>
<p>要创建一个变更数据捕获（CDC）数据库流，该流也支持发送记录的前镜像，请使用以下命令。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
     -mserver_addresses &lt;mserver-addresses&gt; \
      create_change_data_stream bsql.&lt;namespace_name&gt; IMPLICIT ALL
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
namespace_name：要在其上创建数据库流ID的命名空间。
IMPLICIT ：服务器上的检查点类型。
ALL ：记录类型，表明流也应该发送之前的镜像的服务器。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 create_change_data_stream bsql.testdb IMPLICIT ALL
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>CDC Stream ID: a5b61f9a095d49a28db16235c09638e6
</code></pre></div>
<h5 id="list_change_data_streams"><strong>list_change_data_streams</strong></h5>
<p>列出所有创建的变更数据捕获（CDC）数据库流。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_change_data_streams [namespace_name]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
namespace_name：可选项，要列出数据库流的名称空间名称，如果没有提供，它将列出所有数据库流。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 list_change_data_streams
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>CDC Streams: 
streams {
  stream_id: &quot;a5b61f9a095d49a28db16235c09638e6&quot;
  options {
    key: &quot;id_type&quot;
    value: &quot;NAMESPACEID&quot;
  }
  options {
    key: &quot;checkpoint_type&quot;
    value: &quot;IMPLICIT&quot;
  }
  options {
    key: &quot;source_type&quot;
    value: &quot;CDCSDK&quot;
  }
  options {
    key: &quot;record_format&quot;
    value: &quot;PROTO&quot;
  }
  options {
    key: &quot;record_type&quot;
    value: &quot;CHANGE&quot;
  }
  options {
    key: &quot;state&quot;
    value: &quot;ACTIVE&quot;
  }
}
</code></pre></div>
<h5 id="get_change_data_stream_info"><strong>get_change_data_stream_info</strong></h5>
<p>获取与特定变更数据捕获（CDC）数据库流相关联的信息。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
       get_change_data_stream_info &lt;db_stream_id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
db_stream_id：需要获取信息的变更数据捕获（CDC）数据库流ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 get_change_data_stream_info a5b61f9a095d49a28db16235c09638e6
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>CDC DB Stream Info: 
namespace_id: &quot;00004003000030008000000000000000&quot;
</code></pre></div>
<h5 id="delete_change_data_stream"><strong>delete_change_data_stream</strong></h5>
<p>删除指定的变更数据捕获（CDC）数据库流。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
       delete_change_data_stream &lt;db_stream_id&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
db_stream_id：需要删除的变更数据捕获（CDC）数据库流ID。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 delete_change_data_stream a5b61f9a095d49a28db16235c09638e6
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Successfully deleted Change Data Stream ID: a5b61f9a095d49a28db16235c09638e6
</code></pre></div>
<h4 id="xdcr"><strong>xDCR复制命令</strong></h4>
<h5 id="setup_universe_replication"><strong>setup_universe_replication</strong></h5>
<p>为指定的源集群设置集群复制。只有在没有配置复制表的情况下，才能使用此命令。如果已经为复制配置了表，请使用alter_universe_replication来添加更多的表。
要验证是否已经为复制配置了表，请使用list_cdc_streams。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
 -mserver_addresses &lt;target_universe_mserver_addresses&gt; \
setup_universe_replication &lt;source_universe_uuid&gt;_&lt;replication_stream_name&gt;  \
    &lt;source_universe_mserver_addresses&gt; \
    &lt;table_id&gt;,[&lt;table_id&gt;..]
</code></pre></div>
<p>解释：
target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
source_universe_uid：源集群的uuid。
replication_name：复制的名称。
source_mserver_addresss：以逗号分隔的源mserver主机地址列表。
comma_separated_list_of_table_ids:源集群表标识符（table_id）的逗号分隔列表。
comma_separated_list_of_producer_bootstrap_ids：源集群引导程序标识符（bootstrap_id）的逗号分隔列表。使用bootstrap_cdc_producer来获取，并使用逗号分隔源集群的表ID。</p>
<p>重要提示：bootstrap_id需要与table_id的排序顺序必须保持一致。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses 10.0.0.4:11000,10.0.0.5:11000,10.0.0.6:11000 \
setup_universe_replication 4b0ec5da-3582-45b3-aa47-98d9425a5f5c  \
10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 \    000030a5000030008000000000004000,000030a5000030008000000000004005,dfef757c415c4b2cacc9315b8acb539a
</code></pre></div>
<h5 id="alter_universe_replication"><strong>alter_universe_replication</strong></h5>
<p>更改指定源集群的集群复制。使用此命令可以执行以下操作：</p>
<ul>
<li>在现有复制UUID中添加或删除表。</li>
<li>修改源主机地址。
  如果没有为复制配置表，请使用setup_universe_replication。
  要检查是否为复制配置了表，请使用list_cdc_streams。</li>
</ul>
<p>使用set_mserver_addresss子命令来替换源主机地址列表。如果源上的主机发生更改，请使用此选项：</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;target_mserver_addresses&gt; \
    alter_universe_replication &lt;source_universe_uuid&gt;_&lt;replication_name&gt; \
    set_mserver_addresses &lt;source_mserver_addresses&gt;
</code></pre></div>
<p>解释：
target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
source_universe_uid：源集群的uuid。
replication_name：要更改的复制的名称。
source_mserver_addresss：以逗号分隔的源mserver主机地址列表。</p>
<p>使用add_table子命令将一个或多个表添加到现有列表中：</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;target_mserver_addresses&gt; \
    alter_universe_replication &lt;source_universe_uuid&gt;_&lt;replication_name&gt; \
    add_table [ &lt;comma_separated_list_of_table_ids&gt; ] \
    [ &lt;comma_separated_list_of_producer_bootstrap_ids&gt; ]
</code></pre></div>
<p>解释：
target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。 
source_universe_uid：源集群的uuid。 
replication_name：要更改的复制的名称。 
comma_separated_list_of_table_ids:源集群表标识符（table_id）的逗号分隔列表。 
comma_separated_list_of_producter_bootstrap_ids：源集群引导程序标识符（bootstrap_id）的逗号分隔列表。使用bootstrap_cdc_producer来获取，并使用逗号分隔源集群的表ID。</p>
<p>重要提示：bootstrap_id需要与table_id的排序顺序必须保持一致。
使用remove_table子命令从现有列表中删除一个或多个表： 
基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;target_mserver_addresses&gt; \
    alter_universe_replication &lt;source_universe_uuid&gt;_&lt;replication_name&gt; \
    remove_table [ &lt;comma_separated_list_of_table_ids&gt; ]
</code></pre></div>
<p>target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
source_universe_uid：源集群的uuid。
replication_name：要更改的复制的名称。
comma_separated_list_of_table_ids:源集群表标识符（table_id）的逗号分隔列表。</p>
<p>使用rename_id子命令可以重命名xDCR复制流。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;target_mserver_addresses&gt; \
    alter_universe_replication &lt;source_universe_uuid&gt;_&lt;replication_name&gt; \
    rename_id &lt;source_universe_uuid&gt;_&lt;new_replication_name&gt;
</code></pre></div>
<p>target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
source_universe_uid：源集群的uuid。
replication_name：要更改的复制的名称。
new_replication_name：复制的新名称。 </p>
<h5 id="delete_universe_replication"><strong>delete_universe_replication <source_universe_uuid></strong></h5>
<p>删除指定源集群的集群复制。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;target_mserver_addresses&gt; \
    delete_universe_replication &lt;source_universe_uuid&gt;_&lt;replication_name&gt;
</code></pre></div>
<p>target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
source_universe_uid：源集群的uuid。
replication_name：要删除的复制的名称。</p>
<h5 id="set_universe_replication_enabled"><strong>set_universe_replication_enabled</strong></h5>
<p>可以设置复制为启用或禁用，来暂停复制过程。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;target_mserver_addresses&gt; \ 
set_universe_replication_enabled  &lt;source_universe_uuid&gt;_&lt;replication_name&gt; (0|1)
</code></pre></div>
<p>解释：
target_mserver_addresss:目标mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
source_universe_uid：源集群的uuid。
replication_name：要启用或禁用的复制的名称。
0|1:0代表禁用，1代表启用。默认值为1。</p>
<h5 id="list_cdc_streams"><strong>list_cdc_streams</strong></h5>
<p>列出指定mserver服务器的CDC流。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    list_cdc_streams
</code></pre></div>
<p>解释：
mserver-addresses: mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 \
    list_cdc_streams
</code></pre></div>
<h5 id="delete_cdc_stream-force_delete"><strong>delete_cdc_stream <stream_id> [force_delete]</strong></h5>
<p>删除指定mserver主机服务器的基础CDC流。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    delete_cdc_stream &lt;stream_id [force_delete]&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。 
stream_id：CDC流的id。 
force_delete：（可选）强制执行删除操作。 </p>
<h5 id="bootstrap_cdc_producer"><strong>bootstrap_cdc_producer <comma_separated_list_of_table_ids></strong></h5>
<p>标记一组表，为设置集群的复制做准备。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses &lt;mserver-addresses&gt; \
    bootstrap_cdc_producer &lt;comma_separated_list_of_table_ids&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
comma_separated_list_of_table_ids：以逗号分隔的表标识符列表（table_id）。 </p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 \
    bootstrap_cdc_producer 000030ad000030008000000000004000
</code></pre></div>
<h5 id="get_replication_status"><strong>get_replication_status</strong></h5>
<p>返回所有使用者流的复制状态。如果提供了producter_universe_uuid，则只返回属于关联集群密钥的流。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
-mserver_addresses &lt;mserver-addresses&gt; get_replication_status [ &lt;producer_universe_uuid&gt; ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。 
producter_universe_uuid：可选的集群唯一标识符（可以是任何字符串，例如uuid的字符串）</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin \
    -mserver_addresses 10.0.0.4:11000,10.0.0.5:11000,10.0.0.6:11000     get_replication_status 4b0ec5da-3582-45b3-aa47-98d9425a5f5c
</code></pre></div>
<h4 id="decommissioning-commands"><strong>Decommissioning commands</strong></h4>
<h5 id="get_leader_blacklist_completion"><strong>get_leader_blacklist_completion</strong></h5>
<p>获取列入黑名单的节点的分片加载移动完成百分比。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    get_leader_blacklist_completion
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.4:11000,10.0.0.5:11000,10.0.0.6:11000 get_leader_blacklist_completion
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Percent complete = 100 : 0 remaining out of 0
</code></pre></div>
<h5 id="change_blacklist"><strong>change_blacklist</strong></h5>
<p>更改dbserver服务器的黑名单，当旧的dbserver服务器终止后，可以使用此命令清除黑名单。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    change_blacklist [ ADD | REMOVE ] &lt;ip_addr&gt;:&lt;port&gt; \
    [ &lt;ip_addr&gt;:&lt;port&gt; ]...
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
ADD | REMOVE: 从黑名单中新增或者移除指定的dbserver服务器。
ip_addr:port: dbserver服务器IP地址和端口，如多个，需用空格分隔。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 change_blacklist ADD 10.0.0.4:21000 10.0.0.5:21000
</code></pre></div>
<h5 id="change_leader_blacklist"><strong>change_leader_blacklist</strong></h5>
<p>更改dbserver服务器的Leader黑名单。 </p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    change_blacklist [ ADD | REMOVE ] &lt;ip_addr&gt;:&lt;port&gt; \
    [ &lt;ip_addr&gt;:&lt;port&gt; ]...
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
ADD | REMOVE: 从黑名单中新增或者移除指定的dbserver服务器。
ip_addr:port: dbserver服务器IP地址和端口，如多个，需用空格分隔。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 change_leader_blacklist ADD 10.0.0.4:21000 10.0.0.5:21000
</code></pre></div>
<h5 id="leader_stepdown"><strong>leader_stepdown</strong></h5>
<p>强制指定分片的dbserver的Leader不为Leader。
注意：只有在支持人员建议的情况下，才能使用此命令，使用此命令，存在停机的可能性。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin 
    -mserver_addresses &lt;mserver-addresses&gt; \
    leader_stepdown &lt;tablet_id&gt; &lt;dest_ts_uuid&gt;
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
tablet_id：分片标识符ID。
dest_ts_uuid：新的dbserver Leader的目标标识符（uuid）。当需要Leader角色转移的时候，如果不需要指定新的Leader时，使用“”作为参数值，则系统将自动选举新的Leader；否则，指定新的Leader。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 leader_stepdown 74eb92ad716b47b6b5a3a14ef25c1504
</code></pre></div>
<h4 id="_30"><strong>负载均衡命令</strong></h4>
<h5 id="set_load_balancer_enabled"><strong>set_load_balancer_enabled</strong></h5>
<p>设置集群是否启用负载均衡。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    set_load_balancer_enabled [ 0 | 1 ]
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。
0 | 1：默认值为可用（1），当需要设置为不可用时，设置为0。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 set_load_balancer_enabled 0
</code></pre></div>
<h5 id="get_load_balancer_state"><strong>get_load_balancer_state</strong></h5>
<p>返回集群的负载均衡的状态。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; get_load_balancer_state
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 get_load_balancer_state
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>mserver UUID                           RPC Host/Port      State           Role            Load Balancer State

56cbdb3d264e4e5fae25e254cc9b385f        10.0.0.1:11000     ALIVE           FOLLOWER        ENABLED

dd008a734a934fbf9b31a7729ef8050e        10.0.0.2:11000     ALIVE           FOLLOWER        ENABLED

c7a6c728961747fcbde443c18f6620a8        10.0.0.3:11000     ALIVE           LEADER          ENABLED
</code></pre></div>
<h5 id="get_load_move_completion"><strong>get_load_move_completion</strong></h5>
<p>检查数据移动的完成百分比，可以定期重新运行此命令，直到值达到100.0，表示数据移动已完成。
注意：
完成数据移动所需的时间取决于以下内容：
1）表和分片的数量
2）每一个分片的大小
3）SSD传输速度
4）新节点和现有节点之间的网络带宽</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    get_load_move_completion
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 get_load_move_completion
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Percent complete = 100 : 0 remaining out of 0
</code></pre></div>
<h5 id="get_is_load_balancer_idle"><strong>get_is_load_balancer_idle</strong></h5>
<p>验证负载平衡器是否处于空闲状态。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin
    -mserver_addresses &lt;mserver-addresses&gt; \
    get_is_load_balancer_idle
</code></pre></div>
<p>解释：
mserver-addresses：mserver主机和端口的逗号分隔列表。默认值为localhost:11000。</p>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin --mserver_addresses 10.0.0.1:11000,10.0.0.2:11000,10.0.0.3:11000 get_is_load_balancer_idle
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>Idle = 1
</code></pre></div>
<h4 id="bsql"><strong>更新BSQL系统目录</strong></h4>
<h5 id="upgrade_bsql"><strong>upgrade_bsql</strong></h5>
<p>在AiSQL集群升级成功后升级BSQL系统目录。对于未启用BSQL的集群，不需要进行BSQL升级。</p>
<p>基本语法为：</p>
<div class="highlight"><pre><span></span><code>./bm-admin upgrade_bsql
</code></pre></div>
<p>例如：</p>
<div class="highlight"><pre><span></span><code>./bm-admin upgrade_bsql
</code></pre></div>
<p>执行成功，会打印类似如下信息：</p>
<div class="highlight"><pre><span></span><code>BSQL successfully upgraded to the latest version
</code></pre></div>
<p>在某些情况下，BSQL升级可能需要超过60秒的时间，这是bm-admin的默认超时值。为此，请使用更高的超时值运行命令：</p>
<div class="highlight"><pre><span></span><code>./bm-admin -timeout_ms 180000 upgrade_bsql
</code></pre></div>
<p>运行上述命令是一个联机操作，不需要停止正在运行的集群。可以多次运行而没有任何副作用。</p>
<p>注意：
集群中的并发操作可能导致各种事务冲突、目录版本不匹配和读取重新启动错误，应该通过重新运行升级命令来解决。</p>
<p>请参阅<a href="#_升级部署">升级部署</a>以了解mserver服务器和dbserver升级，然后是BSQL系统目录升级。</p>
<h3 id="dbserver-ctl"><strong>dbserver-ctl</strong></h3>
<p>dbserver-ctl 是一个命令行工具，可用于在特定的 Tile 服务器 (dbserver) 上执行操作。 某些命令执行的操作与 bm-admin 命令类似。 bm-admin 命令专注于集群管理，dbserver-ctl 命令适用于特定的 DBServer 节点。</p>
<p>dbserver-ctl 是随 AiSQL 安装的二进制文件，位于 AiSQL 主目录的 bin 目录中。</p>
<h4 id="_31"><strong>语法</strong></h4>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] &lt;command&gt; &lt;flags&gt;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
command：执行的命令。 
flags：应用于命令的标志。</p>
<p><strong>在线帮助</strong>
要显示可用的在线帮助，请在 AiSQL 主目录中运行 dbserver-ctl（不带任何命令或标志）。</p>
<div class="highlight"><pre><span></span><code>./bin/dbserver-ctl
</code></pre></div>
<h4 id="_32"><strong>命令</strong></h4>
<p>可以使用以下命令：</p>
<ul>
<li>are_tiles_running</li>
<li>is_server_ready</li>
<li>compact_all_tiles</li>
<li>compact_tile</li>
<li>count_intents</li>
<li>current_hybrid_time</li>
<li>delete_tile</li>
<li>dump_tile</li>
<li>flush_all_tiles</li>
<li>flush_tile</li>
<li>list_tiles</li>
<li>reload_certificates</li>
<li>remote_bootstrap</li>
<li>set_flag</li>
<li>status</li>
<li>refresh_flags</li>
</ul>
<h5 id="are_tablets_running"><strong>are_tablets_running</strong></h5>
<p>如果所有Tile都在运行，则返回“All tiles are running”。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] are_tiles_running
</code></pre></div>
<p>host:port：tiles服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="is_server_ready"><strong>is_server_ready</strong></h5>
<p>打印尚未引导的Tile数量。 如果所有Tile均已引导，则返回“Tile server is ready”。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] is_server_ready
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="compact_all_tiles"><strong>compact_all_tiles</strong></h5>
<p>压缩Tile服务器上的所有Tile。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] compact_all_tiles
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="compact_tile"><strong>compact_tile</strong></h5>
<p>在Tile服务器上压缩指定的Tile。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] compact_tile &lt;tile_id&gt;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
tile_id：要压缩的tile 的标识符。</p>
<h5 id="count_intents"><strong>count_intents</strong></h5>
<p>打印未提交意图（或临时记录）的计数。 对于调试事务工作负载很有用。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl  [ --server_address=&lt;host&gt;:&lt;port&gt; ] count_intents
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="current_hybrid_time"><strong>current_hybrid_time</strong></h5>
<p>打印当前混合时间的值。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl  [ --server_address=&lt;host&gt;:&lt;port&gt; ] current_hybrid_time
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="delete_tile"><strong>delete_tile</strong></h5>
<p>删除具有指定Tile ID (tile_id) 和原因的Tile。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl  [ --server_address=&lt;host&gt;:&lt;port&gt; ] delete_tile &lt;tile_id&gt; &quot;&lt;reason-string&gt;&quot;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
tile_id：Tile的标识符 (ID)。
Reason-string：文本字符串，提供有关Tile被删除原因的有用信息。</p>
<h5 id="dump_tile"><strong>dump_tile</strong></h5>
<p>转储或导出指定的Tile ID (tile_id)。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] dump_tile &lt;tile_id&gt;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
tablet_id：Tile的标识符 (ID)。</p>
<h5 id="flush_all_tiles"><strong>flush_all_tiles</strong></h5>
<p>刷新Tile服务器上的所有Tile。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] flush_all_tiles
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="flush_tile"><strong>flush_tile</strong></h5>
<p>刷新Tile服务器上指定的Tile。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] flush_tile &lt;tile_id&gt;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
tile_id：要刷新的tile 的标识符。</p>
<h5 id="list_tiles"><strong>list_tiles</strong></h5>
<p>列出指定tile 服务器上的tile，显示以下属性：列名称、tileID、状态、表名称、分片和架构。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] list_tiles
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="reload_certificates"><strong>reload_certificates</strong></h5>
<p>触发从指定（mserver 或Tile）服务器上的磁盘重新加载 TLS 证书和私钥。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] reload_certificates
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="remote_bootstrap"><strong>remote_bootstrap</strong></h5>
<p>触发从另一个tile 服务器到指定tile服务器的tile远程引导。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] remote_bootstrap &lt;source_host&gt; &lt;tile_id&gt;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
source_host：要引导的Tile服务器的主机或主机和端口。
tile_id：要触发远程引导的Tile的标识符。</p>
<h5 id="set_flag"><strong>set_flag</strong></h5>
<p>为tile 服务器设置指定的配置标志。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] set_flag [ --force ] &lt;flag&gt; &lt;value&gt;
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。
--force：允许更改未显式标记为运行时可设置的标志的标志。 请注意，如果提供了不安全的值，则更改可能会在服务器上被忽略，或者可能导致服务器崩溃。
flag：要设置的 dbserver 配置标志（不带 -- 前缀）。 请参阅 dbserver
value：要应用的值。</p>
<p>set_flag 命令以原子方式更改正在运行的服务器的指定标志的内存值，并可以改变其行为。 更改不会在重新启动后持续存在。</p>
<p>实际上，有些标志可以在运行时安全地更改（运行时可设置），而有些则不然。 例如，服务器的绑定地址无法在运行时更改，因为服务器在启动时仅绑定一次。 虽然大多数标志可能是运行时可设置的，但您需要检查这些标志并在配置页中记下哪些标志不可运行时设置。
一种典型的操作流程是，您可以使用它来修改内存中的运行时标志，然后在带外也修改服务器用于启动的配置文件。 这允许在运行的服务器上更改标志，而无需重新启动服务器。</p>
<h5 id="status"><strong>Status</strong></h5>
<p>打印tile 服务器的状态，包括节点实例信息、绑定的RPC地址、绑定的HTTP地址和版本信息。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] status
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h5 id="refresh_flags"><strong>refresh_flags</strong></h5>
<p>刷新从配置文件加载的标志。 适用于 DBServer （端口 21000）和 MServer（端口 11000）进程。 无需参数。</p>
<p>每个进程都需要发出以下命令，例如，在一个 DBServer 上发出该命令不会更新其他 DBServer 上的标志。
语法：</p>
<div class="highlight"><pre><span></span><code>dbserver-ctl [ --server_address=&lt;host&gt;:&lt;port&gt; ] refresh_flags
</code></pre></div>
<p>host:port：tile 服务器的主机和端口。 默认值为localhost:21000。</p>
<h4 id="_33"><strong>标志</strong></h4>
<p>如果指定，可以将以下标志与上述命令一起使用。
--force 
将此标志与 set_flag 命令结合使用可允许更改未显式标记为运行时可设置的标志。 请注意，如果提供了不安全的值，则更改可能会在服务器上被忽略，或者可能导致服务器崩溃。
默认值：false</p>
<p>--server-address 
要运行的 tile 服务器的地址（主机和端口）。
默认值：localhost:21000</p>
<p>--timeout_ms
RPC 请求超时之前的持续时间，以毫秒 (ms) 为单位
默认值：60000 (1000 ms = 1 sec)</p>
<p>--certs_dir_name
要连接到启用了 TLS 的集群，您必须包含 --certs_dir_name 标志以及根证书所在的目录位置。
默认值：””</p>
<h4 id="_34"><strong>示例</strong></h4>
<p>返回tile 服务器的状态</p>
<div class="highlight"><pre><span></span><code>./bin/dbserver-ctl --server_address=127.0.0.1 --certs_dir_name=&quot;/path/to/dir/name&quot; status
</code></pre></div>
<div class="highlight"><pre><span></span><code>node_instance {
  permanent_uuid: &quot;237678d61086489991080bdfc68a28db&quot;
  instance_seqno: 1579278624770505
}
bound_rpc_addresses {
  host: &quot;127.0.0.1&quot;
  port: 21000
}
bound_http_addresses {
  host: &quot;127.0.0.1&quot;
  port: 20000
}
version_info {
  git_hash: &quot;83610e77c7659c7587bc0c8aea76db47ff8e2df1&quot;
  build_hostname: &quot;bm-macmini-6.dev.bigmath.com&quot;
  build_timestamp: &quot;06 Jan 2020 17:47:22 PST&quot;
  build_username: &quot;jenkins&quot;
  build_clean_repo: true
  build_id: &quot;743&quot;
  build_type: &quot;RELEASE&quot;
  version_number: &quot;2.0.10.0&quot;
  build_number: &quot;4&quot;
}
</code></pre></div>
<p>显示当前混合时间</p>
<div class="highlight"><pre><span></span><code>./bin/dbserver-ctl  --server_address=dbserver-1:21000 current_hybrid_time
</code></pre></div>
<div class="highlight"><pre><span></span><code>6470519323472437248
</code></pre></div>
<h3 id="bm-dump"><strong>bm-dump</strong></h3>
<p>将 AiSQL 数据库提取到 SQL 脚本文件中。</p>
<h4 id="_35"><strong>概述</strong></h4>
<p>bm-dump 是一个用于将 AiSQL 数据库备份到纯文本 SQL 脚本文件的实用程序。 bm-dump 可以进行一致的备份，即使数据库正在同时使用。 bm-dump 不会阻止其他用户访问数据库（读取器或写入器）。</p>
<p>bm-dump 仅转储单个数据库。 要备份集群中所有数据库共用的全局对象（例如角色），请使用 bm-dumpall。</p>
<p>转储以纯文本、SQL 脚本文件的形式输出。 脚本转储是纯文本文件，其中包含将数据库重建到保存时状态所需的 SQL 语句。 要从此类脚本恢复，请使用 sqlsh \i 元命令导入它。 即使在其他机器和其他架构上，脚本文件也可以用于重建数据库； 进行一些修改，甚至在其他 SQL 数据库产品上也是如此。</p>
<p>运行 bm-dump 时，您应该检查输出中是否有任何警告（在标准错误上打印）。</p>
<p>bm-dump 实用程序源自 PostgreSQL pg_dump 实用程序。</p>
<h5 id="_36"><strong>安装</strong></h5>
<p>bm-dump 随 AiSQL 一起安装，位于 AiSQL 主目录的 postgres/bin 目录中。</p>
<h5 id="_37"><strong>在线帮助</strong></h5>
<p>运行 bm-dump --help 显示在线帮助</p>
<h4 id="_38"><strong>语法</strong></h4>
<div class="highlight"><pre><span></span><code>bm-dump [ &lt;connection-option&gt;... ] [ &lt;content-output-format-option&gt; ... ] [ &lt;dbname&gt; ]
</code></pre></div>
<p>connection-option：请参阅数据库连接选项。
content-output-format-option：请参阅内容和输出格式选项
dbname：数据库的名称。</p>
<h4 id="_39"><strong>内容和输出格式选项</strong></h4>
<p>以下命令行选项控制输出的内容和格式。
Dbname
指定要转储的数据库的名称。 如果未指定，则使用环境变量 PGDATABASE。 如果未设置，则使用为连接指定的用户名。</p>
<p>-a, --data-only
仅转储数据，而不转储架构（数据定义）。 转储表数据、大对象和序列值。</p>
<p>-b, --blobs
将大型物体放入转储中。 这是默认行为，除非指定 -n|--schema、-t|--table 或 -s|--schema-only。 因此，-b|--blobs 选项仅适用于将大对象添加到已请求特定架构或表的转储中。 请注意，blob 被视为数据，因此在使用 -a|--data-only 时将被包括在内，但在使用 -s|--schema-only 时则不会被包括在内。</p>
<p>-B, --no-blobs
排除转储中的大型对象。
当同时给出 -b|--blobs 和 -B|--no-blobs 时，行为是输出大对象，当转储数据时，请参阅 -b|--blobs 选项。</p>
<p>-c, --clean 
在输出创建数据库对象的语句之前，输出语句以清理（删除）数据库对象。 （除非还指定了 --if-exists，否则如果目标数据库中不存在任何对象，则恢复可能会生成一些无害的错误消息。）</p>
<p>-C, --create
以创建数据库本身并重新连接到创建的数据库的语句开始输出。 （对于这种形式的脚本，在运行脚本之前连接到目标安装中的哪个数据库并不重要。）如果还指定了 -c|--clean，则脚本会在重新连接到目标数据库之前删除并重新创建目标数据库。</p>
<p>-E encoding, --encoding=encoding 
以指定的字符集编码创建转储。 默认情况下，转储是以数据库编码创建的。 （获得相同结果的另一种方法是将 PGCLIENTENCODING 环境变量设置为所需的转储编码。）</p>
<p>-f file, --file=file 
将输出发送到指定文件。 对于基于文件的输出格式可以省略此参数，在这种情况下使用标准输出。</p>
<p>-m addresses, --mservers=addresses 
MServer 主机和端口的逗号分隔列表。</p>
<p>-n schema, --schema=schema 
仅转储与模式匹配的模式； 这会选择模式本身及其所有包含的对象。 当未指定此选项时，将转储目标数据库中的所有非系统模式。 可以通过编写多个 -n|--schema 选项来选择多个模式。 此外，schema 参数根据 sqlsh \d 命令使用的相同规则被解释为模式，因此也可以通过在模式中写入通配符来选择多个模式。 使用通配符时，如果需要，请小心引用模式，以防止 shell 扩展通配符。</p>
<p>注：当指定 -n|--schema 时，bm-dump 不会尝试转储所选模式可能依赖的任何其他数据库对象。 因此，不能保证特定模式转储的结果可以成功地自行恢复到干净的数据库中。
指定 -n|--schema 时，不会转储非架构对象（例如 blob）。 您可以使用 -b|--blobs 选项将 blob 添加回转储。</p>
<p>-N schema, --exclude-schema=schema 
不要转储任何与架构模式匹配的架构。 该模式根据与 -n|--schema 选项相同的规则进行解释。 -N|--exclude-schema 可以多次给出，以排除与多个模式中的任何一个匹配的模式。</p>
<p>当同时给出 -n|--schema 和 -N|--exclude-schema 时，行为是仅转储至少匹配一个 -n|--schema 选项但不匹配 -N|--exclude-schema 的模式 选项。 如果 -N|--exclude-schema 出现时没有 -n|--schema，则匹配 -N|--exclude-schema 的模式将从正常转储中排除。</p>
<p>-o, --oids
将对象标识符 (OID) 转储为每个表的数据的一部分。 如果您的应用程序以某种方式引用 OID 列（例如，在外键约束中），请使用此选项。 否则，不应使用此选项。</p>
<p>-O, --no-owner 
不要输出语句来设置对象所有权以匹配原始数据库。 默认情况下，bm-dump 发出 ALTER OWNER 或 SET SESSION AUTHORIZATION 语句来设置创建的数据库对象的所有权。 当脚本运行时，这些语句将失败，除非它是由超级用户（或拥有脚本中所有对象的同一用户）启动的。 要创建可由任何用户恢复的脚本，但会授予该用户所有对象的所有权，请指定 -O|--no-owner。</p>
<p>-s, --schema-only
仅转储对象定义（架构），而不转储数据。
此选项与 -a|--data-only 相反。</p>
<p>（不要将其与 -n|--schema 选项混淆，后者以不同的含义使用“schema”一词。）</p>
<p>要仅排除数据库中表的子集的表数据，请参阅 --exclude-table-data。</p>
<p>-S username, --superuser=username 
指定禁用触发器时要使用的超级用户用户名。 仅当使用 --disable-triggers 时这才相关。 （通常，最好将其忽略，而是以超级用户身份启动生成的脚本。）</p>
<p>-t table, --table=table 
仅转储名称与表匹配的表。 为此，“表”包括视图、物化视图、序列和外部表。 可以通过编写多个 -t|--table 选项来选择多个表。 此外，table 参数根据 sqlsh \d 命令使用的相同规则被解释为模式，因此也可以通过在模式中写入通配符来选择多个表。 使用通配符时，如果需要，请小心引用模式，以防止 shell 扩展通配符。</p>
<p>当使用 -t|--table 时，-n|--schema 和 -N|--exclude-schema 选项不起作用，因为无论这些选项如何，由 -t|--table 选择的表都将被转储，并且非 -表对象不会被转储。</p>
<p>注：当指定 -t|--table 时，bm-dump 不会尝试转储所选表可能依赖的任何其他数据库对象。 因此，不能保证特定表转储的结果可以成功地自行恢复到干净的数据库中。</p>
<p>-T table, --exclude-table=table
不要转储任何与表模式匹配的表。 该模式根据与 -t 相同的规则进行解释。 -T|--exclude-table 可以多次给出以排除与多种模式中的任何一个匹配的表。</p>
<p>当同时给出 -t|--table 和 -T|--exclude-table 时，行为是仅转储至少匹配一个 -t|--table 选项但不匹配 -T|--exclude-table 的表 选项。 如果 -T|--exclude-table 出现时没有 -t|--table，则匹配 -T|--exclude-table 的表将从正常转储中排除。</p>
<p>-v, --verbose
指定详细模式。 这会导致 bm-dump 将详细的对象注释以及开始和停止时间输出到转储文件，并将进度消息输出到标准错误。</p>
<p>-V, --version
打印 bm-dump 版本并退出。</p>
<p>-x, --no-privileges, --no-acl
防止转储访问权限（GRANT 和 REVOKE 语句）。</p>
<p>-Z 0..9, --compress=0..9
指定要使用的压缩级别。 零 (0) 表示不压缩。 对于纯文本输出，设置非零压缩级别会导致整个输出文件被压缩，就像通过 gzip 提供的一样； 但默认不压缩。</p>
<p>--column-inserts, --attribute-inserts
将数据转储为具有显式列名称的 INSERT 语句（INSERT INTO table (column, ...) VALUES ...）。 这使得恢复非常缓慢； 它主要有助于制作可加载到非 AiSQL 数据库中的转储。 但是，由于此选项为每一行生成单独的语句，因此重新加载行时发生错误只会导致该行丢失，而不是整个表内容丢失。</p>
<p>--disable-dollar-quoting 
此选项禁止对函数体使用美元引用，并强制使用 SQL 标准字符串语法对它们进行引用。</p>
<p>--disable-triggers
此选项仅在创建纯数据转储时相关。 它指示 bm-dump 包含在重新加载数据时临时禁用目标表上的触发器的语句。 如果您不想在数据重新加载期间调用表上的引用完整性检查或其他触发器，请使用此选项。</p>
<p>目前，为 --disable-triggers 发出的语句必须以超级用户身份完成。 因此，您还应该使用 -S|--superuser 指定超级用户名，或者最好小心地以超级用户身份启动生成的脚本。</p>
<p>--enable-row-security 
仅当转储具有行安全性的表的内容时，此选项才相关。 默认情况下，bm-dump 将 row_security 设置为 off，以确保从表中转储所有数据。 如果用户没有足够的权限来绕过行安全性，则会引发错误。 此参数指示 bm-dump 将 row_security 设置为 on，从而允许用户转储他们有权访问的表内容的部分。</p>
<p>请注意，如果您当前使用此选项，您可能还希望转储采用 INSERT 格式，因为还原期间的 COPY FROM 不支持行安全性。</p>
<p>--exclude-table-data=table
不要转储任何与表模式匹配的表的数据。 该模式根据与 -t|--table 相同的规则进行解释。 可以多次给出 --exclude-table-data 选项以排除与多种模式中的任何一种匹配的表。 当您需要定义特定表（即使不需要其中的数据）时，此选项很有用。</p>
<p>要排除数据库中所有表的数据，请参阅 -s|--schema-only。</p>
<p>--if-exists 
清理数据库对象时使用条件语句（即添加 IF EXISTS 子句）。 除非还指定了 -c|--clean，否则此选项无效。</p>
<p>--inserts
将数据转储为 INSERT 语句（而不是 COPY 语句）。 这会让恢复变得非常缓慢； 它主要有助于制作可加载到非 AiSQL 数据库中的转储。 但是，由于此选项为每一行生成单独的语句，因此重新加载行时发生错误只会导致该行丢失，而不是整个表内容丢失。 请注意，如果您重新排列了列顺序，则还原可能会完全失败。 --column-inserts 选项对于列顺序更改是安全的，尽管速度更慢。</p>
<p>--lock-wait-timeout=timeout 
不要永远等待在转储开始时获取共享表锁。 如果无法在指定的超时时间内锁定表，则会失败。 超时可以用 SET statements_timeout 接受的任何格式指定。 （允许的格式根据您转储的服务器版本而有所不同，但所有版本都接受整数毫秒。）</p>
<p>--no-publications 
不转储发布</p>
<p>--no-security-labels 
不转储安全标签</p>
<p>--no-subscriptions 
不要转储订阅。</p>
<p>--no-sync 
默认情况下，bm-dump 等待所有文件安全写入磁盘。 此选项导致 bm-dump 无需等待就返回，这速度更快，但意味着后续操作系统崩溃可能会使转储损坏。 通常，此选项有助于测试，但在从生产安装转储数据时不应使用。</p>
<p>--no-unlogged-table-data
不要转储未wal的表的内容。 该选项对于是否转储表定义（模式）没有影响； 它仅禁止转储表数据。 从备用服务器转储时，未记录表中的数据始终会被排除。</p>
<p>--quote-all-identifiers 
强制引用所有标识符。 当从 AiSQL 主要版本与 bm-dump 不同的服务器转储数据库时，或者当打算将输出加载到不同主要版本的服务器时，建议使用此选项。 默认情况下，bm-dump 仅引用在其自己的主要版本中属于保留字的标识符。 在处理可能具有稍微不同的保留字集的其他版本的服务器时，这有时会导致兼容性问题。 使用 --quote-all-identifiers 可以防止此类问题，但代价是转储脚本难以阅读。</p>
<p>--section=sectionname 
仅转储指定部分。 部分名称可以是前数据、数据或后数据。 可以多次指定此选项以选择多个部分。 默认是转储所有部分。</p>
<p>数据部分包含实际的表数据、大对象内容和序列值。 后数据项包括除已验证的检查约束之外的索引、触发器、规则和约束的定义。 前置数据项包括所有其他数据定义项。</p>
<p>--no-serializable-deferrable
使用 --no-serialized-deferrable 标志禁用默认的可串行化-可延迟事务模式。 可串行化-可延迟模式通过等待事务流中不存在异常的点来确保所使用的快照与后续数据库状态一致，从而不存在转储失败或导致其他事务回滚的风险 出现序列化失败。</p>
<p>如果有活动的读写事务，则转储开始之前的最大等待时间将为 50ms（基于 DBServer 和 MServer 服务器的默认 --max_clock_skew_usec。） 如果没有活动的读写事务 当 bm-dump 启动时，该选项不会产生任何影响。 一旦运行，无论有没有该选项，性能都是相同的。</p>
<p>--snapshot=snapshotname
转储数据库时使用指定的同步快照。 当需要将转储与逻辑复制槽或并发会话同步时，此选项非常有用。 在并行转储的情况下，将使用此选项定义的快照名称，而不是拍摄新快照。</p>
<p>--strict-names 
要求每个架构 (-n|--schema) 和表 (-t|--table) 限定符至少与要转储的数据库中的一个架构或表匹配。 请注意，如果没有任何模式或表限定符找到匹配项，即使没有 --strict-names，bm-dump 也会生成错误。</p>
<p>此选项对 -N|--exclude-schema、-T|--exclude-table 或 --exclude-table-data 没有影响。 未能匹配任何对象的排除模式不被视为错误。</p>
<p>--use-set-session-authorization 
输出 SQL 标准 SET SESSION AUTHORIZATION 语句而不是 ALTER OWNER 语句来确定对象所有权。 这使得转储更符合标准，但根据转储中对象的历史记录，可能无法正确恢复。 此外，使用 SET SESSION AUTHORIZATION 语句的转储肯定需要超级用户权限才能正确恢复，而 ALTER OWNER 语句需要较少的权限。</p>
<p>-?, --help
显示有关 bm-dump 命令行参数的帮助，然后退出</p>
<h4 id="_40"><strong>数据库连接选项</strong></h4>
<p>以下命令行选项控制数据库连接参数。</p>
<p>-d dbname, --dbname=dbname 
指定要连接的数据库的名称。 这相当于将 dbname 指定为命令行上的第一个非选项参数。</p>
<p>如果此参数包含等号 (=) 或以有效的 URI 前缀 (brightdb://) 开头，则将其视为 conninfo 字符串。</p>
<p>-h host, --host=host
指定运行服务器的计算机的主机名。 如果该值以斜杠 (/) 开头，则用作 Unix 域套接字的目录。 默认为编译主机 127.0.0.1，否则尝试 Unix 域套接字连接。</p>
<p>-p port, --port=port
指定服务器侦听连接的 TCP 端口或本地 Unix 域套接字文件扩展名。 默认为编译端口 2521。</p>
<p>-U username, --username=username
连接的用户名。</p>
<p>-w, --no-password
切勿发出密码提示。 如果服务器需要密码身份验证，并且无法通过其他方式（例如 ~/.pgpass 文件）获得密码，则连接尝试将失败。 此选项在没有用户输入密码的批处理作业和脚本中非常有用。</p>
<p>-W, --password 
强制 bm-dump 在连接到数据库之前提示输入密码。</p>
<p>该选项从来都不是必需的，因为如果服务器要求密码身份验证，bm-dump 会自动提示输入密码。 然而，bm-dump 会浪费一次连接尝试来发现服务器需要密码。 在某些情况下，值得输入 -W|--password 以避免额外的连接尝试。</p>
<p>--role=rolename
指定用于创建转储的角色名称。 此选项导致 bm-dump 在连接到数据库后发出 SET ROLE <rolename> 语句。 当经过身份验证的用户（由 -U|--username 指定）缺乏 bm-dump 所需的权限，但可以切换到具有所需权限的角色时，它非常有用。 某些安装有禁止以超级用户身份直接登录的策略，使用此选项允许在不违反策略的情况下进行转储。</p>
<h4 id="_41"><strong>环境</strong></h4>
<p>AiSQL 使用以下 PostgreSQL 环境变量（在某些 bm-dump 选项中引用）来实现 PostgreSQL 兼容性：</p>
<ul>
<li>PGHOST</li>
<li>PGPORT</li>
<li>PGOPTIONS</li>
<li>PGUSER</li>
<li>PGDATABASE</li>
<li>PGCLIENTENCODING</li>
</ul>
<p>该实用程序还使用 libpq 支持的环境变量。</p>
<h4 id="_42"><strong>诊断</strong></h4>
<p>bm-dump 在内部执行 SELECT 语句。 如果运行 bm-dump 时遇到问题，请确保您能够使用 sqlsh 等从数据库中查询信息。 此外，libpq 前端库使用的任何默认连接设置和环境变量都将适用。</p>
<p>bm-dump 的数据库活动通常由统计收集器收集。 如果不希望出现这种情况，您可以使用 PGOPTIONS 或 ALTER USER 语句将参数 track_counts 设置为 false。</p>
<h4 id="_43"><strong>注意事项</strong></h4>
<p>如果您的 AiSQL 集群对 template1 数据库有任何本地添加，请小心将 bm-dump 的输出恢复到真正的空数据库中； 否则，您可能会由于添加的对象的重复定义而出现错误。 要创建一个没有任何本地添加的空数据库，请从 template0 而不是 template1 复制，例如：</p>
<div class="highlight"><pre><span></span><code>CREATE DATABASE foo WITH TEMPLATE template0;
</code></pre></div>
<p>当选择仅数据转储并使用选项 --disable-triggers 时，bm-dump 会在插入数据之前发出语句来禁用用户表上的触发器，然后在插入数据后发出语句来重新启用触发器。 如果恢复中途停止，系统目录可能会处于错误状态。</p>
<p>bm-dump 生成的转储文件不包含优化器用于制定查询计划决策的统计信息。 因此，从转储文件恢复后运行 ANALYZE 可以确保最佳性能。</p>
<p>由于 bm-dump 用于将数据传输到较新版本的 AiSQL，因此 bm-dump 的输出预计会加载到比 bm-dump 版本更新的 AiSQL 版本中。 bm-dump 还可以从早于其自身版本的 AiSQL 服务器转储。 但是，bm-dump 无法从比其主要版本更新的 AiSQL 服务器转储； 它甚至会拒绝尝试，而不是冒险进行无效转储。 此外，不保证 bm-dump 输出可以加载到较旧主要版本的服务器中 - 即使转储是从该版本的服务器中获取的。 将转储文件加载到旧服务器中可能需要手动编辑转储文件以删除旧服务器无法理解的语法。 建议在跨版本情况下使用 --quote-all-identifiers 选项，因为它可以防止不同 AiSQL 版本中不同的保留字列表引起的问题。</p>
<h4 id="_44"><strong>示例</strong></h4>
<p>将数据库转储到 SQL 脚本文件中</p>
<div class="highlight"><pre><span></span><code>$ bm-dump mydb &gt; mydb.sql
</code></pre></div>
<p>转储名为 mytable 的单个表</p>
<div class="highlight"><pre><span></span><code>$ bm-dump -t mytable mydb -f mytable_mydb.sql
</code></pre></div>
<p>基于过滤器的转储模式
以下命令转储名称以 east 或 west 开头并以 gsm 结尾的所有模式，不包括名称包含单词 test 的任何模式：</p>
<div class="highlight"><pre><span></span><code>$ bm-dump -n &#39;east*gsm&#39; -n &#39;west*gsm&#39; -N &#39;*test*&#39; mydb &gt; myschemas_mydb.sql
</code></pre></div>
<p>这是同一示例，使用正则表达式表示法来合并选项：</p>
<div class="highlight"><pre><span></span><code>$ bm-dump -n &#39;(east|west)*gsm&#39; -N &#39;*test*&#39; mydb &gt; myschemas_mydb.sql
</code></pre></div>
<p>根据过滤器转储所有数据库对象
以下命令转储除名称以 ts_ 开头的表之外的所有数据库对象：</p>
<div class="highlight"><pre><span></span><code>$ bm-dump -T &#39;ts_*&#39; mydb &gt; objects_mydb.sql
</code></pre></div>
<h3 id="bm-dumpall"><strong>bm-dumpall</strong></h3>
<p>将所有 BSQL 数据库和角色备份到 SQL 脚本文件中。</p>
<h4 id="_45"><strong>概述</strong></h4>
<p>bm-dumpall 是一个实用程序，用于将集群的所有 AiSQL 数据库写出（“转储”）到一个纯文本 SQL 脚本文件中。 该脚本文件包含可用作 sqlsh 的输入来恢复数据库的 SQL 语句。 它通过为 AiSQL 集群中的每个数据库调用 bm-dump 来完成此操作。 bm-dumpall 还转储所有数据库通用的全局对象，例如数据库角色。（bm-dump 不导出角色）</p>
<p>由于 bm-dumpall 从所有数据库读取表，因此您很可能必须以数据库超级用户身份进行连接才能生成完整的转储。 此外，您将需要超级用户权限来执行保存的脚本，以便能够添加角色和创建数据库。</p>
<p>SQL 脚本将被写入标准输出。 使用 -f|--file 选项或 shell 运算符将其重定向到文件中。</p>
<p>bm-dumpall 需要多次（每个数据库一次）连接到 AiSQL 集群。 如果您使用密码验证，则每次都会要求输入密码。 在这种情况下，拥有 ~/.pgpass 文件会很方便。</p>
<p><strong>安装</strong>
bm-dumpall 随 AiSQL 一起安装，位于 AiSQL 主目录的 postgres/bin 目录中。</p>
<p><strong>在线帮助</strong>
运行 bm-dumpall --help 显示在线帮助。</p>
<h4 id="_46"><strong>语法</strong></h4>
<div class="highlight"><pre><span></span><code>bm-dumpall [ &lt;connection-option&gt; ... ] [ &lt;content-output-formation-option&gt; ... ]
</code></pre></div>
<p>connection-option：请参阅连接选项。
content-output-format-option：请参阅内容和输出格式选项</p>
<h4 id="_47"><strong>内容和输出格式选项</strong></h4>
<p>以下命令行选项控制输出的内容和格式。</p>
<p>-a, --data-only
仅转储数据，而不转储架构（数据定义）。</p>
<p>-c, --clean
包括 SQL 语句以在重新创建数据库之前清理（删除）数据库。 还添加了角色的 DROP 语句。</p>
<p>-E encoding, --encoding=encoding
以指定的字符集编码创建转储。 默认情况下，转储是以数据库编码创建的。 （获得相同结果的另一种方法是将 PGCLIENTENCODING 环境变量设置为所需的转储编码。）</p>
<p>-f 文件名, --file=文件名
将输出发送到指定文件。 如果省略，则使用标准输出。</p>
<p>-g, --globals-only
仅转储全局对象（角色），不转储数据库。</p>
<p>-o, --oids
将对象标识符 (OID) 转储为每个表的数据的一部分。 如果您的应用程序以某种方式（即在外键约束中）引用 OID 列，请使用此选项。 否则，不应使用此选项。</p>
<p>-O, --no-owner
不要输出语句来设置对象所有权以匹配原始数据库。 默认情况下，bm-dumpall 发出 ALTER OWNER 或 SET SESSION AUTHORIZATION 语句来设置创建的模式元素的所有权。 当脚本运行时，这些语句将失败，除非它是由超级用户（或拥有脚本中所有对象的同一用户）启动的。 要创建可由任何用户恢复的脚本，但会授予该用户所有对象的所有权，请指定 -O|--no-owner。</p>
<p>-r, --roles-only
仅转储角色，不转储数据库。</p>
<p>-s, --schema-only
仅转储对象定义（架构），而不转储数据。</p>
<p>-S 用户名, --superuser=用户名
指定禁用触发器时要使用的超级用户用户名。 仅当使用 --disable-triggers 时这才相关。 （通常，最好将其忽略，而是以超级用户身份启动生成的脚本。）</p>
<p>-v, --verbose
指定详细模式。 这会导致 bm-dumpall 将开始和停止时间输出到转储文件，并将进度消息输出到标准错误。 它还将在 bm-dump 中启用详细输出。</p>
<p>--version, -V
打印 bm-dumpall 版本并退出。</p>
<p>-x, --no-privileges, --no-acl
防止转储访问权限（GRANT 和 REVOKE 语句）。</p>
<p>--column-inserts, --attribute-inserts
将数据转储为具有显式列名称的 INSERT 语句（INSERT INTO table (column, ...) VALUES ...）。 这会让恢复变得非常缓慢； 它主要用于制作可加载到非 AiSQL 数据库中的转储。</p>
<p>--disable-dollar-quoting
此选项禁止对函数体使用美元引用，并强制使用 SQL 标准字符串语法对它们进行引用。</p>
<p>--disable-triggers
此选项仅在创建纯数据转储时相关。 它指示 bm-dumpall 包含在重新加载数据时临时禁用目标表上的触发器的语句。 如果您不想在数据重新加载期间调用表上的引用完整性检查或其他触发器，请使用此选项。</p>
<p>目前，为 --disable-triggers 发出的语句必须以超级用户身份完成。 因此，您还应该使用 -S|--superuser 指定超级用户名，或者最好小心地以超级用户身份启动生成的脚本。</p>
<p>--if-exists
使用条件语句（即添加 IF EXISTS 子句）删除数据库和其他对象。 除非还指定了 -c|--clean，否则此选项无效。</p>
<p>--inserts
将数据转储为 INSERT 语句（而不是 COPY 语句）。 这会让恢复变得非常缓慢； 它主要用于制作可加载到非 AiSQL 数据库中的转储。 请注意，如果您重新排列了列顺序，则还原可能会完全失败。 --column-inserts 选项更安全，但速度更慢。</p>
<p>--load-via-partition-root 
当转储表分区的数据时，使 COPY 或 INSERT 语句的目标是包含它的分区层次结构的根，而不是分区本身。 这会导致在加载数据时为每行重新确定适当的分区。 当在服务器上重新加载数据时，这可能很有用，其中行并不总是属于与原始服务器上相同的分区。 例如，如果分区列的类型为文本，并且两个系统对用于对分区列进行排序的排序规则具有不同的定义，则可能会发生这种情况。</p>
<p>--lock-wait-timeout=timeout 
不要永远等待在转储开始时获取共享表锁。 相反，如果无法在指定的超时时间内锁定表，则失败。 超时可以用 SET statements_timeout 接受的任何格式指定。 允许的值根据要转储的服务器版本而有所不同，但所有版本都接受整数毫秒。</p>
<p>--no-comments
不要转储comments。</p>
<p>--no-publications
不要转储出版。</p>
<p>--no-role-passwords 
不要转储角色的密码。 恢复后，角色将具有空密码，并且在设置密码之前，密码验证将始终失败。 由于指定此选项时不需要密码值，因此从目录视图 pg_roles 而不是 pg_authid 读取角色信息。 因此，如果对 pg_authid 的访问受到某些安全策略的限制，此选项也会有所帮助。 注意：AiSQL 使用 pg_roles 和 pg_authid 系统表来实现 PostgreSQL 兼容性。</p>
<p>--no-security-labels
不要转储安全标签。</p>
<p>--no-subscriptions
不要转储订阅。</p>
<p>--no-sync
默认情况下，bm-dumpall 等待所有文件安全写入磁盘。 此选项导致 bm-dumpall 无需等待即可返回，这速度更快，但意味着后续操作系统崩溃可能会使转储损坏。 通常，此选项有助于测试，但在从生产安装转储数据时不应使用。</p>
<p>--no-unlogged-table-data
不要转储未wal的表的内容。 该选项对于是否转储表定义（模式）没有影响； 它仅禁止转储表数据。</p>
<p>--quote-all-identifiers
强制引用所有标识符。 当从 AiSQL 主要版本与 bm-dumpall 版本不同的服务器转储数据库时，或者当打算将输出加载到不同主要版本的服务器时，建议使用此选项。 默认情况下，bm-dumpall 仅引用在其自己的主要版本中属于保留字的标识符。 在处理可能具有稍微不同的保留字集的其他版本的服务器时，这有时会导致兼容性问题。 使用 --quote-all-identifiers 可以防止此类问题，但代价是转储脚本难以阅读。</p>
<p>--use-set-session-authorization 
输出 SQL 标准 SET SESSION AUTHORIZATION 语句而不是 ALTER OWNER 语句来确定对象所有权。 这使得转储更加兼容标准，但根据转储中对象的历史记录，可能无法正确恢复。</p>
<p>-?, --help 
显示有关 bm-dumpall 命令行参数的帮助，然后退出。</p>
<h4 id="_48"><strong>连接选项</strong></h4>
<p>以下命令行选项控制数据库连接参数。</p>
<p>-d connstr, --dbname=connstr
指定用于连接到服务器的参数，作为连接字符串。</p>
<p>该选项称为 -d|--dbname 是为了与其他客户端应用程序保持一致，但由于 bm-dumpall 需要连接到许多数据库，因此连接字符串中的数据库名称将被忽略。 使用 -l|--database 选项指定用于初始连接的数据库名称，这将转储全局对象并发现应转储哪些其他数据库。</p>
<p>-h 主机，--host 主机
指定运行数据库服务器的计算机的主机名。 如果该值以斜杠开头，则将其用作 Unix 域套接字的目录。 默认值取自 PGHOST 环境变量（如果已设置），否则将尝试 Unix 域套接字连接。</p>
<p>-l 数据库名称, --database=数据库
指定要连接的数据库的名称，以转储全局对象并发现应转储哪些其他数据库。 如果未指定，则将使用 bigmath 数据库，如果该数据库不存在，则将使用 template1。</p>
<p>-p 端口, --port=端口
指定服务器侦听连接的 TCP 端口或本地 Unix 域套接字文件扩展名。 默认为 PGPORT 环境变量（如果设置）或编译后的默认值。</p>
<p>-U 用户名, --username=用户名
连接的用户名。</p>
<p>-w, --无密码
切勿发出密码提示。 如果服务器需要密码身份验证，并且无法通过其他方式（例如 ~/.pgpass 文件）获得密码，则连接尝试将失败。 此选项在没有用户输入密码的批处理作业和脚本中非常有用。</p>
<p>-w, --no-password
强制 bm-dumpall 在连接到数据库之前提示输入密码。</p>
<p>该选项从来都不是必需的，因为如果服务器要求密码身份验证，bm-dumpall 会自动提示输入密码。 然而，bm-dumpall 会浪费一次连接尝试来发现服务器需要密码。 在某些情况下，值得输入 -W|--password 以避免额外的连接尝试。</p>
<p>注：对于每个要转储的数据库，都会出现密码提示。 为了避免每次都手动输入密码，您可以设置 ~/.pgpass 文件。</p>
<p>--role=rolename
指定用于创建转储的角色名称。 此选项导致 bm-dumpall 在连接到数据库后发出 SET ROLE <rolename> 语句。 当经过身份验证的用户（由 -U|--username 指定）缺乏 bm-dumpall 所需的权限，但可以切换到具有所需权限的角色时，这会很有帮助。 某些安装有禁止以超级用户身份直接登录的策略，使用此选项允许在不违反策略的情况下进行转储。</p>
<h4 id="_49"><strong>环境</strong></h4>
<p>AiSQL 使用以下 PostgreSQL 环境变量（在某些 bm-dumpall 和 bm-dump 选项中引用）来实现 PostgreSQL 兼容性：</p>
<ul>
<li>PGHOST</li>
<li>PGPORT</li>
<li>PGOPTIONS</li>
<li>PGUSER</li>
<li>PGCLIENTENCODING</li>
</ul>
<p>该实用程序还使用 libpq 支持的环境变量。</p>
<h4 id="_50"><strong>注意事项</strong></h4>
<p>由于 bm-dumpall 在内部调用 bm-dump，因此一些诊断消息会引用 bm-dump。
即使您的目的是将转储脚本恢复到新的集群中， -c|--clean 选项也会很有帮助。 使用 -c|--clean 授权脚本删除并重新创建内置的 bigmath、postgres 和 template1 数据库，确保这些数据库将保留它们在源中具有的相同属性（例如，区域设置和编码） 簇。 如果没有该选项，这些数据库将保留其现有的数据库级属性以及任何预先存在的内容。
恢复后，建议对每个数据库运行 ANALYZE，以便优化器获得有用的统计信息。 您还可以运行vacuumdb -a -z 来分析所有数据库。
不应期望转储脚本能够完全无错误地运行。 特别是，由于脚本将为源集群中存在的每个角色发出 CREATE ROLE 语句，因此引导超级用户肯定会收到角色已存在错误，除非目标集群是使用不同的引导超级用户名称初始化的。 此错误是无害的，应该被忽略。 使用 -c|--clean 选项可能会产生有关不存在对象的额外无害错误消息，尽管您可以通过添加 --if-exists 来最小化这些错误消息。</p>
<h4 id="_51"><strong>示例</strong></h4>
<p>转储所有数据库</p>
<div class="highlight"><pre><span></span><code>$ ./postgres/bin/bm-dumpall &gt; db.out
</code></pre></div>
<p>要从此文件重新加载数据库，您可以使用：</p>
<div class="highlight"><pre><span></span><code>$ ./bin/sqlsh -f db.out bigmath
</code></pre></div>
<p>您连接的数据库并不重要，因为 bm-dumpall 创建的脚本文件将包含用于创建和连接到已保存数据库的适当语句。 一个例外是，如果指定 -c|--clean，则必须首先连接到 postgres 数据库； 该脚本将尝试立即删除其他数据库，而对于您连接到的数据库来说，这将失败。</p>
<h3 id="bm-dev-ctl"><strong>bm-dev-ctl</strong></h3>
<p>bm-dev-ctl实用程序位于AiSQL home的bin目录中，它提供了一个命令行接口，用于管理用于开发和学习的本地集群。它会调用bm-dbserver和bm-mserver服务器来执行必要的任务。
bm-dev-ctl仅用于管理本地集群。这意味着，可以使用像本地笔记本电脑这样的单个主机来模拟AiSQL集群，集群可以有3个或更多节点。
bm-dev-ctl可以管理集群，前提是它最初是通过bm-dev-ctl创建的。这意味着通过任何其它方式创建的集群，包括Deploy部分中的集群，都不能使用bm-dev-ctl进行管理。</p>
<p>注意：
MacOS Monterey
MacOS Monterey默认启用AirPlay接收，监听端口10000。这会与AiSQL发生冲突，并导致bm-dev-ctl启动失败。则，启动集群时需要使用--mserver_flags标志来更改默认端口号，如下所示：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:$./bm-dev-ctl start --mserver_flags &quot;webserver_port=7001&quot;
</code></pre></div>
<p>或者，您可以禁用AirPlay接收，然后正常启动AiSQL，然后重新启用AirPlay接收（可选）。
基本语法为：
从AiSQL主目录运行bm-dev-ctl命令。</p>
<div class="highlight"><pre><span></span><code>./bm-dev-ctl [command][flag1，flag2，…]
</code></pre></div>
<p>联机帮助：
要显示联机帮助，请从AiSQL主目录运行bm-dev-ctl --help。</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl --help
</code></pre></div>
<h4 id="commands"><strong>Commands</strong></h4>
<p>bm-dev-ctl支持如下一系列命令。</p>
<h5 id="create"><strong>create</strong></h5>
<p>创建本地AiSQL集群。在没有flag的情况下，将会创建一个单节点集群。
进入AiSQL工作目录，执行如下命令来创建集群：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl create
</code></pre></div>
<p>当集群创建好后，会打印如下信息，其中包含集群存储目录：$HOME/biginsights-data/ 等信息。例如：/home/bigmath/biginsights-data。打印信息如下：</p>
<div class="highlight"><pre><span></span><code>Creating cluster.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node Count: 1  | Replication Factor: 1                                 
----------------------------------------------------------------------------------------------------
| JDBC            : jdbc:postgresql://127.0.0.1:2521/biginsights            
| BSQL Shell       : sqlsh                                           
| BCQL Shell       : cqlsh                           
| BEDIS Shell       : redis-cli                          
| Web UI           : http://127.0.0.1:10000/                          
| Cluster Data       : /home/bigmath/biginsights-data                          
----------------------------------------------------------------------------------------------------

For more info, please use: bm-dev-ctl status
</code></pre></div>
<p>当您使用bm-dev-ctl时，您可以将“自定义”标志（bm-dev-ctl中不可直接用的标志）传递给mserver和dbserver服务器。例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl --rf 1 create 
--mserver_flags &quot;log_cache_size_limit_mb=128,log_min_seconds_to_retain=20,mserver_backup_svc_queue_length=70&quot; 
--dbserver_flags &quot;log_inject_latency=false,log_segment_size_mb=128,raft_heartbeat_interval_ms=1000&quot;
</code></pre></div>
<p>若要处理值包含逗号或等于的标志，请用双引号将整个键值对引起来。例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$./bm-dev-ctl create --dbserver_flags &#39;sql_enable_auth=false,&quot;vmodule=tablet_service=1,pg_doc_op=1&quot;,bsql_prefetch_limit=1000&#39;
</code></pre></div>
<h5 id="start"><strong>start</strong></h5>
<p>启动现有群集，如果群集不存在，则将会创建并启动一个单节点群集。
进入AiSQL工作目录，执行如下命令来启动集群：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl start
</code></pre></div>
<p>如存在集群，则启动好后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Starting cluster with base directory /home/bigmath/biginsights-data
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node Count: 1 | Replication Factor: 1                                                           
----------------------------------------------------------------------------------------------------
| JDBC               : jdbc:postgresql://127.0.0.1:2521/biginsights                               
| BSQL Shell          : sqlsh                                                                     
| BCQL Shell          : cqlsh                                                                    
| BEDIS Shell         : redis-cli                                                                 
| Web UI             : http://127.0.0.1:10000/                                                    
| Cluster Data         : /home/bigmath/biginsights-data                                             
----------------------------------------------------------------------------------------------------

For more info, please use: bm-dev-ctl status
</code></pre></div>
<p>如果集群不存在，则会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Creating cluster.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node Count: 1  | Replication Factor: 1                                 
----------------------------------------------------------------------------------------------------
| JDBC            : jdbc:postgresql://127.0.0.1:2521/biginsights            
| BSQL Shell       : sqlsh                                           
| BCQL Shell       : cqlsh                                                                    
| BEDIS Shell       : redis-cli                                                                  
| Web UI           : http://127.0.0.1:10000/                                                     
| Cluster Data       : /home/bigmath/biginsights-data                                             
----------------------------------------------------------------------------------------------------

For more info, please use: bm-dev-ctl status
</code></pre></div>
<h5 id="stop"><strong>stop</strong></h5>
<p>停止集群服务。
当需要停止集群服务时，进入AiSQL工作目录，请执行如下命令来停止集群：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl stop
</code></pre></div>
<p>在停止集群成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping cluster.
</code></pre></div>
<h5 id="destroy"><strong>destroy</strong></h5>
<p>当确认不再需要集群服务时，请执行如下命令来销毁集群，并同时释放相关存储空间。</p>
<p>请注意：此命令将停止所有节点，并同时删除该集群的数据目录。例如：集群创建的数据目录/home/bigmath/biginsights-data 将被删除。</p>
<p>进入AiSQL工作目录，请执行如下命令来销毁集群：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl destroy
</code></pre></div>
<p>在销毁集群成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Destroying cluster.
</code></pre></div>
<h5 id="status_1"><strong>status</strong></h5>
<p>获取本地集群的健康状态。</p>
<p>进入AiSQL工作目录，请执行如下命令来进行检查集群状态：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl status
</code></pre></div>
<p>检查集群，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>--------------------------------------------------------------------------------------------------------------
| Node Count: 1 | Replication Factor: 1                                            
--------------------------------------------------------------------------------------------------------------
| JDBC               : jdbc:postgresql://127.0.0.1:2521/biginsights                 
| BSQL Shell          : sqlsh                                               
| BCQL Shell          : cqlsh                                               
| BEDIS Shell          : redis-cli                                               
| Web UI              : http://127.0.0.1:10000/                                   
| Cluster Data          : /home/bigmath/biginsights-data                            
--------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------------------
| Node 1: bm-dbserver (pid 454612), bm-mserver (pid 454609)                              
--------------------------------------------------------------------------------------------------------------
| JDBC            : jdbc:postgresql://127.0.0.1:2521/biginsights                  
| BSQL Shell       : sqlsh                                                 
| BCQL Shell       : cqlsh                                                 
| BEDIS Shell       : redis-cli                                               
| data-dir[0]         : /home/bigmath/biginsights-data/node-1/disk-1/bm-data            
| bm-dbserver Logs    : /home/bigmath/biginsights-data/node-1/disk-1/bm-data/dbserver/logs
| bm-mserver Logs    : /home/bigmath/biginsights-data/node-1/disk-1/bm-data/mserver/logs
--------------------------------------------------------------------------------------------------------------
</code></pre></div>
<h5 id="restart"><strong>restart</strong></h5>
<p>重新启动当前集群。请注意，如果重新启动集群，所有自定义的flags 和placement信息都将丢失。尽管如此，您可以像在bm-dev-ctl create命令中传递placement信息和自定义flags 一样传递它们。
进入AiSQL工作目录，请执行如下命令来进行重新启动当前集群：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart
</code></pre></div>
<p>在重新启动集群成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping cluster.
Starting cluster.
Waiting for cluster to be ready.
-------------------------------------------------------------------------------------------------
| Node Count: 1 | Replication Factor: 1                        
-------------------------------------------------------------------------------------------------
| JDBC               : jdbc:postgresql://127.0.0.1:2521/biginsights 
| BSQL Shell          : sqlsh                                             
| BCQL Shell          : cqlsh                                                  
| BEDIS Shell          : redis-cli                           
| Web UI              : http://127.0.0.1:10000/           
| Cluster Data          : /home/bigmath/biginsights-data    
-------------------------------------------------------------------------------------------------

For more info, please use: bm-dev-ctl status
</code></pre></div>
<p>可以使用云、区域和区域标志重新启动集群，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart --placement_info “cloud1.region1.zone1”
</code></pre></div>
<p>可以使用用户标志来重新启动集群，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart  --mserver_flags &quot;log_cache_size_limit_mb=128,log_min_seconds_to_retain=20,mserver_backup_svc_queue_length=70&quot; --dbserver_flags &quot;log_inject_latency=false,log_segment_size_mb=128,raft_heartbeat_interval_ms=1000&quot;
</code></pre></div>
<h5 id="wipe_restart"><strong>wipe_restart</strong></h5>
<p>停止并销毁当前集群，同时删除所有数据文件，再重新创建并启动新的集群（丢失所有flags）。
进入AiSQL工作目录，请执行如下命令来进行销毁并重新启动集群：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl wipe_restart
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Destroying cluster.
Creating cluster.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node Count: 1  | Replication Factor: 1                                 
----------------------------------------------------------------------------------------------------
| JDBC            : jdbc:postgresql://127.0.0.1:2521/biginsights            
| BSQL Shell       : sqlsh                                           
| BCQL Shell       : cqlsh                           
| BEDIS Shell       : redis-cli                          
| Web UI           : http://127.0.0.1:10000/                          
| Cluster Data       : /home/bigmath/biginsights-data                          
----------------------------------------------------------------------------------------------------

For more info, please use: bm-dev-ctl status
</code></pre></div>
<p>擦除并使用placement 标志重新启动集群，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl wipe_restart --placement_info &quot;cloud1.region1.zone1&quot;
</code></pre></div>
<p>擦除并使用用户自定义标志重新启动集群，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl wipe_restart --mserver_flags &quot;log_cache_size_limit_mb=128,log_min_seconds_to_retain=20,mserver_backup_svc_queue_length=70&quot; --dbserver_flags &quot;log_inject_latency=false,log_segment_size_mb=128,raft_heartbeat_interval_ms=1000&quot;
</code></pre></div>
<h5 id="add_node"><strong>add_node</strong></h5>
<p>将启动一个新的dbserver服务节点，并为其提供一个新node_id，同时将其添加到当前群集。它还采用了一个可选的标志--mserver，表示要添加的服务器是mserver。
进入AiSQL工作目录，请执行如下命令来进行增加服务节点：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl add_node
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Adding node.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 3: bm-dbserver (pid 1555129)                  
----------------------------------------------------------------------------------------------------
| JDBC             : jdbc:postgresql://127.0.0.3:2521/biginsights         
| BSQL Shell        : sqlsh -h 127.0.0.3                 
| BCQL Shell        : cqlsh 127.0.0.3                    
| BEDIS Shell        : redis-cli -h 127.0.0.3                            
| data-dir[0]          : /home/bigmath/biginsights-data/node-3/disk-1/bm-data          
| bm-dbserver Logs      : /home/bigmath/biginsights-data/node-3/disk-1/bm-data/dbserver/logs 
----------------------------------------------------------------------------------------------------
</code></pre></div>
<p>要添加具有自定义mserver标志的节点，请执行以下操作，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl add_node --mserver_flags &quot;log_cache_size_limit_mb=128,log_min_seconds_to_retain=20&quot;
</code></pre></div>
<p>要添加具有自定义dbserver标志的节点，请执行以下操作，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl add_node --dbserver_flags &quot;log_inject_latency=false,log_segment_size_mb=128&quot;
</code></pre></div>
<h5 id="remove_node"><strong>remove_node</strong></h5>
<p>该命令将必须删除的节点的node_id作为输入，用以停止正在运行的群集中的指定的节点服务。它还带有一个可选的标志--mserver，表示服务器是mserver服务器。
注意：当前stop_node和remove_node实现完全相同的行为，它们可以互换使用。
进入AiSQL工作目录，请执行如下命令来停止指定节点服务：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl remove_node 3
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping node dbserver-3.
</code></pre></div>
<p>可以传递一个可选的标志--mserver，它表示服务器是mserver服务器。例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl remove_node 3 --mserver
</code></pre></div>
<h5 id="start_node"><strong>start_node</strong></h5>
<p>启动正在运行的群集中的指定节点。它还带有一个可选的标志--mserver，表示服务器是mserver服务器。
进入AiSQL工作目录，请执行如下命令来启动指定节点服务：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl start_node 3
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Starting node dbserver-3.
Waiting for node to be ready.
----------------------------------------------------------------------------------------------------
| Node 3: bm-dbserver (pid 1560892)                                                                 
----------------------------------------------------------------------------------------------------
| JDBC             : jdbc:postgresql://127.0.0.3:2521/biginsights                 
| BSQL Shell        : sqlsh -h 127.0.0.3                              
| BCQL Shell       : cqlsh 127.0.0.3                       
| BEDIS Shell       : redis-cli -h 127.0.0.3                  
| data-dir[0]         : /home/bigmath/biginsights-data/node-3/disk-1/bm-data   
| bm-dbserver Logs     : /home/bigmath/biginsights-data/node-3/disk-1/bm-data/dbserver/logs 
---------------------------------------------------------------------------------------------------
</code></pre></div>
<p>可以传递一个可选的标志--mserver，它表示服务器是mserver服务器。例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl start_node 3 --mserver
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Starting node mserver-3.
Waiting for cluster to be ready.
----------------------------------------------------------------------------------------------------
| Node 3: bm-dbserver (pid 1560892), bm-mserver (pid 1561184)                                        
----------------------------------------------------------------------------------------------------
| JDBC            : jdbc:postgresql://127.0.0.3:2521/biginsights                
| BSQL Shell       : sqlsh -h 127.0.0.3                        
| BCQL Shell       : cqlsh 127.0.0.3                     
| BEDIS Shell       : redis-cli -h 127.0.0.3                     
| data-dir[0]         : /home/bigmath/biginsights-data/node-3/disk-1/bm-data        
| bm-dbserver Logs     : /home/bigmath/biginsights-data/node-3/disk-1/bm-data/dbserver/logs  
| bm-mserver Logs     : /home/bigmath/biginsights-data/node-3/disk-1/bm-data/mserver/logs  
----------------------------------------------------------------------------------------------------
</code></pre></div>
<h5 id="stop_node"><strong>stop_node</strong></h5>
<p>停止正在运行的群集中的指定节点。它还带有一个可选的标志--mserver，表示服务器是mserver服务器。
进入AiSQL工作目录，请执行如下命令来停止指定节点服务：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl stop_node 3
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping node dbserver-3.
</code></pre></div>
<p>可以传递一个可选的标志--mserver，它表示服务器是mserver服务器。例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl stop_node 3 --mserver
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping node mserver-3.
</code></pre></div>
<h5 id="restart_node"><strong>restart_node</strong></h5>
<p>重新启动正在运行的群集中的指定节点。它还采用了一个可选的标志--mserver，表示服务器是mserver服务器。
bm-dev-ctl重新启动首先停止节点，然后再次启动它。此时，该节点未从集群中退出。因此，此命令的主要优点之一是可以用于清除旧标志并传入新标志。就像create一样，可以在bm-dev-ctl restart命令中传递cloud/region/zone和自定义标志。
进入AiSQL工作目录，请执行如下命令来重新启动指定节点：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart_node 3
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping node dbserver-3.
Starting node dbserver-3.
Waiting for cluster to be ready.
</code></pre></div>
<p>可以传递一个可选的标志--mserver，它表示服务器是mserver服务器。例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart_node 3 --mserver
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Stopping node mserver-3.
Starting node mserver-3.
Waiting for cluster to be ready.
</code></pre></div>
<p>可以使用云、区域和区域标志重新启动指定节点，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart_node 2 --placement_info &quot;cloud1.region1.zone1&quot;
</code></pre></div>
<p>可以使用用户标志来重新启动指定节点，例如：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl restart_node 2 --mserver --mserver_flags &quot;log_cache_size_limit_mb=128,log_min_seconds_to_retain=20&quot;
</code></pre></div>
<h5 id="setup_redis"><strong>setup_redis</strong></h5>
<p>setup_redis命令用于初始化AiSQL兼容redis的BEDIS API。
进入AiSQL工作目录，请执行如下命令来初始化：</p>
<div class="highlight"><pre><span></span><code>bigmath@bigmath-virtual-machine:~$ ./bm-dev-ctl setup_redis
</code></pre></div>
<p>在执行成功后，会打印如下信息：</p>
<div class="highlight"><pre><span></span><code>Setting up BigInsights DB support for Redis API.
Waiting for cluster to be ready.
Setup Redis successful.
</code></pre></div>
<h4 id="flags"><strong>Flags</strong></h4>
<p>bm-dev-ctl支持如下标志（flags）。</p>
<h5 id="-help-h"><strong>--help, -h</strong></h5>
<p>显示帮助信息。</p>
<h5 id="-binary_dir"><strong>--binary_dir</strong></h5>
<p>指定在其中查找AiSQL mserver文件和dbserver二进制文件的目录。
默认值：＜AiSQL安装目录＞/bin</p>
<h5 id="-data_dir"><strong>--data_dir</strong></h5>
<p>指定AiSQL数据存储目录。
默认值：$HOME/biginsights-data/
注意：不支持在创建集群后更改此标志的值。</p>
<h5 id="-mserver_flags"><strong>--mserver_flags</strong></h5>
<p>指定mserver标志列表，用逗号分隔。</p>
<h5 id="-dbserver_flags"><strong>--dbserver_flags</strong></h5>
<p>指定dbserver标志列表，用逗号分隔。</p>
<h5 id="-placement_info"><strong>--placement_info</strong></h5>
<p>指定cloud，region，zone 为 cloud.region.zone，用逗号分隔。
默认值：cloud1.datacenter1.rack1</p>
<h5 id="-replication_factor-rf"><strong>--replication_factor, -rf</strong></h5>
<p>指定每个分片的副本数，也称为复制因子（RF）。应该是一个奇数，这样才能达成多数人的共识。创建容错集群需要最小值为3，因为只有1个副本是没有容错的。
该值也被设置为mserver服务器的默认数量。
默认值：1</p>
<h5 id="-require_clock_sync"><strong>--require_clock_sync</strong></h5>
<p>指定AiSQL是否需要群集中节点之间的时钟同步。
默认值：false</p>
<h5 id="-listen_ip"><strong>--listen_ip</strong></h5>
<p>指定要侦听的单节点群集的IP地址或端口。若要启用AiSQL API和管理端口的外部访问，请将该值设置为0.0.0.0。请注意，此标志不适用于多节点集群。
默认值：127.0.0.1</p>
<h5 id="-num_shards_per_dbserver"><strong>--num_shards_per_dbserver</strong></h5>
<p>启动分片服务，分配给每一个表的分片数量。
默认值：2</p>
<h5 id="-timeout-bm-admin-sec"><strong>--timeout-bm-admin-sec</strong></h5>
<p>调用bm-admin并在集群上等待的操作的超时时间（以秒为单位）。</p>
<h5 id="-timeout-processes-running-sec"><strong>--timeout-processes-running-sec</strong></h5>
<p>在集群上等待的操作的超时时间（以秒为单位）。</p>
<h5 id="-verbose"><strong>--verbose</strong></h5>
<p>将内部调试消息记录到stderr的标志。 </p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2024 贝格迈思
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
    
  </body>
</html>